*       *********************************************************
*       *                                                         
*       * 07/27/04              MENU1.MPR               16:55:19  
*       *                                                         
*       *********************************************************
*       *                                                         
*       * Author's Name                                           
*       *                                                         
*       * Copyright (C) 2004 Company Name                         
*       * Address                                                 
*       * City,     Zip                                           
*       *                                                         
*       * Description:                                            
*       * This PROGRAM was automatically generated BY GENMENU.    
*       *                                                         
*       *********************************************************


*       *********************************************************
*       *                                                         
*       *                      Menu Definition                    
*       *                                                         
*       *********************************************************
*

SET SYSMENU TO
SET SYSMENU AUTOMATIC

DEFINE PAD _1al109ps5 OF _MSYSMENU PROMPT "\<File" COLOR SCHEME 3 ;
	KEY ALT+F, ""
DEFINE PAD _msm_edit OF _MSYSMENU PROMPT "\<Edit" COLOR SCHEME 3 ;
	KEY ALT+E, "ALT+E" ;
	MESSAGE "Edits text or current selection"
DEFINE PAD _1al109psf OF _MSYSMENU PROMPT "\<Customer" COLOR SCHEME 3 ;
	KEY ALT+C, "" ;
	SKIP FOR lDataPathOk=.F.
DEFINE PAD _1al109psg OF _MSYSMENU PROMPT "F\<ranchisee" COLOR SCHEME 3 ;
	KEY ALT+R, "" ;
	SKIP FOR lDataPathOk=.F.
DEFINE PAD _1al109psh OF _MSYSMENU PROMPT "Com\<pany" COLOR SCHEME 3 ;
	KEY ALT+P, "" ;
	SKIP FOR lDataPathOk=.F.
DEFINE PAD _1al109psi OF _MSYSMENU PROMPT "\<Accounts Receivable" COLOR SCHEME 3 ;
	KEY ALT+A, "" ;
	SKIP FOR lDataPathOk=.F.
DEFINE PAD _1al109psj OF _MSYSMENU PROMPT "\<Utilities" COLOR SCHEME 3 ;
	KEY ALT+U, "" ;
	SKIP FOR lDataPathOk=.F.
ON PAD _1al109ps5 OF _MSYSMENU ACTIVATE POPUP file
ON PAD _msm_edit OF _MSYSMENU ACTIVATE POPUP edit
ON PAD _1al109psf OF _MSYSMENU ACTIVATE POPUP customers
ON PAD _1al109psg OF _MSYSMENU ACTIVATE POPUP franchisee
ON PAD _1al109psh OF _MSYSMENU ACTIVATE POPUP company
ON PAD _1al109psi OF _MSYSMENU ACTIVATE POPUP accountsre
ON PAD _1al109psj OF _MSYSMENU ACTIVATE POPUP utilities

DEFINE POPUP file MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF file PROMPT "Select Data Location"
DEFINE BAR 2 OF file PROMPT "Select Printer"
DEFINE BAR 3 OF file PROMPT "Exit"
ON SELECTION BAR 1 OF file ;
	DO _1al109psp ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 2 OF file ;
	DO _1al109psq ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 3 OF file ;
	DO _1al109psz ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")

DEFINE POPUP edit MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR _med_cut OF edit PROMPT "Cu\<t" ;
	KEY CTRL+X, "Ctrl+X" ;
	MESSAGE "Removes the selection and places it onto the Clipboard"
DEFINE BAR _med_copy OF edit PROMPT "\<Copy" ;
	KEY CTRL+C, "Ctrl+C" ;
	MESSAGE "Copies the selection onto the Clipboard"
DEFINE BAR _med_paste OF edit PROMPT "\<Paste" ;
	KEY CTRL+V, "Ctrl+V" ;
	MESSAGE "Pastes the contents of the Clipboard"

DEFINE POPUP customers MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF customers PROMPT "Customer File Maintenance"
DEFINE BAR 2 OF customers PROMPT "Customer Transaction Maintenance"
DEFINE BAR 3 OF customers PROMPT "\-"
DEFINE BAR 4 OF customers PROMPT "Create Monthly Customer Transactions" ;
	SKIP FOR cCompNo="WIN021" or cCompNo="TOR001"
DEFINE BAR 5 OF customers PROMPT "Delete Monthly Customer Transactions" ;
	SKIP FOR cCompNo="WIN021" or cCompNo="TOR001"
DEFINE BAR 6 OF customers PROMPT "\-"
DEFINE BAR 7 OF customers PROMPT "Invoices"
DEFINE BAR 8 OF customers PROMPT "Past Dues"
DEFINE BAR 9 OF customers PROMPT "\-"
DEFINE BAR 10 OF customers PROMPT "Fax-A-Comment - under construction" ;
	SKIP FOR 1=1
DEFINE BAR 11 OF customers PROMPT "Create Mail Merge File"
DEFINE BAR 12 OF customers PROMPT "Create Labels"
ON SELECTION BAR 1 OF customers ;
	DO _1al109pt0 ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 2 OF customers ;
	DO _1al109pt9 ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 4 OF customers ;
	DO _1al109pta ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 5 OF customers ;
	DO _1al109ptb ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 7 OF customers ;
	DO _1al109ptj ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON BAR 8 OF customers ACTIVATE POPUP pastdues
ON SELECTION BAR 10 OF customers ;
	DO _1al109ptk ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 11 OF customers ;
	DO _1al109ptl ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 12 OF customers ;
	DO _1al109ptt ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")

DEFINE POPUP pastdues MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF pastdues PROMPT "Past Due Notices"
DEFINE BAR 2 OF pastdues PROMPT "Past Due Report"
ON SELECTION BAR 1 OF pastdues ;
	DO _1al109ptu ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 2 OF pastdues ;
	DO _1al109ptv ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")

DEFINE POPUP franchisee MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF franchisee PROMPT "Franchisee File Maintenenance"
DEFINE BAR 2 OF franchisee PROMPT "Franchisee Transaction File Maintenance"
DEFINE BAR 3 OF franchisee PROMPT "Lease File Maintenance"
DEFINE BAR 4 OF franchisee PROMPT "Lease Transfer - under construction" ;
	SKIP FOR 1=1
DEFINE BAR 5 OF franchisee PROMPT "Obligations"
DEFINE BAR 6 OF franchisee PROMPT "\-"
DEFINE BAR 7 OF franchisee PROMPT "Charge-Back Menu"
DEFINE BAR 8 OF franchisee PROMPT "\-"
DEFINE BAR 9 OF franchisee PROMPT "Franchisee Reports Menu"
DEFINE BAR 10 OF franchisee PROMPT "\-"
DEFINE BAR 11 OF franchisee PROMPT "Misc Reports"
DEFINE BAR 12 OF franchisee PROMPT "\-"
DEFINE BAR 13 OF franchisee PROMPT "National Accounts"
DEFINE BAR 14 OF franchisee PROMPT "Create Mail Merge File"
DEFINE BAR 15 OF franchisee PROMPT "Create Labels"
ON SELECTION BAR 1 OF franchisee ;
	DO _1al109pu3 ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 2 OF franchisee ;
	DO _1al109pud ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 3 OF franchisee ;
	DO _1al109pue ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 4 OF franchisee ;
	DO _1al109puf ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 5 OF franchisee ;
	DO _1al109pun ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON BAR 7 OF franchisee ACTIVATE POPUP chargeback
ON BAR 9 OF franchisee ACTIVATE POPUP _0s60ii7f5
ON BAR 11 OF franchisee ACTIVATE POPUP miscreport
ON BAR 13 OF franchisee ACTIVATE POPUP nationalac
ON SELECTION BAR 14 OF franchisee ;
	DO _1al109puo ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 15 OF franchisee ;
	DO _1al109pup ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")

DEFINE POPUP chargeback MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF chargeback PROMPT "Weekly - Poss CB/TAR Report"
DEFINE BAR 2 OF chargeback PROMPT "Weekly - CB/TAR Checks"
DEFINE BAR 3 OF chargeback PROMPT "Monthly - Poss CB/TAR Report"
DEFINE BAR 4 OF chargeback PROMPT "Monthly - CB/TAR Checks"
DEFINE BAR 5 OF chargeback PROMPT "CB/TAR Check Register"
DEFINE BAR 6 OF chargeback PROMPT "\-"
DEFINE BAR 7 OF chargeback PROMPT "Possible CB Report"
DEFINE BAR 8 OF chargeback PROMPT "Perform CB Procedure"
DEFINE BAR 9 OF chargeback PROMPT "Final CB Report"
DEFINE BAR 10 OF chargeback PROMPT "\-"
DEFINE BAR 11 OF chargeback PROMPT "CB History Report"
DEFINE BAR 12 OF chargeback PROMPT "ND History Report"
DEFINE BAR 13 OF chargeback PROMPT "Print CB Letters"
ON SELECTION BAR 1 OF chargeback ;
	DO _1al109pux ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 2 OF chargeback ;
	DO _1al109puy ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 3 OF chargeback ;
	DO _1al109puz ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 4 OF chargeback ;
	DO _1al109pv7 ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 5 OF chargeback ;
	DO _1al109pv8 ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 7 OF chargeback ;
	DO _1al109pv9 ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 8 OF chargeback ;
	DO _1al109pvh ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 9 OF chargeback ;
	DO _1al109pvi ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 11 OF chargeback ;
	DO _1al109pvj ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 12 OF chargeback ;
	DO _1al109pvr ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 13 OF chargeback ;
	DO _1al109pvs ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")

DEFINE POPUP _0s60ii7f5 MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF _0s60ii7f5 PROMPT "Create/Print Franchisee Report"
DEFINE BAR 2 OF _0s60ii7f5 PROMPT "Re-Print Franchisee \<Report"
DEFINE BAR 3 OF _0s60ii7f5 PROMPT "Print Franchisee \<Spreadsheet"
DEFINE BAR 4 OF _0s60ii7f5 PROMPT "\-"
DEFINE BAR 5 OF _0s60ii7f5 PROMPT "Print \<Due Fran Checks"
DEFINE BAR 6 OF _0s60ii7f5 PROMPT "Print Due Fran \<Check Register"
DEFINE BAR 7 OF _0s60ii7f5 PROMPT "\-"
DEFINE BAR 8 OF _0s60ii7f5 PROMPT "Print Cor\<porate Dues Report"
DEFINE BAR 9 OF _0s60ii7f5 PROMPT "Print \<Workers Comp & Liability Report" ;
	SKIP FOR 1=1
DEFINE BAR 10 OF _0s60ii7f5 PROMPT "\-"
DEFINE BAR 11 OF _0s60ii7f5 PROMPT "Accounting Fee Rebate Maintenance"
DEFINE BAR 12 OF _0s60ii7f5 PROMPT "Print Accoun\<ting Fee Rebate Report"
DEFINE BAR 13 OF _0s60ii7f5 PROMPT "Print \<Accounting Fee Rebate Check"
ON SELECTION BAR 1 OF _0s60ii7f5 ;
	DO _1al109pvt ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 2 OF _0s60ii7f5 ;
	DO _1al109pw1 ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 3 OF _0s60ii7f5 ;
	DO _1al109pw2 ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 5 OF _0s60ii7f5 ;
	DO _1al109pw3 ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 6 OF _0s60ii7f5 ;
	DO _1al109pwb ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 8 OF _0s60ii7f5 ;
	DO _1al109pwc ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 9 OF _0s60ii7f5 ;
	DO _1al109pwd ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 11 OF _0s60ii7f5 ;
	DO _1al109pwe ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 12 OF _0s60ii7f5 ;
	DO _1al109pwl ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 13 OF _0s60ii7f5 ;
	DO _1al109pwm ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")

DEFINE POPUP miscreport MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF miscreport PROMPT "Finders Fees Report"
DEFINE BAR 2 OF miscreport PROMPT "Franchisee Tabs"
DEFINE BAR 3 OF miscreport PROMPT "Franchisee Yearly Summary"
DEFINE BAR 4 OF miscreport PROMPT "Negative Due Report"
DEFINE BAR 5 OF miscreport PROMPT "Non 3 % Collected Report"
DEFINE BAR 6 OF miscreport PROMPT "Pager Recap Report"
DEFINE BAR 7 OF miscreport PROMPT "Supply Recap Report"
ON SELECTION BAR 1 OF miscreport ;
	DO _1al109pwn ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 2 OF miscreport ;
	DO _1al109pwv ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 3 OF miscreport ;
	DO _1al109pww ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 4 OF miscreport ;
	DO _1al109pwx ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 5 OF miscreport ;
	DO _1al109px5 ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 6 OF miscreport ;
	DO _1al109px6 ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 7 OF miscreport ;
	DO _1al109px7 ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")

DEFINE POPUP nationalac MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF nationalac PROMPT "Bulk Invoice Payment"
DEFINE BAR 2 OF nationalac PROMPT "Possible Payment Report"
DEFINE BAR 3 OF nationalac PROMPT "Print Checks"
DEFINE BAR 4 OF nationalac PROMPT "Check Register"
ON SELECTION BAR 1 OF nationalac ;
	DO _1al109pxf ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 2 OF nationalac ;
	DO _1al109pxg ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 3 OF nationalac ;
	DO _1al109pxh ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 4 OF nationalac ;
	DO _1al109pxp ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")

DEFINE POPUP company MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF company PROMPT "Company File Maintenance"
DEFINE BAR 2 OF company PROMPT "Control File Maintenance"
DEFINE BAR 3 OF company PROMPT "Reset System Parameters (Side1/Side2)"
DEFINE BAR 4 OF company PROMPT "\-"
DEFINE BAR 5 OF company PROMPT "Special Trust Check Register Maintenance" ;
	SKIP FOR ! file('OkToTest')
DEFINE BAR 6 OF company PROMPT "Bank Information Maintenance" ;
	SKIP FOR ! file('OkToTest')
DEFINE BAR 7 OF company PROMPT "\-"
DEFINE BAR 8 OF company PROMPT "Fees Collected"
DEFINE BAR 9 OF company PROMPT "Negative Due"
DEFINE BAR 10 OF company PROMPT "\-"
DEFINE BAR 11 OF company PROMPT "Print Accounting Fee Check"
DEFINE BAR 12 OF company PROMPT "Print Advertising Fee Check"
DEFINE BAR 13 OF company PROMPT "Print BP & Bond Check"
DEFINE BAR 14 OF company PROMPT "\-"
DEFINE BAR 15 OF company PROMPT "Print Tax Liability Report"
DEFINE BAR 16 OF company PROMPT "\-"
DEFINE BAR 17 OF company PROMPT "Notes Receivable Report"
DEFINE BAR 18 OF company PROMPT "Obligations Report"
DEFINE BAR 19 OF company PROMPT "\-"
DEFINE BAR 20 OF company PROMPT "Special Trust Recap"
DEFINE BAR 21 OF company PROMPT "\-"
DEFINE BAR 22 OF company PROMPT "End Of Month Posting" ;
	SKIP FOR cCompNo="WIN021" or cCompNo="TOR001"
ON SELECTION BAR 1 OF company ;
	DO _1al109pxq ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 2 OF company ;
	DO _1al109pxz ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 3 OF company ;
	DO _1al109py0 ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 5 OF company ;
	DO _1al109py1 ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 6 OF company ;
	DO _1al109py2 ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON BAR 8 OF company ACTIVATE POPUP feescollec
ON BAR 9 OF company ACTIVATE POPUP negativedu
ON SELECTION BAR 11 OF company ;
	DO _1al109py9 ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 12 OF company ;
	DO _1al109pya ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 13 OF company ;
	DO _1al109pyb ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 15 OF company ;
	DO _1al109pyj ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 17 OF company ;
	DO _1al109pyk ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 18 OF company ;
	DO _1al109pyt ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON BAR 20 OF company ACTIVATE POPUP specialtru
ON SELECTION BAR 22 OF company ;
	DO _1al109pyu ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")

DEFINE POPUP feescollec MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF feescollec PROMPT "Print Fees Collected Possible Payment Report"
DEFINE BAR 2 OF feescollec PROMPT "Print Fees Collected Check"
DEFINE BAR 3 OF feescollec PROMPT "Print Fees Collected Check Register"
DEFINE BAR 4 OF feescollec PROMPT "Print Fees Collected Report"
DEFINE BAR 5 OF feescollec PROMPT "Record Fees Collected"
ON SELECTION BAR 1 OF feescollec ;
	DO _1al109pz3 ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 2 OF feescollec ;
	DO _1al109pz4 ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 3 OF feescollec ;
	DO _1al109pz5 ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 4 OF feescollec ;
	DO _1al109pz6 ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 5 OF feescollec ;
	DO _1al109pzd ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")

DEFINE POPUP negativedu MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF negativedu PROMPT "Print ND Possible  Payment Report"
DEFINE BAR 2 OF negativedu PROMPT "Print ND Collected Check"
DEFINE BAR 3 OF negativedu PROMPT "Print ND Check Register"
DEFINE BAR 4 OF negativedu PROMPT "Print ND Collected Report"
DEFINE BAR 5 OF negativedu PROMPT "Print ND Paid Report"
ON SELECTION BAR 1 OF negativedu ;
	DO _1al109pze ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 2 OF negativedu ;
	DO _1al109pzf ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 3 OF negativedu ;
	DO _1al109pzo ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 4 OF negativedu ;
	DO _1al109pzp ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 5 OF negativedu ;
	DO _1al109pzq ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")

DEFINE POPUP specialtru MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF specialtru PROMPT "Special Trust Recap"
DEFINE BAR 2 OF specialtru PROMPT "Special Trust Fran Advance Recap"
DEFINE BAR 3 OF specialtru PROMPT "Special Trust Unrecorded Deposits From AR Log"
ON SELECTION BAR 1 OF specialtru ;
	DO _1al109pzy ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 2 OF specialtru ;
	DO _1al109pzz ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 3 OF specialtru ;
	DO _1al109q00 ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")

DEFINE POPUP accountsre MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF accountsre PROMPT "Cash Receipts Maintenance"
DEFINE BAR 2 OF accountsre PROMPT "Other Deposits Maintenance"
DEFINE BAR 3 OF accountsre PROMPT "\-"
DEFINE BAR 4 OF accountsre PROMPT "AR Reports"
DEFINE BAR 5 OF accountsre PROMPT "\-"
DEFINE BAR 6 OF accountsre PROMPT "Monthly Log By Day"
DEFINE BAR 7 OF accountsre PROMPT "Percent Pd By Day"
ON SELECTION BAR 1 OF accountsre ;
	DO _1al109q08 ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 2 OF accountsre ;
	DO _1al109q09 ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON BAR 4 OF accountsre ACTIVATE POPUP arreports
ON SELECTION BAR 6 OF accountsre ;
	DO _1al109q0a ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 7 OF accountsre ;
	DO _1al109q0i ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")

DEFINE POPUP arreports MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF arreports PROMPT "AR Log"
DEFINE BAR 2 OF arreports PROMPT "Aging Report"
DEFINE BAR 3 OF arreports PROMPT "AR History"
DEFINE BAR 4 OF arreports PROMPT "Other Deposits"
ON SELECTION BAR 1 OF arreports ;
	DO _1al109q0j ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 2 OF arreports ;
	DO _1al109q0k ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 3 OF arreports ;
	DO _1al109q0s ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 4 OF arreports ;
	DO _1al109q0t ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")

DEFINE POPUP utilities MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF utilities PROMPT "Database Utilities"
DEFINE BAR 2 OF utilities PROMPT "\-"
DEFINE BAR 3 OF utilities PROMPT "System Utilities" ;
	SKIP FOR cCompNo="WIN021" or cCompNo="TOR001"
DEFINE BAR 4 OF utilities PROMPT "\-"
DEFINE BAR 5 OF utilities PROMPT "Tax Utilities" ;
	SKIP FOR cCompNo="WIN021" or cCompNo="TOR001"
DEFINE BAR 6 OF utilities PROMPT "\-"
DEFINE BAR 7 OF utilities PROMPT "Management Reports" ;
	SKIP FOR mgtReportsOK<>.T.
DEFINE BAR 8 OF utilities PROMPT "\-"
DEFINE BAR 9 OF utilities PROMPT "Edit Bank Path"
DEFINE BAR 10 OF utilities PROMPT "Print  STA Check"
DEFINE BAR 11 OF utilities PROMPT "Special Trust Account Transfer"
DEFINE BAR 12 OF utilities PROMPT "Batch Entry" ;
	SKIP FOR ! (file('BatchOk') and file('Batch_AP.dbf'))
ON BAR 1 OF utilities ACTIVATE POPUP databaseut
ON BAR 3 OF utilities ACTIVATE POPUP systemutil
ON BAR 5 OF utilities ACTIVATE POPUP taxutiliti
ON BAR 7 OF utilities ACTIVATE POPUP management
ON SELECTION BAR 9 OF utilities ;
	DO _1al109q12 ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 10 OF utilities ;
	DO _1al109q13 ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 11 OF utilities ;
	DO _1al109q14 ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON BAR 12 OF utilities ACTIVATE POPUP batchentry

DEFINE POPUP databaseut MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF databaseut PROMPT "Reindex Databases" ;
	SKIP FOR cCompNo="WIN021" or cCompNo="TOR001"
DEFINE BAR 2 OF databaseut PROMPT "Fix Cross Linked Customers"
DEFINE BAR 3 OF databaseut PROMPT "Fix Memo Files"
ON SELECTION BAR 1 OF databaseut ;
	DO _1al109q1c ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 2 OF databaseut ;
	DO _1al109q1d ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 3 OF databaseut ;
	DO _1al109q1e ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")

DEFINE POPUP systemutil MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF systemutil PROMPT "Archive Data"
DEFINE BAR 2 OF systemutil PROMPT "Payment Calculator"
DEFINE BAR 3 OF systemutil PROMPT "Recall Archived Invoice"
DEFINE BAR 4 OF systemutil PROMPT "Recall Deleted Invoice"
DEFINE BAR 5 OF systemutil PROMPT "Reverse Charge-Back Checks"
DEFINE BAR 6 OF systemutil PROMPT "Split Invoice"
DEFINE BAR 7 OF systemutil PROMPT "Untransfer Customer"
DEFINE BAR 8 OF systemutil PROMPT "\-"
DEFINE BAR 9 OF systemutil PROMPT "Export Data to Telemarketing" ;
	SKIP FOR ! file("custleads\custleads.dbf")
DEFINE BAR 10 OF systemutil PROMPT "Import Telemarketing Leads" ;
	SKIP FOR ! file("custleads\custleads.dbf")
ON SELECTION BAR 1 OF systemutil ;
	DO _1al109q1m ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 2 OF systemutil ;
	DO _1al109q1n ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 3 OF systemutil ;
	DO _1al109q1w ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 4 OF systemutil ;
	DO _1al109q1x ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 5 OF systemutil ;
	DO _1al109q1y ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 6 OF systemutil ;
	DO _1al109q26 ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 7 OF systemutil ;
	DO _1al109q27 ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 9 OF systemutil ;
	DO _1al109q28 ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 10 OF systemutil ;
	DO _1al109q2g ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")

DEFINE POPUP taxutiliti MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF taxutiliti PROMPT "Print Tax Table"
DEFINE BAR 2 OF taxutiliti PROMPT "Update Tax Table"
ON SELECTION BAR 1 OF taxutiliti ;
	DO _1al109q2h ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 2 OF taxutiliti ;
	DO _1al109q2i ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")

DEFINE POPUP management MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF management PROMPT "Business Analysis"
DEFINE BAR 2 OF management PROMPT "Income/Expense & Performance Analysis"
DEFINE BAR 3 OF management PROMPT "Fran - Active Franchisees"
DEFINE BAR 4 OF management PROMPT "Fran - Active Stopped Notes" ;
	SKIP FOR 1=1
DEFINE BAR 5 OF management PROMPT "Fran - Notes Receivable"
DEFINE BAR 6 OF management PROMPT "Fran - Stopped Notes" ;
	SKIP FOR 1=1
DEFINE BAR 7 OF management PROMPT "Lease - Notes Receivable" ;
	SKIP FOR 1=1
DEFINE BAR 8 OF management PROMPT "New Accounts"
ON SELECTION BAR 1 OF management do form BusinessAnalysis
ON SELECTION BAR 2 OF management do form IncomeExpense
ON SELECTION BAR 3 OF management do form activefranchisee
ON SELECTION BAR 5 OF management do form FranNotesRec
ON SELECTION BAR 8 OF management do form NewAccounts

DEFINE POPUP batchentry MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF batchentry PROMPT "Batch Entry"
DEFINE BAR 2 OF batchentry PROMPT "Batch Report"
DEFINE BAR 3 OF batchentry PROMPT "Batch Post"
ON SELECTION BAR 1 OF batchentry ;
	DO _1al109q2q ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 2 OF batchentry ;
	DO _1al109q2r ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 3 OF batchentry ;
	DO _1al109q30 ;
	IN LOCFILE("FRACCTREPORTS_NOIDX\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")


*       *********************************************************
*       *                                                         
*       *                 Cleanup Code & Procedures               
*       *                                                         
*       *********************************************************
*

READ EVENTS

*       *********************************************************
*       *                                                         
*       * _1AL109PSP  ON SELECTION BAR 1 OF POPUP file            
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:    5          
*       * Called By:  ON SELECTION BAR 1 OF POPUP file            
*       * Prompt:     Select Data Location                        
*       * Snippet:    1                                           
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109psp
clos all && KMC 06/25/2004

cDataLoc=GetDIR(cDataLoc,"Select Data Location")
lDataPathOk=.F.
IF LEN(TRIM(cDataLoc))>0
	SET PATH TO &cDataLoc
	if !file ("jkcusfil.dbf")
		cCompNo=""
		cOfficeName=""
		messagebox("Location Invalid, Select another location.",32," 	Invalid Data Location")
		_screen.caption="Franchisee Accounting - No Region Selected"
	else

		*--> KMC 04/28/2003 Store the last used data path (used as the default path when app is first run).
		create table LastDataPath ;
			(curPath C(100))
		use LastDataPath
		curPath=cDataLoc
		insert into LastDataPath from memvar	
		sele LastDataPath
		use
		*-->

		*--> 02/2004 KMC
		*--> Add field to track cancellation entered date if it doesn't already exist.
		use jkcusfil
		x=fcount('jkcusfil')
		newStructure=.F.
		for num=1 to x
			thisfield=field(num,'jkcusfil')
    		if alltrim(thisfield)="CANENTDAT" && Cancellation Entered Date
				newStructure=.t.	
			endif
		endfor
		use
		IF !newStructure
			wait window "Customer Data structure being updated..." nowait
			alter table jkcusfil add column CanEntDat D
			use
			wait clear
		endif

		*--> 03/2004 KMC
		*--> Add field to store current accounting/admin fee percentage if it doesn't already exist.
		use jkcmpfil
		x=fcount('jkcmpfil')
		newStructure=.F.
		for num=1 to x
			thisfield=field(num,'jkcmpfil')
    		if alltrim(thisfield)="ACCT_PERC" && Accounting Fee Percentage
				newStructure=.t.	
			endif
		endfor
		use
		IF !newStructure
			wait window "Company Data structure being updated..." nowait
			alter table jkcmpfil add column Acct_Perc N(5,3)
			repl all Acct_Perc with 3.00
			use
			wait clear
		endif

		*--> 06/24/2004 KMC
		*--> Add dlr_id C(3) to jkdlrfil to track franchisee transfers if it doesn't already exist.
		use jkdlrfil
		x=fcount('jkdlrfil')
		newStructure=.F.
		for num=1 to x
			thisfield=field(num,'jkdlrfil')
    		if alltrim(thisfield)="DLR_ID" && Used to track franchisee transfers.
				newStructure=.t.	
			endif
		endfor
		use
		IF !newStructure
			wait window "Franchisee Data structure being updated..." nowait
			alter table jkdlrfil add column Dlr_ID C(3)
			repla all dlr_id with "000"
			index on dlr_id tag dlr_id  && Create index on dlr_id
			use
			wait clear

			*--> Add index on dlr_id to jkdlrfil in ndx_dat.
			use ndx_dat in 0
			sele ndx_dat
			append blank
			repla file_name with "JKDLRFIL"
			repla index_exp with "DLR_ID"
			repla index_to with "TAG DLR_ID"
			append blank
			repla file_name with "DLRTRANHST"
			repla index_exp with "COMPANY_NO"
			repla index_to with "TAG COMPANY_NO"
			append blank
			repla file_name with "DLRTRANHST"
			repla index_exp with "DLR_CODE"
			repla index_to with "TAG DLR_CODE"
			append blank
			repla file_name with "DLRTRANHST"
			repla index_exp with "DLR_ID"
			repla index_to with "TAG DLR_ID"
			use
		endif
		*-->

		*--> 03/2004 KMC
		*--> No longer need rpt_data.dbf (using a cursor now),dele it and any associated indexes.
		if file(cDataLoc+"rpt_data.dbf")
			dele file cDataLoc+"rpt_data.*"
		endif

		*--> 03/2004 KMC
		*--> Table rpt_data no longer used, delete reference to it in ndx_dat.
		use ndx_dat in 0
		sele ndx_dat
		dele all for file_name="RPT_DATA"
		use
	
		*--> 03/2004 KMC
		*--> Create table for tracking account increase/decreases if it does not exist.
		IF !FILE(cDataLoc + "incrdecr.dbf")
			CREATE table cDataLoc + "incrdecr" ;
			(logdate D, ;
			logtime C(8), ;
			sys_cust N(8), ;
			cust_no C(6), ;
			old_amt N(12,2), ;
			new_amt N(12,2))
			sele incrdecr
			index on logdate tag logdate
			index on sys_cust tag sys_cust
			index on cust_no tag cust_no
			use
		ENDIF
		*--> Create indexes for incrdecr if they do not exist already.
		IF !FILE(cDataLoc + "incrdecr.cdx")
			use incrdecr in 0 excl
			sele incrdecr
			index on logdate tag logdate
			index on sys_cust tag sys_cust
			index on cust_no tag cust_no
			use
		ENDIF
		*--> KMC 07/02/2004 Create file for tracking franchise transfers if it does not already exist.
		IF !FILE(cDataLoc + "DlrTranHst.dbf")
			creat table cDataLoc + "DlrTranHst" ;
			(chngDate D, ;
			company_no C(6), ;
			dlr_code C(6), ;
			dlr_id C(3), ;
			dlr_name C(30), ;
			dlr_addr C(30), ;
			dlr_city C(20), ;
			dlr_state C(2), ;
			dlr_zip C(10), ;
			dlr_ssn N(9) , ;
			dlr_fid N(9))
			use
		endif
		*-->

		use jkcmpfil in 0
		sele jkcmpfil
		locate for control_no=1
		if found()
			cCompNo=Company_no
			cOfficeName=alltrim(dsp_name)
			*vfpprinter = SET("printer",3) && KMC 01/09/2004 - No need to set this when changing regions.			
			_screen.caption=cCompNo+" "+cOfficeName+" - "+vfpprinter
			lDataPathOk=.T.

			*--> 06/25/2004 KMC
			*--> Add dlr_id C(3) to ckbook to track franchisee transfers if it doesn't already exist.
			use data_loc in 0
			sele data_loc
			if cCompNo="NAT991" or cCompNo="NAT999"
				*--> National Accts and National Accts2 both use same checkbook.  Nat Acct is NAT991,
				*--> Nat Acct2 is NAT999.  In data_loc, NAT000 is the data location for both Nat Acct databases.
				loca for company_no=Left(cCompNo,3)+"000"
			else
				loca for company_no=cCompNo
			endif
			newStructure=.F.
			if found()
				xFile=(alltrim(data_loc.bank_data)+'\ckbook.dbf')
				if file(xFile)
					USE &xFile ALIAS checks IN 0
					sele checks
					x=fcount('checks')
					for num=1 to x
						thisfield=field(num,'checks')
			   	 		if alltrim(thisfield)="DLR_ID" && Used to track franchisee transfers.
							newStructure=.t.	
						endif
					endfor
					use
					IF !newStructure
						wait window "CheckBook Data structure being updated..." nowait
						alter table &xFile add column Dlr_ID C(3)
						sele ckbook
						use
						wait clear
					endif	
				endif
			endif
			sele data_loc
			use
			*-->
		else
			cCompNo=""
			cOfficeName=""
			messagebox("Cannot locate valid Company record.",48,"  Invalid Company Record")
			lDataPathOK=.F.
		endif	
    	use
	endif	
else
	cCompNo=""
	cOfficeName=""
	messagebox ("No data path selected.",32,"  Invalid Data Path")
	_screen.caption="Franchisee Accounting - No Region Selected"
ENDIF

clos all && KMC 06/25/2004



*       *********************************************************
*       *                                                         
*       * _1AL109PSQ  ON SELECTION BAR 2 OF POPUP file            
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:    6          
*       * Called By:  ON SELECTION BAR 2 OF POPUP file            
*       * Prompt:     Select Printer                              
*       * Snippet:    2                                           
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109psq
SYS(1037)
vfpprinter = SET("printer",3) && Sets VFP default printer to the user selected printer.
_screen.caption=cCompNo+" "+cOfficeName+" - "+vfpprinter


*       *********************************************************
*       *                                                         
*       * _1AL109PSZ  ON SELECTION BAR 3 OF POPUP file            
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:    7          
*       * Called By:  ON SELECTION BAR 3 OF POPUP file            
*       * Prompt:     Exit                                        
*       * Snippet:    3                                           
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109psz
*CLEA EVENTS
*CLOS ALL
*CLEA ALL

*--> KMC 04/28/2003 Store the last used data path (used as the default path when app is first run).
create table LastDataPath ;
	(curPath C(100))
use LastDataPath
curPath=cDataLoc
insert into LastDataPath from memvar	
sele LastDataPath
use
*-->

QUIT




*       *********************************************************
*       *                                                         
*       * _1AL109PT0  ON SELECTION BAR 1 OF POPUP customers       
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   15          
*       * Called By:  ON SELECTION BAR 1 OF POPUP customers       
*       * Prompt:     Customer File Maintenance                   
*       * Snippet:    4                                           
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pt0
*do form customerscreen

PUBLIC oForm1
DO FORM customerfileinfo name oForm1


*       *********************************************************
*       *                                                         
*       * _1AL109PT9  ON SELECTION BAR 2 OF POPUP customers       
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   16          
*       * Called By:  ON SELECTION BAR 2 OF POPUP customers       
*       * Prompt:     Customer Transaction Maintenance            
*       * Snippet:    5                                           
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pt9
CLOSE TABLE ALL
*USE jkctlfil INDEX jkctlfil IN 0 ALIAS ctl
USE jkctlfil ORDER key IN 0 ALIAS ctl
SELE ctl
IF !SEEK(PADL(RIGHT(cCompNo,1),3))
	MESSAGEBOX("Cannot find Bill Month/Year in jkctlfil.  Notify MIS Dept.",48,"Alert")
	CLOSE TABLE ALL	
	RETURN
ENDIF

tdate = CTOD(ALLTRIM(STR(ctl.fn_LsMon)) +'/01/'+ALLTRIM(STR(ctl.fn_LsYear)))
tmonth = CMONTH(tdate)

*USE jkinvfil INDEX jkinvfil IN 0 ALIAS invrec
USE jkinvfil ORDER key IN 0 ALIAS invrec
SELE invrec
SET FILTER TO bill_mon = ctl.fn_LsMon AND bill_year = ctl.fn_LsYear
GO TOP
IF EOF()
MESSAGEBOX("The Bill Run has not been created for "+tmonth+' '+ALLTRIM(STR(ctl.fn_LsYear))+'.'+ CHR(13) ;
		+"You must create the Bill Run before you can create additional transactions for this period.",48,"Alert")
	CLOSE TABLE ALL	
	RETURN
ENDIF
PUBLIC oForm1
DO FORM custtraninfo NAME oForm1 WITH "FromMenu"



*       *********************************************************
*       *                                                         
*       * _1AL109PTA  ON SELECTION BAR 4 OF POPUP customers       
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   18          
*       * Called By:  ON SELECTION BAR 4 OF POPUP customers       
*       * Prompt:     Create Monthly Customer Transactions        
*       * Snippet:    6                                           
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pta
DO FORM monthlycusttran


*       *********************************************************
*       *                                                         
*       * _1AL109PTB  ON SELECTION BAR 5 OF POPUP customers       
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   19          
*       * Called By:  ON SELECTION BAR 5 OF POPUP customers       
*       * Prompt:     Delete Monthly Customer Transactions        
*       * Snippet:    7                                           
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109ptb
DO FORM deletemonthlycusttran


*       *********************************************************
*       *                                                         
*       * _1AL109PTJ  ON SELECTION BAR 7 OF POPUP customers       
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   21          
*       * Called By:  ON SELECTION BAR 7 OF POPUP customers       
*       * Prompt:     Invoices                                    
*       * Snippet:    8                                           
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109ptj
DO FORM selectinvtype



*       *********************************************************
*       *                                                         
*       * _1AL109PTK  ON SELECTION BAR 10 OF POPUP customers      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   28          
*       * Called By:  ON SELECTION BAR 10 OF POPUP customers      
*       * Prompt:     Fax-A-Comment - under construction          
*       * Snippet:    9                                           
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109ptk
ON ERROR DO NoWinfax

WAIT WIND "Please Wait!  Checking Winfax Software..." NOWAIT
PUBLIC goterr

goterr = .F.

oFax = CREATEOBJECT("WinFax.SDKSend")

IF goterr = .F.
	DO FORM faxacomment
ENDIF

PROC NoWinfax
	goterr = .T.
	WAIT CLEAR
	ON ERROR
	MESSAGEBOX("Fax-A-Comment requires Winfax Pro."+CHR(13)+;
	"Install Winfax Pro Software and try again.", 48," Fax-A-Comment Alert")
RETURN



*       *********************************************************
*       *                                                         
*       * _1AL109PTL  ON SELECTION BAR 11 OF POPUP customers      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   29          
*       * Called By:  ON SELECTION BAR 11 OF POPUP customers      
*       * Prompt:     Create Mail Merge File                      
*       * Snippet:    10                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109ptl
Do Form CustMailMerge


*       *********************************************************
*       *                                                         
*       * _1AL109PTT  ON SELECTION BAR 12 OF POPUP customers      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   30          
*       * Called By:  ON SELECTION BAR 12 OF POPUP customers      
*       * Prompt:     Create Labels                               
*       * Snippet:    11                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109ptt
DO FORM custlabels


*       *********************************************************
*       *                                                         
*       * _1AL109PTU  ON SELECTION BAR 1 OF POPUP pastdues        
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   24          
*       * Called By:  ON SELECTION BAR 1 OF POPUP pastdues        
*       * Prompt:     Past Due Notices                            
*       * Snippet:    12                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109ptu
DO FORM print_past_due



*       *********************************************************
*       *                                                         
*       * _1AL109PTV  ON SELECTION BAR 2 OF POPUP pastdues        
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   25          
*       * Called By:  ON SELECTION BAR 2 OF POPUP pastdues        
*       * Prompt:     Past Due Report                             
*       * Snippet:    13                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109ptv
DO FORM print_pd_report



*       *********************************************************
*       *                                                         
*       * _1AL109PU3  ON SELECTION BAR 1 OF POPUP franchisee      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   33          
*       * Called By:  ON SELECTION BAR 1 OF POPUP franchisee      
*       * Prompt:     Franchisee File Maintenenance               
*       * Snippet:    14                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pu3
PUBLIC oForm1
DO FORM franchiseefileinfo name oForm1


*       *********************************************************
*       *                                                         
*       * _1AL109PUD  ON SELECTION BAR 2 OF POPUP franchisee      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   34          
*       * Called By:  ON SELECTION BAR 2 OF POPUP franchisee      
*       * Prompt:     Franchisee Transaction File Maintenance     
*       * Snippet:    15                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pud
PUBLIC oForm1
DO FORM frantraninfo NAME oForm1




*       *********************************************************
*       *                                                         
*       * _1AL109PUE  ON SELECTION BAR 3 OF POPUP franchisee      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   35          
*       * Called By:  ON SELECTION BAR 3 OF POPUP franchisee      
*       * Prompt:     Lease File Maintenance                      
*       * Snippet:    16                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pue
DO FORM leasefileinfo


*       *********************************************************
*       *                                                         
*       * _1AL109PUF  ON SELECTION BAR 4 OF POPUP franchisee      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   36          
*       * Called By:  ON SELECTION BAR 4 OF POPUP franchisee      
*       * Prompt:     Lease Transfer - under construction         
*       * Snippet:    17                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109puf
do form transferlease


*       *********************************************************
*       *                                                         
*       * _1AL109PUN  ON SELECTION BAR 5 OF POPUP franchisee      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   37          
*       * Called By:  ON SELECTION BAR 5 OF POPUP franchisee      
*       * Prompt:     Obligations                                 
*       * Snippet:    18                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pun
Do Form Obligations



*       *********************************************************
*       *                                                         
*       * _1AL109PUO  ON SELECTION BAR 14 OF POPUP franchisee     
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   90          
*       * Called By:  ON SELECTION BAR 14 OF POPUP franchisee     
*       * Prompt:     Create Mail Merge File                      
*       * Snippet:    19                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109puo
do form FranMailMerge


*       *********************************************************
*       *                                                         
*       * _1AL109PUP  ON SELECTION BAR 15 OF POPUP franchisee     
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   91          
*       * Called By:  ON SELECTION BAR 15 OF POPUP franchisee     
*       * Prompt:     Create Labels                               
*       * Snippet:    20                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pup
DO FORM franlabels


*       *********************************************************
*       *                                                         
*       * _1AL109PUX  ON SELECTION BAR 1 OF POPUP chargeback      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   41          
*       * Called By:  ON SELECTION BAR 1 OF POPUP chargeback      
*       * Prompt:     Weekly - Poss CB/TAR Report                 
*       * Snippet:    21                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pux
do form CbPay with "WeeklyReport"



*       *********************************************************
*       *                                                         
*       * _1AL109PUY  ON SELECTION BAR 2 OF POPUP chargeback      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   42          
*       * Called By:  ON SELECTION BAR 2 OF POPUP chargeback      
*       * Prompt:     Weekly - CB/TAR Checks                      
*       * Snippet:    22                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109puy
use data_loc in 0
sele data_loc
if cCompNo="NAT999" or cCompNo="NAT991"
	loca for company_no="NAT000"
else
	loca for company_no=cCompNo
endif
*--> Don't call form if we cannot locate bank information.
if found()
	use
	Do form CbPAy with "WeeklyChecks"
else
	use
	messagebox("Cannot locate Bank Info.",48,"  No Bank Info Record")
endif




*       *********************************************************
*       *                                                         
*       * _1AL109PUZ  ON SELECTION BAR 3 OF POPUP chargeback      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   43          
*       * Called By:  ON SELECTION BAR 3 OF POPUP chargeback      
*       * Prompt:     Monthly - Poss CB/TAR Report                
*       * Snippet:    23                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109puz
x=messagebox("Do not continue until all report corrections have been made"+chr(13)+ ;
"and final Franchise reports and checks have been printed." + CHR(13)+CHR(13)+ ;
"NO corrections can be entered that affect a Franchisee's"+chr(13)+ ;
"report AFTER this report has been run." +CHR(13)+CHR(13)+ ;
"Do you wish to procede? (Press 'No' if you're not sure).",276,+REPLICATE(" ",30)+"System Alert - WARNING")
if x=6	
	Do form CbPay with "MonthlyReport"
else
	return
endif	
	


*       *********************************************************
*       *                                                         
*       * _1AL109PV7  ON SELECTION BAR 4 OF POPUP chargeback      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   44          
*       * Called By:  ON SELECTION BAR 4 OF POPUP chargeback      
*       * Prompt:     Monthly - CB/TAR Checks                     
*       * Snippet:    24                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pv7
use data_loc in 0
sele data_loc
if cCompNo="NAT999" or cCompNo="NAT991"
	loca for company_no="NAT000"
else
	loca for company_no=cCompNo
endif
*--> Don't call form if we cannot locate bank information.
if found()
	use
	Do form CbPay with "MonthlyChecks"
else
	use
	messagebox("Cannot locate Bank Info.",48,"  No Bank Info Record")
endif




*       *********************************************************
*       *                                                         
*       * _1AL109PV8  ON SELECTION BAR 5 OF POPUP chargeback      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   45          
*       * Called By:  ON SELECTION BAR 5 OF POPUP chargeback      
*       * Prompt:     CB/TAR Check Register                       
*       * Snippet:    25                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pv8
DO Form CBTarRegister


*       *********************************************************
*       *                                                         
*       * _1AL109PV9  ON SELECTION BAR 7 OF POPUP chargeback      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   47          
*       * Called By:  ON SELECTION BAR 7 OF POPUP chargeback      
*       * Prompt:     Possible CB Report                          
*       * Snippet:    26                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pv9
DO form CBProcess with "PossCBRpt"



*       *********************************************************
*       *                                                         
*       * _1AL109PVH  ON SELECTION BAR 8 OF POPUP chargeback      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   48          
*       * Called By:  ON SELECTION BAR 8 OF POPUP chargeback      
*       * Prompt:     Perform CB Procedure                        
*       * Snippet:    27                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pvh
Do form CBProcess with "PerformCB"


*       *********************************************************
*       *                                                         
*       * _1AL109PVI  ON SELECTION BAR 9 OF POPUP chargeback      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   49          
*       * Called By:  ON SELECTION BAR 9 OF POPUP chargeback      
*       * Prompt:     Final CB Report                             
*       * Snippet:    28                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pvi
Do form FinalCBRpt


*       *********************************************************
*       *                                                         
*       * _1AL109PVJ  ON SELECTION BAR 11 OF POPUP chargeback     
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   51          
*       * Called By:  ON SELECTION BAR 11 OF POPUP chargeback     
*       * Prompt:     CB History Report                           
*       * Snippet:    29                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pvj
do form cbhistory


*       *********************************************************
*       *                                                         
*       * _1AL109PVR  ON SELECTION BAR 12 OF POPUP chargeback     
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   52          
*       * Called By:  ON SELECTION BAR 12 OF POPUP chargeback     
*       * Prompt:     ND History Report                           
*       * Snippet:    30                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pvr
do form ndhistory


*       *********************************************************
*       *                                                         
*       * _1AL109PVS  ON SELECTION BAR 13 OF POPUP chargeback     
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   53          
*       * Called By:  ON SELECTION BAR 13 OF POPUP chargeback     
*       * Prompt:     Print CB Letters                            
*       * Snippet:    31                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pvs
Do form CbLetter


*       *********************************************************
*       *                                                         
*       * _1AL109PVT  ON SELECTION BAR 1 OF POPUP _0s60ii7f5      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   57          
*       * Called By:  ON SELECTION BAR 1 OF POPUP _0s60ii7f5      
*       * Prompt:     Create/Print Franchisee Report              
*       * Snippet:    32                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pvt
DO FORM PrintFranReport WITH 'N'


*       *********************************************************
*       *                                                         
*       * _1AL109PW1  ON SELECTION BAR 2 OF POPUP _0s60ii7f5      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   58          
*       * Called By:  ON SELECTION BAR 2 OF POPUP _0s60ii7f5      
*       * Prompt:     Re-Print Franchisee Report                  
*       * Snippet:    33                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pw1
DO FORM PrintFranReport WITH 'R'


*       *********************************************************
*       *                                                         
*       * _1AL109PW2  ON SELECTION BAR 3 OF POPUP _0s60ii7f5      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   59          
*       * Called By:  ON SELECTION BAR 3 OF POPUP _0s60ii7f5      
*       * Prompt:     Print Franchisee Spreadsheet                
*       * Snippet:    34                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pw2
*IF file('jkcusfil.dbf')
	DO FORM print_spreadsheet
*ELSE
*  messagebox(" Select a valid path to data.")
*ENDIF



*       *********************************************************
*       *                                                         
*       * _1AL109PW3  ON SELECTION BAR 5 OF POPUP _0s60ii7f5      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   62          
*       * Called By:  ON SELECTION BAR 5 OF POPUP _0s60ii7f5      
*       * Prompt:     Print Due Fran Checks                       
*       * Snippet:    35                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pw3
use data_loc in 0
sele data_loc
if cCompNo="NAT999" or cCompNo="NAT991"
	loca for company_no="NAT000"
else
	loca for company_no=cCompNo
endif
*--> Don't call form if we cannot locate bank information.
if found()
	use
	DO FORM "PrintDueFranChecks"
else
	use
	messagebox("Cannot locate Bank Info.",48,"  No Bank Info Record")
endif


*       *********************************************************
*       *                                                         
*       * _1AL109PWB  ON SELECTION BAR 6 OF POPUP _0s60ii7f5      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   63          
*       * Called By:  ON SELECTION BAR 6 OF POPUP _0s60ii7f5      
*       * Prompt:     Print Due Fran Check Register               
*       * Snippet:    36                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pwb
DO FORM "print franchisee check register"


*       *********************************************************
*       *                                                         
*       * _1AL109PWC  ON SELECTION BAR 8 OF POPUP _0s60ii7f5      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   66          
*       * Called By:  ON SELECTION BAR 8 OF POPUP _0s60ii7f5      
*       * Prompt:     Print Corporate Dues Report                 
*       * Snippet:    37                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pwc
do form CorporateDuesreport


*       *********************************************************
*       *                                                         
*       * _1AL109PWD  ON SELECTION BAR 9 OF POPUP _0s60ii7f5      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   67          
*       * Called By:  ON SELECTION BAR 9 OF POPUP _0s60ii7f5      
*       * Prompt:     Print Workers Comp & Liability Report       
*       * Snippet:    38                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pwd
do form liaworkcompreport


*       *********************************************************
*       *                                                         
*       * _1AL109PWE  ON SELECTION BAR 11 OF POPUP _0s60ii7f5     
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   70          
*       * Called By:  ON SELECTION BAR 11 OF POPUP _0s60ii7f5     
*       * Prompt:     Accounting Fee Rebate Maintenance           
*       * Snippet:    39                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pwe
do form AcctFeeRebate


*       *********************************************************
*       *                                                         
*       * _1AL109PWL  ON SELECTION BAR 12 OF POPUP _0s60ii7f5     
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   71          
*       * Called By:  ON SELECTION BAR 12 OF POPUP _0s60ii7f5     
*       * Prompt:     Print Accounting Fee Rebate Report          
*       * Snippet:    40                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pwl
DO FORM accountrebatereport


*       *********************************************************
*       *                                                         
*       * _1AL109PWM  ON SELECTION BAR 13 OF POPUP _0s60ii7f5     
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   72          
*       * Called By:  ON SELECTION BAR 13 OF POPUP _0s60ii7f5     
*       * Prompt:     Print Accounting Fee Rebate Check           
*       * Snippet:    41                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pwm
*--> 01/15/2004 KMC
*Do form AcctFeeRebateCheck
use data_loc in 0
sele data_loc
loca for company_no="AcctFee"
*--> Don't call form if we cannot locate bank information.
if found()
	use
	Do form AcctFeeRebateCheck
else
	*--> Only Corporate uses a seperate account for Acct Fee Rebate Checks,
	*--> Masters would use the active regions Special Trust Acct.
	*--> If the "AcctFee" record is not found, drop back to the record
	*--> for the active region.
	loca for company_no=cCompNo
	if found()
		use
		Do form AcctFeeRebateCheck
	else
		use
		messagebox("Cannot locate Bank Info.",48,"  No Bank Info Record")
	endif
endif
*-->






*       *********************************************************
*       *                                                         
*       * _1AL109PWN  ON SELECTION BAR 1 OF POPUP miscreport      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   76          
*       * Called By:  ON SELECTION BAR 1 OF POPUP miscreport      
*       * Prompt:     Finders Fees Report                         
*       * Snippet:    42                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pwn
do form ffReport


*       *********************************************************
*       *                                                         
*       * _1AL109PWV  ON SELECTION BAR 2 OF POPUP miscreport      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   77          
*       * Called By:  ON SELECTION BAR 2 OF POPUP miscreport      
*       * Prompt:     Franchisee Tabs                             
*       * Snippet:    43                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pwv
Do form PrintTabs


*       *********************************************************
*       *                                                         
*       * _1AL109PWW  ON SELECTION BAR 3 OF POPUP miscreport      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   78          
*       * Called By:  ON SELECTION BAR 3 OF POPUP miscreport      
*       * Prompt:     Franchisee Yearly Summary                   
*       * Snippet:    44                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pww
DO Form FranYTDReport


*       *********************************************************
*       *                                                         
*       * _1AL109PWX  ON SELECTION BAR 4 OF POPUP miscreport      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   79          
*       * Called By:  ON SELECTION BAR 4 OF POPUP miscreport      
*       * Prompt:     Negative Due Report                         
*       * Snippet:    45                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pwx
do form negativedue


*       *********************************************************
*       *                                                         
*       * _1AL109PX5  ON SELECTION BAR 5 OF POPUP miscreport      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   80          
*       * Called By:  ON SELECTION BAR 5 OF POPUP miscreport      
*       * Prompt:     Non 3 % Collected Report                    
*       * Snippet:    46                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109px5
do form non3collected


*       *********************************************************
*       *                                                         
*       * _1AL109PX6  ON SELECTION BAR 6 OF POPUP miscreport      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   81          
*       * Called By:  ON SELECTION BAR 6 OF POPUP miscreport      
*       * Prompt:     Pager Recap Report                          
*       * Snippet:    47                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109px6
Do form PagerRecap


*       *********************************************************
*       *                                                         
*       * _1AL109PX7  ON SELECTION BAR 7 OF POPUP miscreport      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   82          
*       * Called By:  ON SELECTION BAR 7 OF POPUP miscreport      
*       * Prompt:     Supply Recap Report                         
*       * Snippet:    48                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109px7
do form supplyrecap


*       *********************************************************
*       *                                                         
*       * _1AL109PXF  ON SELECTION BAR 1 OF POPUP nationalac      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   86          
*       * Called By:  ON SELECTION BAR 1 OF POPUP nationalac      
*       * Prompt:     Bulk Invoice Payment                        
*       * Snippet:    49                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pxf
Do form BulkInvPay


*       *********************************************************
*       *                                                         
*       * _1AL109PXG  ON SELECTION BAR 2 OF POPUP nationalac      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   87          
*       * Called By:  ON SELECTION BAR 2 OF POPUP nationalac      
*       * Prompt:     Possible Payment Report                     
*       * Snippet:    50                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pxg
Do form NatAcctCks with "Report"


*       *********************************************************
*       *                                                         
*       * _1AL109PXH  ON SELECTION BAR 3 OF POPUP nationalac      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   88          
*       * Called By:  ON SELECTION BAR 3 OF POPUP nationalac      
*       * Prompt:     Print Checks                                
*       * Snippet:    51                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pxh
use data_loc in 0
sele data_loc
if cCompNo="NAT999" or cCompNo="NAT991"
	loca for company_no="NAT000"
else
	loca for company_no=cCompNo
endif
*--> Don't call form if we cannot locate bank information.
if found()
	use
	Do form NatAcctCks with "Checks"
else
	use
	messagebox("Cannot locate Bank Info.",48,"  No Bank Info Record")
endif




*       *********************************************************
*       *                                                         
*       * _1AL109PXP  ON SELECTION BAR 4 OF POPUP nationalac      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   89          
*       * Called By:  ON SELECTION BAR 4 OF POPUP nationalac      
*       * Prompt:     Check Register                              
*       * Snippet:    52                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pxp
Do Form NatAcctCkRegister


*       *********************************************************
*       *                                                         
*       * _1AL109PXQ  ON SELECTION BAR 1 OF POPUP company         
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   94          
*       * Called By:  ON SELECTION BAR 1 OF POPUP company         
*       * Prompt:     Company File Maintenance                    
*       * Snippet:    53                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pxq
DO FORM officefileinfo



*       *********************************************************
*       *                                                         
*       * _1AL109PXZ  ON SELECTION BAR 2 OF POPUP company         
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   95          
*       * Called By:  ON SELECTION BAR 2 OF POPUP company         
*       * Prompt:     Control File Maintenance                    
*       * Snippet:    54                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pxz
DO FORM controlfileinfo


*       *********************************************************
*       *                                                         
*       * _1AL109PY0  ON SELECTION BAR 3 OF POPUP company         
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   96          
*       * Called By:  ON SELECTION BAR 3 OF POPUP company         
*       * Prompt:     Reset System Parameters (Side1/Side2)       
*       * Snippet:    55                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109py0
do form resetsystemparameters


*       *********************************************************
*       *                                                         
*       * _1AL109PY1  ON SELECTION BAR 5 OF POPUP company         
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   99          
*       * Called By:  ON SELECTION BAR 5 OF POPUP company         
*       * Prompt:     Special Trust Check Register Maintenance    
*       * Snippet:    56                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109py1
use data_loc
if cCompNo="NAT999" or cCompNo="NAT991"
	loca for company_no="NAT000"
else
	loca for company_no=cCompNo
endif

*--> Don't call form if we cannot locate bank information.
if found()
	BankPath = ALLTRIM(data_loc.bank_data)
	use
	DO FORM francheckfileinfo with BankPath
else
	use
	messagebox("Cannot locate Bank Info.",48,"  No Bank Info Record")
endif



*       *********************************************************
*       *                                                         
*       * _1AL109PY2  ON SELECTION BAR 6 OF POPUP company         
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  100          
*       * Called By:  ON SELECTION BAR 6 OF POPUP company         
*       * Prompt:     Bank Information Maintenance                
*       * Snippet:    57                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109py2
*do form bankinfo

USE data_loc IN 0
SELE data_loc
IF cCompNo="NAT991" OR cCompNo="NAT999"
	LOCA FOR company_no="NAT000"
ELSE
	LOCA FOR company_no=cCompNo
ENDIF

IF FOUND()
	DO FORM bankinfo
ELSE
	CLOSE TABLE ALL
	MESSAGEBOX("No Bank Data Available!",48," Alert")
	RETURN
ENDIF



*       *********************************************************
*       *                                                         
*       * _1AL109PY9  ON SELECTION BAR 11 OF POPUP company        
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  119          
*       * Called By:  ON SELECTION BAR 11 OF POPUP company        
*       * Prompt:     Print Accounting Fee Check                  
*       * Snippet:    58                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109py9
use data_loc in 0
sele data_loc
if cCompNo="NAT999" or cCompNo="NAT991"
	loca for company_no="NAT000"
else
	loca for company_no=cCompNo
endif
*--> Don't call form if we cannot locate bank information.
if found()
	use
	do form adv_afr_bp_ck with "AcctFeeReb"
else
	use
	messagebox("Cannot locate Bank Info.",48,"  No Bank Info Record")
endif






*       *********************************************************
*       *                                                         
*       * _1AL109PYA  ON SELECTION BAR 12 OF POPUP company        
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  120          
*       * Called By:  ON SELECTION BAR 12 OF POPUP company        
*       * Prompt:     Print Advertising Fee Check                 
*       * Snippet:    59                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pya
use data_loc in 0
sele data_loc
if cCompNo="NAT999" or cCompNo="NAT991"
	loca for company_no="NAT000"
else
	loca for company_no=cCompNo
endif
*--> Don't call form if we cannot locate bank information.
if found()
	use
	do form adv_afr_bp_ck with "AdvFee"
else
	use
	messagebox("Cannot locate Bank Info.",48,"  No Bank Info Record")
endif




*       *********************************************************
*       *                                                         
*       * _1AL109PYB  ON SELECTION BAR 13 OF POPUP company        
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  121          
*       * Called By:  ON SELECTION BAR 13 OF POPUP company        
*       * Prompt:     Print BP & Bond Check                       
*       * Snippet:    60                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pyb
use data_loc in 0
sele data_loc
if cCompNo="NAT999" or cCompNo="NAT991"
	loca for company_no="NAT000"
else
	loca for company_no=cCompNo
endif
*--> Don't call form if we cannot locate bank information.
if found()
	use
	do form adv_afr_bp_ck with "BPBond"
else
	use
	messagebox("Cannot locate Bank Info.",48,"  No Bank Info Record")
endif






*       *********************************************************
*       *                                                         
*       * _1AL109PYJ  ON SELECTION BAR 15 OF POPUP company        
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  124          
*       * Called By:  ON SELECTION BAR 15 OF POPUP company        
*       * Prompt:     Print Tax Liability Report                  
*       * Snippet:    61                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pyj
DO FORM taxliability



*       *********************************************************
*       *                                                         
*       * _1AL109PYK  ON SELECTION BAR 17 OF POPUP company        
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  127          
*       * Called By:  ON SELECTION BAR 17 OF POPUP company        
*       * Prompt:     Notes Receivable Report                     
*       * Snippet:    62                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pyk
Do form NotesReceivableReport


*       *********************************************************
*       *                                                         
*       * _1AL109PYT  ON SELECTION BAR 18 OF POPUP company        
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  128          
*       * Called By:  ON SELECTION BAR 18 OF POPUP company        
*       * Prompt:     Obligations Report                          
*       * Snippet:    63                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pyt
Do Form ObligationsReport


*       *********************************************************
*       *                                                         
*       * _1AL109PYU  ON SELECTION BAR 22 OF POPUP company        
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  138          
*       * Called By:  ON SELECTION BAR 22 OF POPUP company        
*       * Prompt:     End Of Month Posting                        
*       * Snippet:    64                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pyu
DO FORM endofmonthposting


*       *********************************************************
*       *                                                         
*       * _1AL109PZ3  ON SELECTION BAR 1 OF POPUP feescollec      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  105          
*       * Called By:  ON SELECTION BAR 1 OF POPUP feescollec      
*       * Prompt:     Print Fees Collected Possible Payment Report 
*       * Snippet:    65                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pz3
Do form FeesCollCheck with "Report"


*       *********************************************************
*       *                                                         
*       * _1AL109PZ4  ON SELECTION BAR 2 OF POPUP feescollec      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  106          
*       * Called By:  ON SELECTION BAR 2 OF POPUP feescollec      
*       * Prompt:     Print Fees Collected Check                  
*       * Snippet:    66                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pz4
use data_loc in 0
sele data_loc
if cCompNo="NAT999" or cCompNo="NAT991"
	loca for company_no="NAT000"
else
	loca for company_no=cCompNo
endif
*--> Don't call form if we cannot locate bank information.
if found()
	use
	Do form FeesCollCheck with "Checks"
else
	use
	messagebox("Cannot locate Bank Info.",48,"  No Bank Info Record")
endif




*       *********************************************************
*       *                                                         
*       * _1AL109PZ5  ON SELECTION BAR 3 OF POPUP feescollec      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  107          
*       * Called By:  ON SELECTION BAR 3 OF POPUP feescollec      
*       * Prompt:     Print Fees Collected Check Register         
*       * Snippet:    67                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pz5
Do form FeesCollCheck with "Register"


*       *********************************************************
*       *                                                         
*       * _1AL109PZ6  ON SELECTION BAR 4 OF POPUP feescollec      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  108          
*       * Called By:  ON SELECTION BAR 4 OF POPUP feescollec      
*       * Prompt:     Print Fees Collected Report                 
*       * Snippet:    68                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pz6
Do form FeesCollected


*       *********************************************************
*       *                                                         
*       * _1AL109PZD  ON SELECTION BAR 5 OF POPUP feescollec      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  109          
*       * Called By:  ON SELECTION BAR 5 OF POPUP feescollec      
*       * Prompt:     Record Fees Collected                       
*       * Snippet:    69                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pzd
DO FORM recordfeescollected


*       *********************************************************
*       *                                                         
*       * _1AL109PZE  ON SELECTION BAR 1 OF POPUP negativedu      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  112          
*       * Called By:  ON SELECTION BAR 1 OF POPUP negativedu      
*       * Prompt:     Print ND Possible  Payment Report           
*       * Snippet:    70                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pze
Do form NegDueChecks with "Report"


*       *********************************************************
*       *                                                         
*       * _1AL109PZF  ON SELECTION BAR 2 OF POPUP negativedu      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  113          
*       * Called By:  ON SELECTION BAR 2 OF POPUP negativedu      
*       * Prompt:     Print ND Collected Check                    
*       * Snippet:    71                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pzf
use data_loc in 0
sele data_loc
if cCompNo="NAT999" or cCompNo="NAT991"
	loca for company_no="NAT000"
else
	loca for company_no=cCompNo
endif
*--> Don't call form if we cannot locate bank information.
if found()
	use
	Do form NegDueChecks with "Checks"
else
	use
	messagebox("Cannot locate Bank Info.",48,"  No Bank Info Record")
endif



*       *********************************************************
*       *                                                         
*       * _1AL109PZO  ON SELECTION BAR 3 OF POPUP negativedu      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  114          
*       * Called By:  ON SELECTION BAR 3 OF POPUP negativedu      
*       * Prompt:     Print ND Check Register                     
*       * Snippet:    72                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pzo
Do form NegDueChecks with "Register"


*       *********************************************************
*       *                                                         
*       * _1AL109PZP  ON SELECTION BAR 4 OF POPUP negativedu      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  115          
*       * Called By:  ON SELECTION BAR 4 OF POPUP negativedu      
*       * Prompt:     Print ND Collected Report                   
*       * Snippet:    73                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pzp
Do form NegDueCollected with "NDCollected"


*       *********************************************************
*       *                                                         
*       * _1AL109PZQ  ON SELECTION BAR 5 OF POPUP negativedu      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  116          
*       * Called By:  ON SELECTION BAR 5 OF POPUP negativedu      
*       * Prompt:     Print ND Paid Report                        
*       * Snippet:    74                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pzq
Do form NegDueCollected with "NDPaid"


*       *********************************************************
*       *                                                         
*       * _1AL109PZY  ON SELECTION BAR 1 OF POPUP specialtru      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  133          
*       * Called By:  ON SELECTION BAR 1 OF POPUP specialtru      
*       * Prompt:     Special Trust Recap                         
*       * Snippet:    75                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pzy
DO Form SpecialTrustRecap


*       *********************************************************
*       *                                                         
*       * _1AL109PZZ  ON SELECTION BAR 2 OF POPUP specialtru      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  134          
*       * Called By:  ON SELECTION BAR 2 OF POPUP specialtru      
*       * Prompt:     Special Trust Fran Advance Recap            
*       * Snippet:    76                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109pzz
Do form SpecialTrustFranAdvRecap


*       *********************************************************
*       *                                                         
*       * _1AL109Q00  ON SELECTION BAR 3 OF POPUP specialtru      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  135          
*       * Called By:  ON SELECTION BAR 3 OF POPUP specialtru      
*       * Prompt:     Special Trust Unrecorded Deposits From AR Log 
*       * Snippet:    77                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109q00
Do form SpecialTrustUnDeposits


*       *********************************************************
*       *                                                         
*       * _1AL109Q08  ON SELECTION BAR 1 OF POPUP accountsre      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  141          
*       * Called By:  ON SELECTION BAR 1 OF POPUP accountsre      
*       * Prompt:     Cash Receipts Maintenance                   
*       * Snippet:    78                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109q08
DO FORM CASHRECEIPTSINFO


*       *********************************************************
*       *                                                         
*       * _1AL109Q09  ON SELECTION BAR 2 OF POPUP accountsre      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  142          
*       * Called By:  ON SELECTION BAR 2 OF POPUP accountsre      
*       * Prompt:     Other Deposits Maintenance                  
*       * Snippet:    79                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109q09
do form enterotherdeposits


*       *********************************************************
*       *                                                         
*       * _1AL109Q0A  ON SELECTION BAR 6 OF POPUP accountsre      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  153          
*       * Called By:  ON SELECTION BAR 6 OF POPUP accountsre      
*       * Prompt:     Monthly Log By Day                          
*       * Snippet:    80                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109q0a
do form MonthlyLogByDay


*       *********************************************************
*       *                                                         
*       * _1AL109Q0I  ON SELECTION BAR 7 OF POPUP accountsre      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  154          
*       * Called By:  ON SELECTION BAR 7 OF POPUP accountsre      
*       * Prompt:     Percent Pd By Day                           
*       * Snippet:    81                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109q0i
do form percentbyday


*       *********************************************************
*       *                                                         
*       * _1AL109Q0J  ON SELECTION BAR 1 OF POPUP arreports       
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  147          
*       * Called By:  ON SELECTION BAR 1 OF POPUP arreports       
*       * Prompt:     AR Log                                      
*       * Snippet:    82                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109q0j
Do Form ARLog



*       *********************************************************
*       *                                                         
*       * _1AL109Q0K  ON SELECTION BAR 2 OF POPUP arreports       
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  148          
*       * Called By:  ON SELECTION BAR 2 OF POPUP arreports       
*       * Prompt:     Aging Report                                
*       * Snippet:    83                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109q0k
DO FORM SelectAging



*       *********************************************************
*       *                                                         
*       * _1AL109Q0S  ON SELECTION BAR 3 OF POPUP arreports       
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  149          
*       * Called By:  ON SELECTION BAR 3 OF POPUP arreports       
*       * Prompt:     AR History                                  
*       * Snippet:    84                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109q0s
DO FORM SelectARHistory



*       *********************************************************
*       *                                                         
*       * _1AL109Q0T  ON SELECTION BAR 4 OF POPUP arreports       
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  150          
*       * Called By:  ON SELECTION BAR 4 OF POPUP arreports       
*       * Prompt:     Other Deposits                              
*       * Snippet:    85                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109q0t
Do form OtherDeposits





*       *********************************************************
*       *                                                         
*       * _1AL109Q12  ON SELECTION BAR 9 OF POPUP utilities       
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  197          
*       * Called By:  ON SELECTION BAR 9 OF POPUP utilities       
*       * Prompt:     Edit Bank Path                              
*       * Snippet:    86                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109q12
*Do form editbankpath
Do form bankpathinfo



*       *********************************************************
*       *                                                         
*       * _1AL109Q13  ON SELECTION BAR 10 OF POPUP utilities      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  198          
*       * Called By:  ON SELECTION BAR 10 OF POPUP utilities      
*       * Prompt:     Print  STA Check                            
*       * Snippet:    87                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109q13
use data_loc in 0
sele data_loc
if cCompNo="NAT999" or cCompNo="NAT991"
	loca for company_no="NAT000"
else
	loca for company_no=cCompNo
endif
*--> Don't call form if we cannot locate bank information.
if found()
	use
	do form SpecialTrustCheck
else
	use
	messagebox("Cannot locate Bank Info.",48,"  No Bank Info Record")
endif




*       *********************************************************
*       *                                                         
*       * _1AL109Q14  ON SELECTION BAR 11 OF POPUP utilities      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  199          
*       * Called By:  ON SELECTION BAR 11 OF POPUP utilities      
*       * Prompt:     Special Trust Account Transfer              
*       * Snippet:    88                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109q14
do form SpecialTrustAcctTran


*       *********************************************************
*       *                                                         
*       * _1AL109Q1C  ON SELECTION BAR 1 OF POPUP databaseut      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  159          
*       * Called By:  ON SELECTION BAR 1 OF POPUP databaseut      
*       * Prompt:     Reindex Databases                           
*       * Snippet:    89                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109q1c
do form reindexdatabase



*       *********************************************************
*       *                                                         
*       * _1AL109Q1D  ON SELECTION BAR 2 OF POPUP databaseut      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  160          
*       * Called By:  ON SELECTION BAR 2 OF POPUP databaseut      
*       * Prompt:     Fix Cross Linked Customers                  
*       * Snippet:    90                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109q1d
do form fixcrosslinkedcust


*       *********************************************************
*       *                                                         
*       * _1AL109Q1E  ON SELECTION BAR 3 OF POPUP databaseut      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  161          
*       * Called By:  ON SELECTION BAR 3 OF POPUP databaseut      
*       * Prompt:     Fix Memo Files                              
*       * Snippet:    91                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109q1e
*--> Fix Customer Service Files
WAIT window "Repairing Customer Service File..." nowait
USE cDataLoc+"service" in 0
SELE service
COPY to cDataLoc+"tmpServ" type fox2x
USE
tmpFile1=cDataLoc+"oldServ.dbf"
tmpFile2=cDataLoc+"oldServ.fpt"
*--> Delete old files if they exist.
if file(tmpFile1)
	Dele file cDataLoc+"oldServ.dbf"
endif
if file(tmpFile2)
	Dele File cDataLoc+"oldServ.fpt"
endif
*--> Rename current files, so we still have them - just in case.
RENAME cDataLoc+"service.dbf" to cDataLoc+"oldServ.dbf"
RENAME cDataLoc+"service.fpt" to cDataLoc+"oldServ.fpt"
*--> Rename repaired files to proper name for use.
RENAME cDataLoc+"tmpServ.dbf" to cDataLoc+"service.dbf"
RENAME cDataLoc+"tmpServ.fpt" to cDataLoc+"service.fpt"
*--> rebuild Indexes.
WAIT window "Rebuilding Indexes..." nowait
USE cdataLoc+"service" in 0 excl
sele service
Dele TAG ALL
PACK
INDEX ON Cust_No+STR({02/02/2202}-Call_Date) TAG Cust_No
INDEX ON Call_Date                           TAG Call_Date
INDEX ON Cust_No							 TAG Cust
USE

*--> Fix Customer Service History Files
WAIT window "Repairing Customer Service History File..." nowait
USE cDataLoc+"servhst" in 0
SELE servhst
COPY to cDataLoc+"tmpSHst" type fox2x
USE
tmpFile1=cDataLoc+"oldSHst.dbf"
tmpFile2=cDataLoc+"oldSHst.fpt"
*--> Delete old files if they exist.
if file(tmpFile1)
	Dele file cDataLoc+"oldSHst.dbf"
endif
if file(tmpFile2)
	Dele File cDataLoc+"oldSHst.fpt"
endif
*--> Rename current files, so we still have them - just in case.
RENAME cDataLoc+"servhst.dbf" to cDataLoc+"oldSHst.dbf"
RENAME cDataLoc+"servhst.fpt" to cDataLoc+"oldSHst.fpt"
*--> Rename repaired files to proper name for use.
RENAME cDataLoc+"tmpSHst.dbf" to cDataLoc+"servhst.dbf"
RENAME cDataLoc+"tmpSHst.fpt" to cDataLoc+"servhst.fpt"
*--> rebuild Indexes.
WAIT window "Rebuilding Indexes..." nowait
USE cdataLoc+"servhst" in 0 excl
sele servhst
Dele TAG ALL
PACK
INDEX ON Cust_No+STR({02/02/2202}-Call_Date) TAG Cust_No
INDEX ON Call_Date                           TAG Call_Date
INDEX ON Cust_No							 TAG Cust
USE

*--> Fix Collection Calls Files
WAIT window "Repairing Collections File..." nowait
USE cDataLoc+"jkcuscol" in 0
SELE jkcuscol
COPY to cDataLoc+"tmpColl" type fox2x
USE
tmpFile1=cDataLoc+"oldColl.dbf"
tmpFile2=cDataLoc+"oldColl.fpt"
*--> Delete old files if they exist.
if file(tmpFile1)
	Dele file cDataLoc+"oldColl.dbf"
endif
if file(tmpFile2)
	Dele File cDataLoc+"oldColl.fpt"
endif
*--> Rename current files, so we still have them  - just in case.
RENAME cDataLoc+"jkcuscol.dbf" to cDataLoc+"oldColl.dbf"
RENAME cDataLoc+"jkcuscol.fpt" to cDataLoc+"oldColl.fpt"
*--> Rename repaired files to proper name for use.
RENAME cDataLoc+"tmpColl.dbf" to cDataLoc+"jkcuscol.dbf"
RENAME cDataLoc+"tmpColl.fpt" to cDataLoc+"jkcuscol.fpt"
*--> rebuild Indexes.
WAIT window "Rebuilding Indexes..." nowait
USE cDataLoc+"jkcuscol" in 0 excl
Dele TAG ALL
PACK
INDEX ON Cust_No+STR({02/02/2202}-Call_Date) TAG Cust_No
INDEX ON Call_Date                           TAG Call_Date
INDEX ON Cust_No							 TAG Cust
USE

*--> Fix Collection Calls History Files
WAIT window "Repairing Collections History File..." nowait
USE cDataLoc+"collhst" in 0
SELE collhst
COPY to cDataLoc+"tmpCHst" type fox2x
USE
tmpFile1=cDataLoc+"oldCHst.dbf"
tmpFile2=cDataLoc+"oldCHst.fpt"
*--> Delete old files if they exist.
if file(tmpFile1)
	Dele file cDataLoc+"oldCHst.dbf"
endif
if file(tmpFile2)
	Dele File cDataLoc+"oldCHst.fpt"
endif
*--> Rename current files, so we still have them  - just in case.
RENAME cDataLoc+"collhst.dbf" to cDataLoc+"oldCHst.dbf"
RENAME cDataLoc+"collhst.fpt" to cDataLoc+"oldCHst.fpt"
*--> Rename repaired files to proper name for use.
RENAME cDataLoc+"tmpCHst.dbf" to cDataLoc+"collhst.dbf"
RENAME cDataLoc+"tmpCHst.fpt" to cDataLoc+"collhst.fpt"
*--> rebuild Indexes.
WAIT window "Rebuilding Indexes..." nowait
USE cDataLoc+"collhst" in 0 excl
Dele TAG ALL
PACK
INDEX ON Cust_No+STR({02/02/2202}-Call_Date) TAG Cust_No
INDEX ON Call_Date                           TAG Call_Date
INDEX ON Cust_No							 TAG Cust
USE

*--> Fix Franchisee Calls Files
WAIT window "Repairing Franchisee Calls File..." nowait
USE cDataLoc+"FranCall" in 0 alias FranCall
SELE FranCall
COPY to cDataLoc+"tmpFCall" type fox2x
USE
tmpFile1=cDataLoc+"oldFCall.dbf"
tmpFile2=cDataLoc+"oldFCall.fpt"
*--> Delete old files if they exist.
if file(tmpFile1)
	Dele file cDataLoc+"oldFCall.dbf"
endif
if file(tmpFile2)
	Dele File cDataLoc+"oldFCall.fpt"
endif
*--> Rename current files, so we still have them  - just in case.
RENAME cDataLoc+"FranCall.dbf" to cDataLoc+"oldFCall.dbf"
RENAME cDataLoc+"FranCall.fpt" to cDataLoc+"oldFCall.fpt"
*--> Rename repaired files to proper name for use.
RENAME cDataLoc+"tmpFCall.dbf" to cDataLoc+"FranCall.dbf"
RENAME cDataLoc+"tmpFCall.fpt" to cDataLoc+"FranCall.fpt"
*--> rebuild Indexes.
WAIT window "Rebuilding Indexes..." nowait
USE cDataLoc+"FranCall" in 0 excl
Dele TAG ALL
PACK
INDEX ON Dlr_Code+STR({02/02/2202}-Call_Date) TAG FranCall
INDEX ON Call_Date                           TAG Call_Date
INDEX ON Dlr_Code							 TAG Dlr
USE

WAIT clear
Clos all
Clea
RETURN



*       *********************************************************
*       *                                                         
*       * _1AL109Q1M  ON SELECTION BAR 1 OF POPUP systemutil      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  166          
*       * Called By:  ON SELECTION BAR 1 OF POPUP systemutil      
*       * Prompt:     Archive Data                                
*       * Snippet:    92                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109q1m
cMessageTitle = 'Archive Data'
cMessageText = 'Is this the correct Date?'+CHR(13)+CHR(13)+DTOC(DATE())
nDialogType = 4 + 32 + 256
*  4 = Yes and No buttons
*  32 = Question mark icon
*  256 = Second button is default

stop_proc = .F.
nAnswer = MESSAGEBOX(cMessageText, nDialogType, cMessageTitle)

DO CASE
CASE nAnswer = 6

ON ERROR DO stop_proc	

*!*	ON ERROR DO stop_proc WITH ;
*!*	   ERROR( ), MESSAGE( ), MESSAGE(1), PROGRAM( ), LINENO( )

	IF stop_proc=.F.
		use service in 0 excl
		if !file('servhst.dbf')
			sele service
			copy stru to servhst
		endif
		use servhst in 0
	ENDIF
	
	IF stop_proc=.F.
		use jkcuscol in 0 excl
		if !file('collhst.dbf')
			sele jkcuscol
			copy stru to collhst
		endif
		use collhst in 0
	ENDIF	

	IF stop_proc=.F.
		use jkarofil in 0 excl
		if !file('delaro.dbf')
			sele jkarofil
			copy stru to delaro
		endif	
		use delaro in 0
		IF !FILE ('arohist.dbf')
			Sele jkarofil
			COPY STRU TO arohist
		ENDIF
		use arohist in 0
	ENDIF	
	
	*--> KMC 07/27/2004 - To Archive old Telemarketing calls.	
	xTele=.F.
	IF stop_proc = .F.
		if file(cDataLoc+'custleads\custleadcalls.dbf')
			xTele=.T.
			use cDataLoc+"custleads\custleadcalls" in 0 excl
			if !file(cDataLoc+'custleads\clcallhst.dbf')
				sele custleadcalls
				copy stru to cDataLoc+"custleads\clcallhst"
			endif	
			use cDataLoc+"CustLeads\clcallhst" in 0
		endif
	ENDIF	
	*-->

	IF stop_proc
		CLOSE DATA ALL
		ON ERROR && Reset Error routine back to default setting.
		RETURN
	ENDIF

	WAIT WINDOW "Archiving old AR and call records..." NOWAIT
	
	&& KMC 01/25/2001
	&& Get the deleted records and save them to delaro, just in case
	&& we need to bring it back sometime, payments here are virtually
	&& impossible to recover otherwise.
	SET DELE OFF
	SELE * FROM jkarofil WHERE DELETED() INTO TABLE tmp
	SELE delaro
	APPEND FROM tmp
	use
	sele tmp
	use
	dele file tmp.dbf
	SET DELE ON

	&& Select all AR older than 6 months and paid in full.
	SELE * FROM jkarofil WHERE date_inv<GOMONTH(DATE(),-6) AND ;
		itm_amt+itm_tax=check_amt+check_amt2+check_amt3+check_amt4+check_amt5 ;
		AND check_date<GOMONTH(DATE(),-6) ;
		AND check_dat2<GOMONTH(DATE(),-6) ;
		AND check_dat3<GOMONTH(DATE(),-6) ;
		AND check_dat4<GOMONTH(DATE(),-6) ;
		AND check_dat5<GOMONTH(DATE(),-6) ;
		AND !DELETED() ;
		INTO TABLE tmp
	SELE arohist
	APPEND FROM tmp
	use
	sele tmp
	use
	DELE FILE tmp.DBF
	Sele jkarofil
	DELE ALL FOR date_inv<GOMONTH(DATE(),-6) AND ;
		itm_amt+itm_tax=check_amt+check_amt2+check_amt3+check_amt4+check_amt5 ;
		AND check_date<GOMONTH(DATE(),-6) ;
		AND check_dat2<GOMONTH(DATE(),-6) ;
		AND check_dat3<GOMONTH(DATE(),-6) ;
		AND check_dat4<GOMONTH(DATE(),-6) ;
		AND check_dat5<GOMONTH(DATE(),-6)
	PACK
	use
	
	&& Select all Customer Service records older than 6 months.
	WAIT WINDOW "Archiving old Customer Service records..." NOWAIT
	SELE * FROM service WHERE call_date<GOMONTH(DATE(),-6) AND !DELETED() INTO TABLE tmp
	SELE servhst
	APPEND FROM tmp
	use
	sele tmp
	use
	DELE FILE tmp.DBF
	sele service
	DELE ALL FOR call_date<GOMONTH(DATE(),-6)
	PACK
	use
	
	&& Select all Collection records more than 6 months old.
	WAIT WINDOW "Archiving old Collections records..." NOWAIT
	SELE * FROM jkcuscol WHERE call_date<GOMONTH(DATE(),-6) AND !DELETED() INTO TABLE tmp
	SELE collhst
	APPEND FROM tmp
	use
	sele tmp
	use
	dele file tmp.dbf
	sele jkcuscol
	DELE ALL FOR call_date<GOMONTH(DATE(),-6)
	PACK
	use

	&& KMC 07/27/2004 - Select all Telemarketing calls more than 6 months old.
	if xTele
		WAIT WINDOW "Archiving old Telemarketing calls..." NOWAIT
		SELE * FROM cDataLoc+"custleads\custleadcalls" WHERE calldate<GOMONTH(DATE(),-6) AND !DELETED() INTO TABLE tmp
		IF _TALLY > 0
			SELE clcallhst
			APPEND FROM tmp
			use
			sele tmp
			use
			dele file tmp.dbf
			sele custleadcalls
			DELE ALL FOR calldate<GOMONTH(DATE(),-6)
			PACK
			use	
		ENDIF	
	endif
	
	clos data all
	ON ERROR
	WAIT CLEAR
	MESSAGEBOX("Archive Data Completed!",48)
	
CASE nAnswer = 7
	* WAIT WINDOW 'You chose No'
ENDCASE

PROC stop_proc
*!*	PARAMETER merror, mess, mess1, mprog, mlineno
*!*	CLEAR
*!*	?
*!*	?
*!*	?
*!*	?
*!*	?
*!*	?
*!*	?
*!*	?
*!*	?

*!*	?"Error number: " + LTRIM(STR(merror))
*!*	?"Error message: " +  mess
*!*	?"Line of code with error: " + mess1
*!*	?"Line number of error: " + LTRIM(STR(mlineno))
*!*	?"Program with error: " + mprog
*!*	WAIT WIND

	WAIT CLEAR
	CLOSE DATA ALL
	ON ERROR
	messagebox("WARNING!  Someone is still in the system.  Please try again later.",48," System Alert")
	stop_proc=.T.
RETURN



*       *********************************************************
*       *                                                         
*       * _1AL109Q1N  ON SELECTION BAR 2 OF POPUP systemutil      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  167          
*       * Called By:  ON SELECTION BAR 2 OF POPUP systemutil      
*       * Prompt:     Payment Calculator                          
*       * Snippet:    93                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109q1n
do form payments


*       *********************************************************
*       *                                                         
*       * _1AL109Q1W  ON SELECTION BAR 3 OF POPUP systemutil      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  168          
*       * Called By:  ON SELECTION BAR 3 OF POPUP systemutil      
*       * Prompt:     Recall Archived Invoice                     
*       * Snippet:    94                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109q1w
DO FORM RECALLARCHIVEDINVOICE with "Recall"


*       *********************************************************
*       *                                                         
*       * _1AL109Q1X  ON SELECTION BAR 4 OF POPUP systemutil      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  169          
*       * Called By:  ON SELECTION BAR 4 OF POPUP systemutil      
*       * Prompt:     Recall Deleted Invoice                      
*       * Snippet:    95                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109q1x
DO FORM RecallDeletedInvoice



*       *********************************************************
*       *                                                         
*       * _1AL109Q1Y  ON SELECTION BAR 5 OF POPUP systemutil      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  170          
*       * Called By:  ON SELECTION BAR 5 OF POPUP systemutil      
*       * Prompt:     Reverse Charge-Back Checks                  
*       * Snippet:    96                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109q1y
DO FORM REVERSECHARGEBACKCHECKS


*       *********************************************************
*       *                                                         
*       * _1AL109Q26  ON SELECTION BAR 6 OF POPUP systemutil      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  171          
*       * Called By:  ON SELECTION BAR 6 OF POPUP systemutil      
*       * Prompt:     Split Invoice                               
*       * Snippet:    97                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109q26
x=messagebox(" Be sure that all CB/TAR checks have been printed BEFORE splitting an invoice."+CHR(13)+ ;
" Failure to do so can result in CB/TAR checks not being generated for the invoice being split."+CHR(13)+ ;
" If you're not sure, run the appropriate Possible CB/TAR report to be certain the invoice"+CHR(13)+ ;
" in question does not have TAR monies waiting to be paid.",65," Invoice Splitter Message")
if x=1
	DO FORM RECALLARCHIVEDINVOICE with "Split"
else
	return
endif		


*       *********************************************************
*       *                                                         
*       * _1AL109Q27  ON SELECTION BAR 7 OF POPUP systemutil      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  172          
*       * Called By:  ON SELECTION BAR 7 OF POPUP systemutil      
*       * Prompt:     Untransfer Customer                         
*       * Snippet:    98                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109q27
DO FORM UNTRANSFERCUSTOMER


*       *********************************************************
*       *                                                         
*       * _1AL109Q28  ON SELECTION BAR 9 OF POPUP systemutil      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  175          
*       * Called By:  ON SELECTION BAR 9 OF POPUP systemutil      
*       * Prompt:     Export Data to Telemarketing                
*       * Snippet:    99                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109q28
x=messagebox ("Click 'OK' to update your Telemarketing database"+CHR(13)+;
			"with data from your customer database.",1," Alert")
if x<>1
	return
endif	

create cursor CheckLeads ;
	(cust_no C(6), ;
	cus_name C(30), ;
	cus_addr C(30), ;
	cus_phone C(10), ;
	LeadId I, ;
	company C(30), ;
	addr1 C(30), ;
	phone C(14))	

use custleads\custleads in 0 order phone
sele custleads
go top
curRegionCode=regioncode

use custleads\keys in 0
sele keys
set filt to table="CUSTLEADS"

*--> Get all cancelled customers that have cancellation dates of 60 days or more ago.
wait window "Selecting all Cancelled accounts..." nowait
sele cust_no, cus_name as Company, cus_addr as Addr1, cus_city as city, cus_state as state, ;
	left(cus_zip,5) as zip, cus_phone as phone, class_type as accttype, cont_bill, ;
	"Franchise Accounting" as leadsource, "PreCust" as Status, "Outsource" as currentvendor, ;
	" " as GroupType, -1 as enteredby, -1 as assignedto, 1 as salesid, curRegionCode as regioncode, ;
	date() as createdate, "USA" as Country, canc_date, candescr ;
	from jkcusfil ;
	where flag<>"A" and empty(secondfran) and !empty(canc_date) ;
	and len(alltrim(cus_phone))=10 ;
	and canc_date=<date()-60 ;
	into cursor tmpCancCust ;
	order by cust_no

*--> Import Cancelled accounts into Telemarketing database.
sele tmpCancCust
set rela to phone into CustLeads
go top
wait window "Updating Telemarking data with Cancelled accounts..." nowait
do while !eof('tmpCancCust')
	if eof('CustLeads')
		*--> Update Telemarketing with JK's cancelled customers.
		wait window "Updating Telemarking data with Cancelled account "+tmpCancCust.cust_no+" - adding record..." nowait
		scatter memvar
		notes="JK Customer "+cust_no+" Cancelled "+DTOC(TmpCancCust.canc_date)+ ;
			iif(!empty(TmpCancCust.candescr)," - Reason: "+alltrim(TmpCancCust.candescr),"") + ;
			"--> system "+dtoc(date())+"."
		BudgetAmt=TmpCancCust.cont_bill
		id=keys.nextid
		repla keys.nextid with keys.nextid+1
		insert into CustLeads\CustLeads from memvar
		repla CustLeads.biddate with NULL CustLeads.lastcontacted with NULL CustLeads.callbdate with NULL ;
		CustLeads.lastmaildate with NULL CustLeads.startdate with NULL CustLeads.solddate with NULL
	else
		if Custleads.Status<>"Sold" and CustLeads.AcctType<>"Franchise Prospect" ;
			and !"JK Customer "+TmpCancCust.cust_no+" Cancelled "+DTOC(TmpCancCust.canc_date) $ CustLeads.Notes
			wait window "Updating Telemarking data with Cancelled account "+tmpCancCust.cust_no+" - updating record..." nowait
			sele CustLeads
			repla Status with "PreCust"					&& Flag as a Previous Customer.
			repla GroupType with "" 					&& GroupType is no longer used.
			repla AcctType with TmpCancCust.accttype	&& Set Account Type.
			repla BudgetAmt with TmpCancCust.cont_bill	&& Store Cancelled accounts Cont Bill Amt.
			repla ContractAmt with 0					&& Clear old contract amt.
			repla SoldDate with NULL	 				&& Clear old Sold date.
			repla StartDate with NULL		  			&& Clear old Start date.
			repla UDF7 with 0							&& Clear old assigned to value.
			if empty(CustLeads.callbdate) or isnull(CustLeads.callbdate)
				*--> If there is no call back date set, unassign the lead.
				repla CallBackBy with ""				&& Clear Call Back by value.
				repla AssignedTo with -1				&& Unassign Lead.
			endif	
			repla notes with alltrim(CustLeads.notes)+" JK Customer "+TmpCancCust.cust_no+ ;
				" Cancelled "+DTOC(TmpCancCust.canc_date)+ ;
				iif(!empty(TmpCancCust.candescr)," - Reason: "+alltrim(TmpCancCust.candescr),"") + ;
				"--> system "+dtoc(date())+"."
		endif
	endif
	sele TmpCancCust	
	skip	
enddo	
use

*--> Get all active customers.
wait window "Selecting all Active accounts..." nowait
sele cust_no, cus_name as Company, cus_addr as Addr1, cus_city as city, cus_state as state, ;
	cus_zip as zip, cus_phone as phone, class_type as accttype, ;
	"Franchise Accounting" as leadsource, "CurCust" as Status, "Outsource" as currentvendor , ;
	" " as GroupType, -1 as enteredby, -1 as assignedto, 1 as salesid, curRegionCode as regioncode, ;
	date() as createdate, "USA" as Country ;
	from jkcusfil ;
	where flag="A" and empty(secondfran) and empty(canc_date) ;
	and len(alltrim(cus_phone))=10 ;
	into cursor tmpCurCust ;
	order by cust_no
	
*--> Import Active Customers into Telemarketing database.
sele tmpCurCust
set rela to phone into CustLeads
go top
wait window "Updating Telemarking data with Active accounts..." nowait
BudgetAmt=0 && Clear BudgetAmt value last set during Cancelled accounts export.
do while !eof('tmpCurCust')
	if eof('CustLeads')
		*--> Update Telemarketing with JK's current customers.
		wait window "Updating Telemarking data with Active account "+tmpCurCust.cust_no+" - adding record..." nowait
		scatter memvar
		notes="JK Customer "+tmpCurCust.cust_no+"--> system "+dtoc(date())+"."
		id=keys.nextid
		repla keys.nextid with keys.nextid+1
		insert into CustLeads\CustLeads from memvar
		repla CustLeads.biddate with NULL CustLeads.lastcontacted with NULL CustLeads.callbdate with NULL ;
		CustLeads.lastmaildate with NULL CustLeads.startdate with NULL CustLeads.solddate with NULL
	else
		if CustLeads.Status<>"CurCust" and AcctType<>"Franchise Prospect"
			if empty(CustLeads.callbdate) or isnull(CustLeads.callbdate)
				wait window "Updating Telemarking data with Active account "+tmpCurCust.cust_no+" - updating record..." nowait
				sele CustLeads
				repla Status with "CurCust"					&& Flag as a Current Customer.
				repla GroupType with ""						&& GroupType is no longer used.
				repla CallBackBy with ""					&& Clear Call Back by value.
				repla UDF7 with Assignedto					&& So we know who the lead WAS assigned to.
				repla AssignedTo with -1					&& Unassign Lead.
				repla AcctType with TmpCurCust.accttype		&& Set Account Type.
				repla CurrentVendor with "Outsource" 		&& Using JK, so account Outsources cleaning services.
				if !"JK Customer "+tmpCurCust.cust_no$CustLeads.notes
					repla notes with alltrim(CustLeads.notes)+ ;
					" JK Customer "+tmpCurCust.cust_no+"--> system "+dtoc(date())+"."
				endif
				&& Any data pertaining to a sold account is left alone.  It will be cleared if
				&& and when the account cancels ands gets updated to PreCust status.	
			else
				if CustLeads.status="Active" or CustLeads.Status="Telemark" ;
				or CustLeads.Status="CustSales" or CustLeads.Status="PreCust"
					*--> Lead is NOT flagged as 'CurCust' AND is not a Franchise Prospect
					*--> but DOES have a Call Back Date.  Not sure of this lead
					*--> (call back date set.. don't want to kill anyones call back),
					*--> so copy it to CheckLeads.
					wait window "Updating Telemarking data with Active account "+tmpCurCust.cust_no+" - updating record..." nowait
					sele CustLeads
					scatter fields company, addr1, phone memvar
					LeadId=CustLeads.Id
					insert into CheckLeads from memvar		
					sele CheckLeads
					repla cust_no with tmpCurCust.cust_no
					repla cus_name with tmpCurCust.company
					repla cus_addr with tmpCurCust.addr1
					repla cus_phone with tmpCurCust.phone
				else
					*--> Status is either "DoNotCall", NotQual" or "Sold"
					*--> AND there is a call back date set.  Based on the
					*--> Status of the lead, the call back date is irrelevant.
					*--> Change status to 'CurCust' and unassign the lead.
					wait window "Updating Telemarking data with Active account "+tmpCurCust.cust_no+" - updating record..." nowait
					sele CustLeads
					repla Status with "CurCust"					&& Flag as a Current Customer.
					repla GroupType with ""						&& GroupType is no longer used.
					repla CallBackBy with ""					&& Clear Call Back by value.
					repla CallBDate with NULL					&& Clear Call Back by value.
					repla UDF7 with Assignedto					&& So we know who the lead WAS assigned to.
					repla AssignedTo with -1					&& Unassign Lead.
					repla AcctType with TmpCurCust.accttype		&& Set Account Type.
					repla CurrentVendor with "Outsource" 		&& Using JK, so account Outsources cleaning services.
					if !"JK Customer "+tmpCurCust.cust_no$CustLeads.notes
						repla notes with alltrim(CustLeads.notes)+ ;
						" JK Customer "+tmpCurCust.cust_no+"--> system "+dtoc(date())+"."
					endif
					&& Any data pertaining to a sold account is left alone.  It will be cleared if and
					&& when the account cancels ands gets updated to PreCust status.	
				endif			
			endif
		endif
	endif
	sele TmpCurCust	
	skip	
enddo	
use

wait clear

sele CheckLeads
go top
if !eof()
	copy to "Leads_to_Check_"+left(cCompNo,3) type xls
	x=messagebox ("Excel Spreadsheet "+sys(5)+sys(2003)+"\Leads_To_Check_"+left(cCompNo,3)+" has been created."+CHR(13)+ ;
		"This spreadsheet lists leads that the system believes may be current customers."+CHR(13)+ ;
		"Please look over the spreadsheet and manually update these leads to"+CHR(13)+ ;
		"'Current Customer' status if appropriate.",0," Alert")
endif
clos all
wait window "Export Complete.  Press any key to continue."
return



*       *********************************************************
*       *                                                         
*       * _1AL109Q2G  ON SELECTION BAR 10 OF POPUP systemutil     
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  176          
*       * Called By:  ON SELECTION BAR 10 OF POPUP systemutil     
*       * Prompt:     Import Telemarketing Leads                  
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109q2g
do form importleads


*       *********************************************************
*       *                                                         
*       * _1AL109Q2H  ON SELECTION BAR 1 OF POPUP taxutiliti      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  181          
*       * Called By:  ON SELECTION BAR 1 OF POPUP taxutiliti      
*       * Prompt:     Print Tax Table                             
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109q2h
IF USED('jktaxtbl')
	SELE jktaxtbl
	USE
ENDIF	
USE jktaxtbl in 0 ORDER countyname
go top
REPO FORM taxtable PREV
CLOSE ALL



*       *********************************************************
*       *                                                         
*       * _1AL109Q2I  ON SELECTION BAR 2 OF POPUP taxutiliti      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  182          
*       * Called By:  ON SELECTION BAR 2 OF POPUP taxutiliti      
*       * Prompt:     Update Tax Table                            
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109q2i
DO FORM ACCESSCODE


*       *********************************************************
*       *                                                         
*       * _1AL109Q2Q  ON SELECTION BAR 1 OF POPUP batchentry      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  202          
*       * Called By:  ON SELECTION BAR 1 OF POPUP batchentry      
*       * Prompt:     Batch Entry                                 
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109q2q
DO form BatchTrxEntry



*       *********************************************************
*       *                                                         
*       * _1AL109Q2R  ON SELECTION BAR 2 OF POPUP batchentry      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  203          
*       * Called By:  ON SELECTION BAR 2 OF POPUP batchentry      
*       * Prompt:     Batch Report                                
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109q2r
Do form BatchReport


*       *********************************************************
*       *                                                         
*       * _1AL109Q30  ON SELECTION BAR 3 OF POPUP batchentry      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  204          
*       * Called By:  ON SELECTION BAR 3 OF POPUP batchentry      
*       * Prompt:     Batch Post                                  
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _1al109q30
x=messagebox ("Click OK to post all Un-Posted Batch Transactions",1," Jani-King")
if x=1
	do postbatchtrx
endif	
