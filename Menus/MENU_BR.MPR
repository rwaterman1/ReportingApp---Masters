*       *********************************************************
*       *                                                         
*       * 09/23/2022            MENU_BR.MPR             08:42:43  
*       *                                                         
*       *********************************************************
*       *                                                         
*       * Author's Name                                           
*       *                                                         
*       * Copyright (C) 2022 Company Name                         
*       * Address                                                 
*       * City,     Zip                                           
*       *                                                         
*       * Description:                                            
*       * This PROGRAM was automatically generated BY GENMENU.    
*       *                                                         
*       *********************************************************


*       *********************************************************
*       *                                                         
*       *                      Menu Definition                    
*       *                                                         
*       *********************************************************
*

SET SYSMENU TO
SET SYSMENU AUTOMATIC

DEFINE PAD _6fo0io55b OF _MSYSMENU PROMPT "\<Lima" COLOR SCHEME 3 ;
	KEY ALT+L, ""
DEFINE PAD _msm_edit OF _MSYSMENU PROMPT "\<Edite" COLOR SCHEME 3 ;
	KEY ALT+E, "ALT+E" ;
	SKIP FOR lDataPathOk=.F. ;
	MESSAGE "Edits text or current selection"
DEFINE PAD _6fo0io55c OF _MSYSMENU PROMPT "\<Cliente" COLOR SCHEME 3 ;
	KEY ALT+C, "" ;
	SKIP FOR lDataPathOk=.F. or MenCust="0"
DEFINE PAD _6fo0io55d OF _MSYSMENU PROMPT "Concessio\<nário" COLOR SCHEME 3 ;
	KEY ALT+N, "" ;
	SKIP FOR lDataPathOk=.F. or MenFran="0"
DEFINE PAD _6fo0io55e OF _MSYSMENU PROMPT "Compan\<hia" COLOR SCHEME 3 ;
	KEY ALT+H, "" ;
	SKIP FOR lDataPathOk=.F. or MenComp="0"
DEFINE PAD _6fo0io55f OF _MSYSMENU PROMPT "Clientes \<Receivable" COLOR SCHEME 3 ;
	KEY ALT+R, "" ;
	SKIP FOR lDataPathOk=.F. or MenAR="0"
DEFINE PAD _6fo0io55g OF _MSYSMENU PROMPT "\<Utilidades" COLOR SCHEME 3 ;
	KEY ALT+U, "" ;
	SKIP FOR lDataPathOk=.F.  or MenUtil="0"
ON PAD _6fo0io55b OF _MSYSMENU ACTIVATE POPUP lima
ON PAD _msm_edit OF _MSYSMENU ACTIVATE POPUP edit
ON PAD _6fo0io55c OF _MSYSMENU ACTIVATE POPUP customers
ON PAD _6fo0io55d OF _MSYSMENU ACTIVATE POPUP concession
ON PAD _6fo0io55e OF _MSYSMENU ACTIVATE POPUP companhia
ON PAD _6fo0io55f OF _MSYSMENU ACTIVATE POPUP clientesre
ON PAD _6fo0io55g OF _MSYSMENU ACTIVATE POPUP utilities

DEFINE POPUP lima MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF lima PROMPT "Selecione o escritório"
DEFINE BAR 2 OF lima PROMPT "Selecione a impressora"
DEFINE BAR 3 OF lima PROMPT "Saída"
ON SELECTION BAR 1 OF lima ;
	DO _6fo0io55h ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 2 OF lima ;
	DO _6fo0io55i ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 3 OF lima ;
	DO _6fo0io55j ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")

DEFINE POPUP edit MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR _med_cut OF edit PROMPT "Corte" ;
	KEY CTRL+X, "Ctrl+X" ;
	MESSAGE "Removes the selection and places it onto the Clipboard"
DEFINE BAR _med_copy OF edit PROMPT "Cópia" ;
	KEY CTRL+C, "Ctrl+C" ;
	MESSAGE "Copies the selection onto the Clipboard"
DEFINE BAR _med_paste OF edit PROMPT "Pasta" ;
	KEY CTRL+V, "Ctrl+V" ;
	MESSAGE "Pastes the contents of the Clipboard"

DEFINE POPUP customers MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF customers PROMPT "Manutenção de lima do cliente" ;
	SKIP FOR CustMaint="0"
DEFINE BAR 2 OF customers PROMPT "Manutenção de transação do cliente" ;
	SKIP FOR CustTrx="0"
DEFINE BAR 3 OF customers PROMPT "\-"
DEFINE BAR 4 OF customers PROMPT "Crie transações mensais do cliente" ;
	SKIP FOR CreateBillRun="0"
DEFINE BAR 5 OF customers PROMPT "Transações mensais do cliente da supressão" ;
	SKIP FOR CreateBillRun="0" or (CreateBillRun="1" and ! "D" $ CreateBillRun)
DEFINE BAR 6 OF customers PROMPT "\-"
DEFINE BAR 7 OF customers PROMPT "Faturamento consolidado" ;
	SKIP FOR ConsolBilling="0"
DEFINE BAR 8 OF customers PROMPT "    Adicione a factura a Bill consolidado existente" ;
	SKIP FOR ConsolBilling="0"
DEFINE BAR 9 OF customers PROMPT "\-"
DEFINE BAR 10 OF customers PROMPT "Facturas" ;
	SKIP FOR CustInv="0"
DEFINE BAR 11 OF customers PROMPT "Dívidas passadas" ;
	SKIP FOR CustPastDue="0"
DEFINE BAR 12 OF customers PROMPT "\-"
DEFINE BAR 13 OF customers PROMPT "Crie a lima de fusão do correio" ;
	SKIP FOR CustMMFile="0"
DEFINE BAR 14 OF customers PROMPT "Fax-UM-Comente - sob a construção" ;
	SKIP FOR 1=1
DEFINE BAR 15 OF customers PROMPT "Formulários da inspeção da cópia" ;
	SKIP FOR CustInsp="0"
DEFINE BAR 16 OF customers PROMPT "Etiquetas da cópia"
ON SELECTION BAR 1 OF customers ;
	DO _6fo0io55k ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 2 OF customers ;
	DO _6fo0io55l ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 4 OF customers ;
	DO _6fo0io55m ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 5 OF customers ;
	DO _6fo0io55n ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 7 OF customers ;
	DO _6fo0io55o ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 8 OF customers ;
	DO _6fo0io55p ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 10 OF customers ;
	DO _6fo0io55q ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON BAR 11 OF customers ACTIVATE POPUP pastdues
ON SELECTION BAR 13 OF customers ;
	DO _6fo0io55r ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 14 OF customers ;
	DO _6fo0io55s ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 15 OF customers ;
	DO _6fo0io55t ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 16 OF customers ;
	DO _6fo0io55u ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")

DEFINE POPUP pastdues MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF pastdues PROMPT "Após - observações devidas"
DEFINE BAR 2 OF pastdues PROMPT "Após - o relatório devido"
ON SELECTION BAR 1 OF pastdues ;
	DO _6fo0io55v ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 2 OF pastdues ;
	DO _6fo0io55w ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")

DEFINE POPUP concession MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF concession PROMPT "Manutenção de lima do concessionário" ;
	SKIP FOR FranMaint="0"
DEFINE BAR 2 OF concession PROMPT "Manutenção de lima da transação do concessionário" ;
	SKIP FOR FranTrx="0"
DEFINE BAR 3 OF concession PROMPT "Manutenção de lima do aluguer" ;
	SKIP FOR LeaseFileMaint="0"
DEFINE BAR 4 OF concession PROMPT "Transferência do aluguer" ;
	SKIP FOR LeaseTransfer="0"
DEFINE BAR 5 OF concession PROMPT "Obrigações" ;
	SKIP FOR FranOblig="0"
DEFINE BAR 6 OF concession PROMPT "\-"
DEFINE BAR 7 OF concession PROMPT "Menu do Charge-Back" ;
	SKIP FOR FranCBMenu="0"
DEFINE BAR 8 OF concession PROMPT "\-"
DEFINE BAR 9 OF concession PROMPT "O concessionário relata o menu" ;
	SKIP FOR FranRptsMenu="0"
DEFINE BAR 10 OF concession PROMPT "\-"
DEFINE BAR 11 OF concession PROMPT "Relatórios variados" ;
	SKIP FOR FranMiscRpts="0"
DEFINE BAR 12 OF concession PROMPT "\-"
DEFINE BAR 13 OF concession PROMPT "Clientes nacionais" ;
	SKIP FOR FranNatAccts="0"
DEFINE BAR 14 OF concession PROMPT "\-"
DEFINE BAR 15 OF concession PROMPT "Crie a lima de fusão do correio" ;
	SKIP FOR FranMMFile="0"
DEFINE BAR 16 OF concession PROMPT "Etiquetas da cópia"
DEFINE BAR 17 OF concession PROMPT "\-"
DEFINE BAR 18 OF concession PROMPT "Menu 1099" ;
	SKIP FOR Fran1099Menu="0"
ON SELECTION BAR 1 OF concession ;
	DO _6fo0io55x ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 2 OF concession ;
	DO _6fo0io55y ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 3 OF concession ;
	DO _6fo0io55z ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 4 OF concession ;
	DO _6fo0io560 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 5 OF concession ;
	DO _6fo0io561 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON BAR 7 OF concession ACTIVATE POPUP menudochar
ON BAR 9 OF concession ACTIVATE POPUP _0s60ii7f5
ON BAR 11 OF concession ACTIVATE POPUP miscreport
ON BAR 13 OF concession ACTIVATE POPUP clientesna
ON SELECTION BAR 15 OF concession ;
	DO _6fo0io562 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 16 OF concession ;
	DO _6fo0io563 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON BAR 18 OF concession ACTIVATE POPUP _1eb0mo9tg

DEFINE POPUP menudochar MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF menudochar PROMPT "Semanal - relatório de Poss CB/TAR"
DEFINE BAR 2 OF menudochar PROMPT "Semanal - verificações de CB/TAR"
DEFINE BAR 3 OF menudochar PROMPT "Mensal - relatório de Poss CB/TAR"
DEFINE BAR 4 OF menudochar PROMPT "Mensal - verificações de CB/TAR"
DEFINE BAR 5 OF menudochar PROMPT "Registo de verificação de CB/TAR"
DEFINE BAR 6 OF menudochar PROMPT "\-"
DEFINE BAR 7 OF menudochar PROMPT "Relatório possível dos CB"
DEFINE BAR 8 OF menudochar PROMPT "Execute o procedimento dos CB"
DEFINE BAR 9 OF menudochar PROMPT "Relatório final dos CB"
DEFINE BAR 10 OF menudochar PROMPT "\-"
DEFINE BAR 11 OF menudochar PROMPT "Relatório da história dos CB"
DEFINE BAR 12 OF menudochar PROMPT "Relatório da história do ND"
DEFINE BAR 13 OF menudochar PROMPT "Letras dos CB da cópia"
ON SELECTION BAR 1 OF menudochar ;
	DO _6fo0io564 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 2 OF menudochar ;
	DO _6fo0io565 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 3 OF menudochar ;
	DO _6fo0io566 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 4 OF menudochar ;
	DO _6fo0io567 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 5 OF menudochar ;
	DO _6fo0io568 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 7 OF menudochar ;
	DO _6fo0io569 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 8 OF menudochar ;
	DO _6fo0io56a ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 9 OF menudochar ;
	DO _6fo0io56b ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 11 OF menudochar ;
	DO _6fo0io56c ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 12 OF menudochar ;
	DO _6fo0io56d ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 13 OF menudochar ;
	DO _6fo0io56e ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")

DEFINE POPUP _0s60ii7f5 MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF _0s60ii7f5 PROMPT "Crie/relatório concessionário da cópia"
DEFINE BAR 2 OF _0s60ii7f5 PROMPT "\<Relatório do concessionário da reprodução"
DEFINE BAR 3 OF _0s60ii7f5 PROMPT "\<Spreadsheet do concessionário da cópia"
DEFINE BAR 4 OF _0s60ii7f5 PROMPT "\-"
DEFINE BAR 5 OF _0s60ii7f5 PROMPT "Verificações devidas de Fran da cópia"
DEFINE BAR 6 OF _0s60ii7f5 PROMPT "Registo de verificação devido de Fran da cópia"
DEFINE BAR 7 OF _0s60ii7f5 PROMPT "\-"
DEFINE BAR 8 OF _0s60ii7f5 PROMPT "Relatório incorporado das dívidas da cópia"
DEFINE BAR 9 OF _0s60ii7f5 PROMPT "& dos comp(s) dos trabalhadores da cópia; Relatório da responsabilidade" ;
	SKIP FOR 1=1
DEFINE BAR 10 OF _0s60ii7f5 PROMPT "\-"
DEFINE BAR 11 OF _0s60ii7f5 PROMPT "Manutenção do desconto da taxa da contabilidade"
DEFINE BAR 12 OF _0s60ii7f5 PROMPT "Relatório do desconto da taxa da contabilidade da cópia"
DEFINE BAR 13 OF _0s60ii7f5 PROMPT "Verificação do desconto da taxa da contabilidade da cópia"
ON SELECTION BAR 1 OF _0s60ii7f5 ;
	DO _6fo0io56f ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 2 OF _0s60ii7f5 ;
	DO _6fo0io56g ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 3 OF _0s60ii7f5 ;
	DO _6fo0io56h ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 5 OF _0s60ii7f5 ;
	DO _6fo0io56i ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 6 OF _0s60ii7f5 ;
	DO _6fo0io56j ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 8 OF _0s60ii7f5 ;
	DO _6fo0io56k ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 9 OF _0s60ii7f5 ;
	DO _6fo0io56l ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 11 OF _0s60ii7f5 ;
	DO _6fo0io56m ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 12 OF _0s60ii7f5 ;
	DO _6fo0io56n ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 13 OF _0s60ii7f5 ;
	DO _6fo0io56o ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")

DEFINE POPUP miscreport MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF miscreport PROMPT "Abas do concessionário"
DEFINE BAR 2 OF miscreport PROMPT "O concessionário alcangou primeiramente uma quantidade de factura especific"
DEFINE BAR 3 OF miscreport PROMPT "Sumário anual do concessionário"
DEFINE BAR 4 OF miscreport PROMPT "Relatório da dívida do negativo"
DEFINE BAR 5 OF miscreport PROMPT "Relatório coletado não 3%"
DEFINE BAR 6 OF miscreport PROMPT "Relatório do Recap do Pager"
DEFINE BAR 7 OF miscreport PROMPT "Relatório do Recap da fonte"
ON SELECTION BAR 1 OF miscreport ;
	DO _6fo0io56p ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 2 OF miscreport ;
	DO _6fo0io56q ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 3 OF miscreport ;
	DO _6fo0io56r ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 4 OF miscreport ;
	DO _6fo0io56s ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 5 OF miscreport ;
	DO _6fo0io56t ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 6 OF miscreport ;
	DO _6fo0io56u ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 7 OF miscreport ;
	DO _6fo0io56v ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")

DEFINE POPUP clientesna MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF clientesna PROMPT "Pagamento maioria da factura"
DEFINE BAR 2 OF clientesna PROMPT "Relatório possível do pagamento"
DEFINE BAR 3 OF clientesna PROMPT "Verificações da cópia"
DEFINE BAR 4 OF clientesna PROMPT "Registo de verificação"
ON SELECTION BAR 1 OF clientesna ;
	DO _6fo0io56w ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 2 OF clientesna ;
	DO _6fo0io56x ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 3 OF clientesna ;
	DO _6fo0io56y ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 4 OF clientesna ;
	DO _6fo0io56z ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")

DEFINE POPUP _1eb0mo9tg MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF _1eb0mo9tg PROMPT "Relatório da cópia 1099"
DEFINE BAR 2 OF _1eb0mo9tg PROMPT "Cópia 1099' s"
ON SELECTION BAR 1 OF _1eb0mo9tg ;
	DO _6fo0io570 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 2 OF _1eb0mo9tg ;
	DO _6fo0io571 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")

DEFINE POPUP companhia MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF companhia PROMPT "Manutenção de lima da companhia" ;
	SKIP FOR CompFileMaint="0"
DEFINE BAR 2 OF companhia PROMPT "Manutenção de lima do controle" ;
	SKIP FOR ControlFileMaint="0"
DEFINE BAR 3 OF companhia PROMPT "Restaure os parâmetros de sistema (Side1/Side2)" ;
	SKIP FOR ResetParam="0"
DEFINE BAR 4 OF companhia PROMPT "\-"
DEFINE BAR 5 OF companhia PROMPT "Manutenção especial do registo de verificação da confiança" ;
	SKIP FOR STACheckReg="0"
DEFINE BAR 6 OF companhia PROMPT "Manutenção da informação do banco" ;
	SKIP FOR BankAcctInfo="0"
DEFINE BAR 7 OF companhia PROMPT "\-"
DEFINE BAR 8 OF companhia PROMPT "Taxas coletadas"
DEFINE BAR 9 OF companhia PROMPT "Negativo devido"
DEFINE BAR 10 OF companhia PROMPT "\-"
DEFINE BAR 11 OF companhia PROMPT "Verificação da taxa da contabilidade da cópia"
DEFINE BAR 12 OF companhia PROMPT "Cópia que anuncia a verificação da taxa"
DEFINE BAR 13 OF companhia PROMPT "& de BP da cópia; Verificação bond"
DEFINE BAR 14 OF companhia PROMPT "\-"
DEFINE BAR 15 OF companhia PROMPT "Relatório da responsabilidade de imposto da cópia"
DEFINE BAR 16 OF companhia PROMPT "\-"
DEFINE BAR 17 OF companhia PROMPT "Relatório das taxas dos inventores"
DEFINE BAR 18 OF companhia PROMPT "Relatório Receivable das notas"
DEFINE BAR 19 OF companhia PROMPT "Relatório das obrigações"
DEFINE BAR 20 OF companhia PROMPT "Rendimento projetado (& do FF; Aluguer)"
DEFINE BAR 21 OF companhia PROMPT "\-"
DEFINE BAR 22 OF companhia PROMPT "Recap especial da confiança"
DEFINE BAR 23 OF companhia PROMPT "\-"
DEFINE BAR 24 OF companhia PROMPT "Relatório mestre da concessão" ;
	SKIP FOR !lCanadaMaster
DEFINE BAR 25 OF companhia PROMPT "\-"
DEFINE BAR 26 OF companhia PROMPT "Fim da afixação do mês"
ON SELECTION BAR 1 OF companhia ;
	DO _6fo0io572 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 2 OF companhia ;
	DO _6fo0io573 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 3 OF companhia ;
	DO _6fo0io574 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 5 OF companhia ;
	DO _6fo0io575 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 6 OF companhia ;
	DO _6fo0io576 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON BAR 8 OF companhia ACTIVATE POPUP feescollec
ON BAR 9 OF companhia ACTIVATE POPUP negativedu
ON SELECTION BAR 11 OF companhia ;
	DO _6fo0io577 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 12 OF companhia ;
	DO _6fo0io578 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 13 OF companhia ;
	DO _6fo0io579 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 15 OF companhia ;
	DO _6fo0io57a ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 17 OF companhia ;
	DO _6fo0io57b ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 18 OF companhia ;
	DO _6fo0io57c ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 19 OF companhia ;
	DO _6fo0io57d ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 20 OF companhia ;
	DO _6fo0io57e ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON BAR 22 OF companhia ACTIVATE POPUP specialtru
ON SELECTION BAR 24 OF companhia ;
	DO _6fo0io57f ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 26 OF companhia ;
	DO _6fo0io57g ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")

DEFINE POPUP feescollec MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF feescollec PROMPT "As taxas da cópia coletaram o relatório possível do pagamento"
DEFINE BAR 2 OF feescollec PROMPT "As taxas da cópia coletaram a verificação"
DEFINE BAR 3 OF feescollec PROMPT "As taxas da cópia coletaram o registo de verificação"
DEFINE BAR 4 OF feescollec PROMPT "Relatório coletado taxas da cópia"
DEFINE BAR 5 OF feescollec PROMPT "Taxas gravadas coletadas"
ON SELECTION BAR 1 OF feescollec ;
	DO _6fo0io57h ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 2 OF feescollec ;
	DO _6fo0io57i ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 3 OF feescollec ;
	DO _6fo0io57j ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 4 OF feescollec ;
	DO _6fo0io57k ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 5 OF feescollec ;
	DO _6fo0io57l ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")

DEFINE POPUP negativedu MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF negativedu PROMPT "Relatório possível do pagamento do ND da cópia"
DEFINE BAR 2 OF negativedu PROMPT "Verificação coletada ND da cópia"
DEFINE BAR 3 OF negativedu PROMPT "Registo de verificação do ND da cópia"
DEFINE BAR 4 OF negativedu PROMPT "Relatório coletado ND da cópia"
DEFINE BAR 5 OF negativedu PROMPT "Relatório pago do ND da cópia"
ON SELECTION BAR 1 OF negativedu ;
	DO _6fo0io57m ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 2 OF negativedu ;
	DO _6fo0io57n ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 3 OF negativedu ;
	DO _6fo0io57o ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 4 OF negativedu ;
	DO _6fo0io57p ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 5 OF negativedu ;
	DO _6fo0io57q ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")

DEFINE POPUP specialtru MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF specialtru PROMPT "Recap especial da confiança"
DEFINE BAR 2 OF specialtru PROMPT "Recap avançado de Fran da confiança especial"
DEFINE BAR 3 OF specialtru PROMPT "Depósitos Unrecorded da confiança especial do registro da AR"
DEFINE BAR 4 OF specialtru PROMPT "Dados avançados de transferência"
DEFINE BAR 5 OF specialtru PROMPT "Edite a lima avançada"
ON SELECTION BAR 1 OF specialtru ;
	DO _6fo0io57r ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 2 OF specialtru ;
	DO _6fo0io57s ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 3 OF specialtru ;
	DO _6fo0io57t ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 4 OF specialtru ;
	DO _6fo0io57u ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 5 OF specialtru ;
	DO _6fo0io57v ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")

DEFINE POPUP clientesre MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF clientesre PROMPT "Manutenção dos recibos de dinheiro"
DEFINE BAR 2 OF clientesre PROMPT "Outro deposita a manutenção"
DEFINE BAR 3 OF clientesre PROMPT "\-"
DEFINE BAR 4 OF clientesre PROMPT "Relatórios da AR"
DEFINE BAR 5 OF clientesre PROMPT "\-"
DEFINE BAR 6 OF clientesre PROMPT "Registro mensal em Dia"
DEFINE BAR 7 OF clientesre PROMPT "Por cento pagos em Dia"
DEFINE BAR 8 OF clientesre PROMPT "\-"
DEFINE BAR 9 OF clientesre PROMPT "Importação/borne do LockBox" ;
	SKIP FOR !LockBoxAvail
DEFINE BAR 10 OF clientesre PROMPT "Relatório da afixação do LockBox" ;
	SKIP FOR !LockBoxAvail
ON SELECTION BAR 1 OF clientesre ;
	DO _6fo0io57w ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 2 OF clientesre ;
	DO _6fo0io57x ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON BAR 4 OF clientesre ACTIVATE POPUP relatórios
ON SELECTION BAR 6 OF clientesre ;
	DO _6fo0io57y ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 7 OF clientesre ;
	DO _6fo0io57z ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 9 OF clientesre ;
	DO _6fo0io580 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 10 OF clientesre ;
	DO _6fo0io581 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")

DEFINE POPUP relatórios MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF relatórios PROMPT "Registro da AR"
DEFINE BAR 2 OF relatórios PROMPT "História da AR"
DEFINE BAR 3 OF relatórios PROMPT "Relatório do envelhecimento"
DEFINE BAR 4 OF relatórios PROMPT "Os dinheiros receberam"
DEFINE BAR 5 OF relatórios PROMPT "Abra a AR - Por Fran"
DEFINE BAR 6 OF relatórios PROMPT "Outro depósitos"
DEFINE BAR 7 OF relatórios PROMPT "\-"
DEFINE BAR 8 OF relatórios PROMPT "Abra facturas - revisão do detalhe"
DEFINE BAR 9 OF relatórios PROMPT "Abra as facturas - Frans que não fazem CB"
ON SELECTION BAR 1 OF relatórios ;
	DO _6fo0io582 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 2 OF relatórios ;
	DO _6fo0io583 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 3 OF relatórios ;
	DO _6fo0io584 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 4 OF relatórios ;
	DO _6fo0io585 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 5 OF relatórios ;
	DO _6fo0io586 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 6 OF relatórios ;
	DO _6fo0io587 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 8 OF relatórios ;
	DO _6fo0io588 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 9 OF relatórios ;
	DO _6fo0io589 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")

DEFINE POPUP utilities MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF utilities PROMPT "Utilidades de base de dados" ;
	SKIP FOR DBUtilities="0"
DEFINE BAR 2 OF utilities PROMPT "\-"
DEFINE BAR 3 OF utilities PROMPT "Utilidades de sistema"
DEFINE BAR 4 OF utilities PROMPT "\-"
DEFINE BAR 5 OF utilities PROMPT "Utilidades do imposto" ;
	SKIP FOR TaxUtil="0"
DEFINE BAR 6 OF utilities PROMPT "\-"
DEFINE BAR 7 OF utilities PROMPT "Relatórios da gerência" ;
	SKIP FOR MgmtRpts<>"1"
DEFINE BAR 8 OF utilities PROMPT "\-"
DEFINE BAR 9 OF utilities PROMPT "Edite o trajeto do banco" ;
	SKIP FOR BankPath="0"
DEFINE BAR 10 OF utilities PROMPT "Verificação da cópia STA" ;
	SKIP FOR STACheck="0"
DEFINE BAR 11 OF utilities PROMPT "Transferência especial do cliente de confiança"
DEFINE BAR 12 OF utilities PROMPT "Entrada do grupo" ;
	SKIP FOR !(BatchEntry="1" and file('Batch_AP.dbf'))
ON BAR 1 OF utilities ACTIVATE POPUP databaseut
ON BAR 3 OF utilities ACTIVATE POPUP systemutil
ON BAR 5 OF utilities ACTIVATE POPUP taxutiliti
ON BAR 7 OF utilities ACTIVATE POPUP management
ON SELECTION BAR 9 OF utilities ;
	DO _6fo0io58a ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 10 OF utilities ;
	DO _6fo0io58b ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 11 OF utilities ;
	DO _6fo0io58c ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON BAR 12 OF utilities ACTIVATE POPUP batchentry

DEFINE POPUP databaseut MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF databaseut PROMPT "Reindex bases de dados"
DEFINE BAR 2 OF databaseut PROMPT "Clientes lig cruz do reparo"
DEFINE BAR 3 OF databaseut PROMPT "Limas do memorando do reparo"
ON SELECTION BAR 1 OF databaseut ;
	DO _6fo0io58d ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 2 OF databaseut ;
	DO _6fo0io58e ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 3 OF databaseut ;
	DO _6fo0io58f ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")

DEFINE POPUP systemutil MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF systemutil PROMPT "Dados do arquivo" ;
	SKIP FOR ArchiveData="0"
DEFINE BAR 2 OF systemutil PROMPT "Calculadora do pagamento"
DEFINE BAR 3 OF systemutil PROMPT "A recordação arquivou a factura" ;
	SKIP FOR RecallArchInv="0"
DEFINE BAR 4 OF systemutil PROMPT "Factura suprimida recordação" ;
	SKIP FOR RecallDeleInv="0"
DEFINE BAR 5 OF systemutil PROMPT "Verificações reversas do Charge-Back" ;
	SKIP FOR ReverseCB="0"
DEFINE BAR 6 OF systemutil PROMPT "Factura rachada" ;
	SKIP FOR SplitInv="0"
DEFINE BAR 7 OF systemutil PROMPT "Cliente de Untransfer" ;
	SKIP FOR UntranCust="0"
DEFINE BAR 8 OF systemutil PROMPT "\-"
DEFINE BAR 9 OF systemutil PROMPT "Dados da exportação à televenda" ;
	SKIP FOR ! file("custleads\custleads.dbf") or ExportToTele="0"
DEFINE BAR 10 OF systemutil PROMPT "Ligações da televenda da importação" ;
	SKIP FOR ! file("custleads\custleads.dbf") or ImportTeleData="0"
DEFINE BAR 11 OF systemutil PROMPT "\-"
DEFINE BAR 12 OF systemutil PROMPT "Dados da letra dos CB da exportação"
DEFINE BAR 13 OF systemutil PROMPT "Dados da factura da exportação" ;
	SKIP FOR ExportInvData="0"
DEFINE BAR 14 OF systemutil PROMPT "\-"
DEFINE BAR 15 OF systemutil PROMPT "Manutenção da CPI" ;
	SKIP FOR CPIMaint="0"
ON SELECTION BAR 1 OF systemutil ;
	DO _6fo0io58g ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 2 OF systemutil ;
	DO _6fo0io58h ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 3 OF systemutil ;
	DO _6fo0io58i ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 4 OF systemutil ;
	DO _6fo0io58j ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 5 OF systemutil ;
	DO _6fo0io58k ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 6 OF systemutil ;
	DO _6fo0io58l ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 7 OF systemutil ;
	DO _6fo0io58m ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 9 OF systemutil ;
	DO _6fo0io58n ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 10 OF systemutil ;
	DO _6fo0io58o ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 12 OF systemutil ;
	DO _6fo0io58p ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 13 OF systemutil ;
	DO _6fo0io58q ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 15 OF systemutil ;
	DO _6fo0io58r ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")

DEFINE POPUP taxutiliti MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF taxutiliti PROMPT "Tabela de imposto da cópia"
DEFINE BAR 2 OF taxutiliti PROMPT "Tabela de imposto da actualização" ;
	SKIP FOR ! "E" $ TaxUtil or ! "A" $ TaxUtil
ON SELECTION BAR 1 OF taxutiliti ;
	DO _6fo0io58s ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 2 OF taxutiliti ;
	DO _6fo0io58t ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")

DEFINE POPUP management MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF management PROMPT "Relatório da análise de negócio" ;
	SKIP FOR 1=1
DEFINE BAR 2 OF management PROMPT "Renda/análise da despesa e de desempenho" ;
	SKIP FOR 1=1
DEFINE BAR 3 OF management PROMPT "Cesse de fazer o relatório de negócio"
DEFINE BAR 4 OF management PROMPT "Fran - concessionário ativos"
ON SELECTION BAR 1 OF management do form businessanalysis
ON SELECTION BAR 2 OF management do form incomeexpense
ON SELECTION BAR 3 OF management do form ceasetodobusiness
ON SELECTION BAR 4 OF management do form activefranchisee

DEFINE POPUP batchentry MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF batchentry PROMPT "Entrada do grupo"
DEFINE BAR 2 OF batchentry PROMPT "Relatório do grupo"
DEFINE BAR 3 OF batchentry PROMPT "Borne do grupo"
DEFINE BAR 4 OF batchentry PROMPT "\-"
DEFINE BAR 5 OF batchentry PROMPT "Spreadsheet do sumário do vendedor da importação"
ON SELECTION BAR 1 OF batchentry ;
	DO _6fo0io58u ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 2 OF batchentry ;
	DO _6fo0io58v ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 3 OF batchentry ;
	DO _6fo0io58w ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")
ON SELECTION BAR 5 OF batchentry ;
	DO _6fo0io58x ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU_BR" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU_BR?")


*       *********************************************************
*       *                                                         
*       *                 Cleanup Code & Procedures               
*       *                                                         
*       *********************************************************
*

READ EVENTS

*       *********************************************************
*       *                                                         
*       * _6FO0IO55H  ON SELECTION BAR 1 OF POPUP lima            
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:    5        
*       * Called By:  ON SELECTION BAR 1 OF POPUP lima            
*       * Prompt:     Selecione o escritório                      
*       * Snippet:    1                                           
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io55h
clos all && KMC 06/25/2004
do form RegionSelect  && KMC 12/02/2005

*!*	cDataLoc=GetDIR(cDataLoc,"Select Data Location")
*!*	lDataPathOk=.F.
*!*	IF LEN(TRIM(cDataLoc))>0
*!*		SET PATH TO &cDataLoc
*!*		if !file ("jkcusfil.dbf")
*!*			cCompNo=""
*!*			cOfficeName=""
*!*			messagebox("Location Invalid, Select another location.",32," 	Invalid Data Location")
*!*			_screen.caption="Franchisee Accounting - No Region Selected"
*!*			lDataPathOK=.F.
*!*		else
*!*			*--> KMC 04/28/2003 Store the last used data path (used as the default path when app is first run).
*!*			create table LastDataPath ;
*!*				(curPath C(100))
*!*			use LastDataPath
*!*			curPath=cDataLoc
*!*			insert into LastDataPath from memvar	
*!*			sele LastDataPath
*!*			use
*!*			*-->
*!*		
*!*			use jkcmpfil in 0
*!*			sele jkcmpfil
*!*			locate for control_no=1
*!*			if found()
*!*				cCompNo=Company_no
*!*				cOfficeName=alltrim(dsp_name)
*!*				if file(cDataLoc+"CanadaMaster") && Canada Master but NOT Toronto
*!*					lCanadaMaster=.T.
*!*				else
*!*					lCanadaMaster=.F.
*!*				endif		
*!*				_screen.caption=cCompNo+" "+cOfficeName+" - "+vfpprinter
*!*				lDataPathOk=.T.
*!*				do ProcessAppUpdates  && KMC 01/13/2005
*!*			else
*!*				cCompNo=""
*!*				cOfficeName=""
*!*				messagebox("Cannot locate valid Company record.",48,"  Invalid Company Record")
*!*				lDataPathOK=.F.
*!*			endif	
*!*	    	use
*!*		endif	
*!*	else
*!*		cCompNo=""
*!*		cOfficeName=""
*!*		messagebox ("No data path selected.",32,"  Invalid Data Path")
*!*		_screen.caption="Franchisee Accounting - No Region Selected"
*!*		lDataPathOK=.F.
*!*	ENDIF

*!*	clos all && KMC 06/25/2004



*       *********************************************************
*       *                                                         
*       * _6FO0IO55I  ON SELECTION BAR 2 OF POPUP lima            
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:    6        
*       * Called By:  ON SELECTION BAR 2 OF POPUP lima            
*       * Prompt:     Selecione a impressora                      
*       * Snippet:    2                                           
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io55i
SYS(1037)
vfpprinter = SET("printer",3) && Sets VFP default printer to the user selected printer.
_screen.caption=cCompNo+" "+cOfficeName+" - "+vfpprinter


*       *********************************************************
*       *                                                         
*       * _6FO0IO55J  ON SELECTION BAR 3 OF POPUP lima            
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:    7        
*       * Called By:  ON SELECTION BAR 3 OF POPUP lima            
*       * Prompt:     Saída                                       
*       * Snippet:    3                                           
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io55j
*CLEA EVENTS
*CLOS ALL
*CLEA ALL

*--> KMC 04/28/2003 Store the last used data path (used as the default path when app is first run).
create table LastDataPath ;
	(curPath C(100))
use LastDataPath
curPath=cDataLoc
insert into LastDataPath from memvar	
sele LastDataPath
use
*-->

QUIT




*       *********************************************************
*       *                                                         
*       * _6FO0IO55K  ON SELECTION BAR 1 OF POPUP customers       
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   15        
*       * Called By:  ON SELECTION BAR 1 OF POPUP customers       
*       * Prompt:     Manutenção de lima do cliente               
*       * Snippet:    4                                           
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io55k
*do form customerscreen
PUBLIC oForm1
*if !file('NewCustFormTest')
	DO FORM customerfileinfo name oForm1
*else
*	DO FORM customerfileinfo_inwork_suspension_option name oForm1
*endif	


*       *********************************************************
*       *                                                         
*       * _6FO0IO55L  ON SELECTION BAR 2 OF POPUP customers       
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   16        
*       * Called By:  ON SELECTION BAR 2 OF POPUP customers       
*       * Prompt:     Manutenção de transação do cliente          
*       * Snippet:    5                                           
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io55l
CLOSE TABLE ALL
*USE jkctlfil INDEX jkctlfil IN 0 ALIAS ctl
USE jkctlfil ORDER key IN 0 ALIAS ctl
SELE ctl
IF !SEEK(PADL(RIGHT(cCompNo,1),3))
	MESSAGEBOX("Cannot find Bill Month/Year in jkctlfil.  Notify MIS Dept.",48,"Alert")
	CLOSE TABLE ALL	
	RETURN
ENDIF

tdate = CTOD(ALLTRIM(STR(ctl.fn_LsMon)) +'/01/'+ALLTRIM(STR(ctl.fn_LsYear)))
tmonth = CMONTH(tdate)

*USE jkinvfil INDEX jkinvfil IN 0 ALIAS invrec
USE jkinvfil ORDER key IN 0 ALIAS invrec
SELE invrec
SET FILTER TO bill_mon = ctl.fn_LsMon AND bill_year = ctl.fn_LsYear
GO TOP
IF EOF()
MESSAGEBOX("The Bill Run has not been created for "+tmonth+' '+ALLTRIM(STR(ctl.fn_LsYear))+'.'+ CHR(13) ;
		+"You must create the Bill Run before you can create additional transactions for this period.",48,"Alert")
	CLOSE TABLE ALL	
	RETURN
ENDIF
PUBLIC oForm1

if "$" $ cDataLoc
	DO FORM custtraninfo_toronto NAME oForm1 WITH "FromMenu"
else
	DO FORM custtraninfo NAME oForm1 WITH "FromMenu"
endif


*       *********************************************************
*       *                                                         
*       * _6FO0IO55M  ON SELECTION BAR 4 OF POPUP customers       
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   18        
*       * Called By:  ON SELECTION BAR 4 OF POPUP customers       
*       * Prompt:     Crie transações mensais do cliente          
*       * Snippet:    6                                           
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io55m
DO FORM monthlycusttran


*       *********************************************************
*       *                                                         
*       * _6FO0IO55N  ON SELECTION BAR 5 OF POPUP customers       
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   19        
*       * Called By:  ON SELECTION BAR 5 OF POPUP customers       
*       * Prompt:     Transações mensais do cliente da supressão  
*       * Snippet:    7                                           
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io55n
DO FORM deletemonthlycusttran


*       *********************************************************
*       *                                                         
*       * _6FO0IO55O  ON SELECTION BAR 7 OF POPUP customers       
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   21        
*       * Called By:  ON SELECTION BAR 7 OF POPUP customers       
*       * Prompt:     Faturamento consolidado                     
*       * Snippet:    8                                           
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io55o
Do Form ConsolBill


*       *********************************************************
*       *                                                         
*       * _6FO0IO55P  ON SELECTION BAR 8 OF POPUP customers       
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   22        
*       * Called By:  ON SELECTION BAR 8 OF POPUP customers       
*       * Prompt:     Adicione a factura a Bill consolidado existente 
*       * Snippet:    9                                           
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io55p
do form consolbill_addinvoice


*       *********************************************************
*       *                                                         
*       * _6FO0IO55Q  ON SELECTION BAR 10 OF POPUP customers      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   24        
*       * Called By:  ON SELECTION BAR 10 OF POPUP customers      
*       * Prompt:     Facturas                                    
*       * Snippet:    10                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io55q
DO FORM selectinvtype



*       *********************************************************
*       *                                                         
*       * _6FO0IO55R  ON SELECTION BAR 13 OF POPUP customers      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   31        
*       * Called By:  ON SELECTION BAR 13 OF POPUP customers      
*       * Prompt:     Crie a lima de fusão do correio             
*       * Snippet:    11                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io55r
Do Form CustMailMerge


*       *********************************************************
*       *                                                         
*       * _6FO0IO55S  ON SELECTION BAR 14 OF POPUP customers      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   32        
*       * Called By:  ON SELECTION BAR 14 OF POPUP customers      
*       * Prompt:     Fax-UM-Comente - sob a construção           
*       * Snippet:    12                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io55s
ON ERROR DO NoWinfax

WAIT WIND "Please Wait!  Checking Winfax Software..." NOWAIT
PUBLIC goterr

goterr = .F.

oFax = CREATEOBJECT("WinFax.SDKSend")

IF goterr = .F.
	DO FORM faxacomment
ENDIF

PROC NoWinfax
	goterr = .T.
	WAIT CLEAR
	ON ERROR
	MESSAGEBOX("Fax-A-Comment requires Winfax Pro."+CHR(13)+;
	"Install Winfax Pro Software and try again.", 48," Fax-A-Comment Alert")
RETURN



*       *********************************************************
*       *                                                         
*       * _6FO0IO55T  ON SELECTION BAR 15 OF POPUP customers      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   33        
*       * Called By:  ON SELECTION BAR 15 OF POPUP customers      
*       * Prompt:     Formulários da inspeção da cópia            
*       * Snippet:    13                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io55t
do form inspform


*       *********************************************************
*       *                                                         
*       * _6FO0IO55U  ON SELECTION BAR 16 OF POPUP customers      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   34        
*       * Called By:  ON SELECTION BAR 16 OF POPUP customers      
*       * Prompt:     Etiquetas da cópia                          
*       * Snippet:    14                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io55u
DO FORM custlabels


*       *********************************************************
*       *                                                         
*       * _6FO0IO55V  ON SELECTION BAR 1 OF POPUP pastdues        
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   27        
*       * Called By:  ON SELECTION BAR 1 OF POPUP pastdues        
*       * Prompt:     Após - observações devidas                  
*       * Snippet:    15                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io55v
DO FORM print_past_due



*       *********************************************************
*       *                                                         
*       * _6FO0IO55W  ON SELECTION BAR 2 OF POPUP pastdues        
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   28        
*       * Called By:  ON SELECTION BAR 2 OF POPUP pastdues        
*       * Prompt:     Após - o relatório devido                   
*       * Snippet:    16                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io55w
DO FORM print_pd_report



*       *********************************************************
*       *                                                         
*       * _6FO0IO55X  ON SELECTION BAR 1 OF POPUP concession      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   37        
*       * Called By:  ON SELECTION BAR 1 OF POPUP concession      
*       * Prompt:     Manutenção de lima do concessionário        
*       * Snippet:    17                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io55x
PUBLIC oForm1
DO FORM franchiseefileinfo name oForm1


*       *********************************************************
*       *                                                         
*       * _6FO0IO55Y  ON SELECTION BAR 2 OF POPUP concession      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   38        
*       * Called By:  ON SELECTION BAR 2 OF POPUP concession      
*       * Prompt:     Manutenção de lima da transação do concessionário 
*       * Snippet:    18                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io55y
PUBLIC oForm1
if "$" $ cDataLoc
	DO FORM frantraninfo_Toronto NAME oForm1
else
	DO FORM frantraninfo NAME oForm1
endif



*       *********************************************************
*       *                                                         
*       * _6FO0IO55Z  ON SELECTION BAR 3 OF POPUP concession      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   39        
*       * Called By:  ON SELECTION BAR 3 OF POPUP concession      
*       * Prompt:     Manutenção de lima do aluguer               
*       * Snippet:    19                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io55z
if "$" $ cDataLoc
	DO FORM leasefileinfo_toronto
else
	DO FORM leasefileinfo
endif	


*       *********************************************************
*       *                                                         
*       * _6FO0IO560  ON SELECTION BAR 4 OF POPUP concession      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   40        
*       * Called By:  ON SELECTION BAR 4 OF POPUP concession      
*       * Prompt:     Transferência do aluguer                    
*       * Snippet:    20                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io560
do form transferlease


*       *********************************************************
*       *                                                         
*       * _6FO0IO561  ON SELECTION BAR 5 OF POPUP concession      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   41        
*       * Called By:  ON SELECTION BAR 5 OF POPUP concession      
*       * Prompt:     Obrigações                                  
*       * Snippet:    21                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io561
Do Form Obligations



*       *********************************************************
*       *                                                         
*       * _6FO0IO562  ON SELECTION BAR 15 OF POPUP concession     
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   96        
*       * Called By:  ON SELECTION BAR 15 OF POPUP concession     
*       * Prompt:     Crie a lima de fusão do correio             
*       * Snippet:    22                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io562
do form FranMailMerge


*       *********************************************************
*       *                                                         
*       * _6FO0IO563  ON SELECTION BAR 16 OF POPUP concession     
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   97        
*       * Called By:  ON SELECTION BAR 16 OF POPUP concession     
*       * Prompt:     Etiquetas da cópia                          
*       * Snippet:    23                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io563
DO FORM franlabels


*       *********************************************************
*       *                                                         
*       * _6FO0IO564  ON SELECTION BAR 1 OF POPUP menudochar      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   45        
*       * Called By:  ON SELECTION BAR 1 OF POPUP menudochar      
*       * Prompt:     Semanal - relatório de Poss CB/TAR          
*       * Snippet:    24                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io564
do form CbPay with "WeeklyReport"



*       *********************************************************
*       *                                                         
*       * _6FO0IO565  ON SELECTION BAR 2 OF POPUP menudochar      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   46        
*       * Called By:  ON SELECTION BAR 2 OF POPUP menudochar      
*       * Prompt:     Semanal - verificações de CB/TAR            
*       * Snippet:    25                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io565
use data_loc in 0
sele data_loc
if cCompNo="NAT999" or cCompNo="NAT991"
	loca for company_no="NAT000"
else
	loca for company_no=cCompNo
endif
*--> Don't call form if we cannot locate bank information.
if found()
	use
	Do form CbPAy with "WeeklyChecks"
else
	use
	messagebox("Cannot locate Bank Info.",48,"  No Bank Info Record")
endif




*       *********************************************************
*       *                                                         
*       * _6FO0IO566  ON SELECTION BAR 3 OF POPUP menudochar      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   47        
*       * Called By:  ON SELECTION BAR 3 OF POPUP menudochar      
*       * Prompt:     Mensal - relatório de Poss CB/TAR           
*       * Snippet:    26                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io566
x=messagebox("Do not continue until all report corrections have been made"+chr(13)+ ;
"and final Franchise reports and checks have been printed." + CHR(13)+CHR(13)+ ;
"NO corrections can be entered that affect a Franchisee's"+chr(13)+ ;
"report AFTER this report has been run." +CHR(13)+CHR(13)+ ;
"Do you wish to procede? (Press 'No' if you're not sure).",276,+REPLICATE(" ",30)+"System Alert - WARNING")
if x=6	
	Do form CbPay with "MonthlyReport"
else
	return
endif	
	


*       *********************************************************
*       *                                                         
*       * _6FO0IO567  ON SELECTION BAR 4 OF POPUP menudochar      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   48        
*       * Called By:  ON SELECTION BAR 4 OF POPUP menudochar      
*       * Prompt:     Mensal - verificações de CB/TAR             
*       * Snippet:    27                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io567
use data_loc in 0
sele data_loc
if cCompNo="NAT999" or cCompNo="NAT991"
	loca for company_no="NAT000"
else
	loca for company_no=cCompNo
endif
*--> Don't call form if we cannot locate bank information.
if found()
	use
	Do form CbPay with "MonthlyChecks"
else
	use
	messagebox("Cannot locate Bank Info.",48,"  No Bank Info Record")
endif




*       *********************************************************
*       *                                                         
*       * _6FO0IO568  ON SELECTION BAR 5 OF POPUP menudochar      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   49        
*       * Called By:  ON SELECTION BAR 5 OF POPUP menudochar      
*       * Prompt:     Registo de verificação de CB/TAR            
*       * Snippet:    28                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io568
DO Form CBTarRegister


*       *********************************************************
*       *                                                         
*       * _6FO0IO569  ON SELECTION BAR 7 OF POPUP menudochar      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   51        
*       * Called By:  ON SELECTION BAR 7 OF POPUP menudochar      
*       * Prompt:     Relatório possível dos CB                   
*       * Snippet:    29                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io569
sele count(dlr_code) as FranCnt from jkdlrfil where CB<>"Y" and status="Y" into cursor tmpOut
sele tmpOut
if FranCnt>0
	x=messagebox("There are "+alltrim(str(FranCnt))+" Franchisee's that are flagged to NOT Charge Back."+chr(13)+ ;
			   "Would you like to see a list of these Franchisee's?",68," System Alert")	
	if x = 6
		sele dlr_code, dlr_name, date_sign from jkdlrfil where CB<>"Y" and status="Y" order by dlr_code into cursor tmpOut
		RegionName=cOfficeName
		rptTitle = "Franchisee's Flagged to NOT Charge Back"
		repo form NoCBList preview
	endif
endif
sele tmpOut
use
sele jkdlrfil
use
DO form CBProcess with "PossCBRpt"



*       *********************************************************
*       *                                                         
*       * _6FO0IO56A  ON SELECTION BAR 8 OF POPUP menudochar      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   52        
*       * Called By:  ON SELECTION BAR 8 OF POPUP menudochar      
*       * Prompt:     Execute o procedimento dos CB               
*       * Snippet:    30                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io56a
Do form CBProcess with "PerformCB"


*       *********************************************************
*       *                                                         
*       * _6FO0IO56B  ON SELECTION BAR 9 OF POPUP menudochar      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   53        
*       * Called By:  ON SELECTION BAR 9 OF POPUP menudochar      
*       * Prompt:     Relatório final dos CB                      
*       * Snippet:    31                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io56b
Do form FinalCBRpt


*       *********************************************************
*       *                                                         
*       * _6FO0IO56C  ON SELECTION BAR 11 OF POPUP menudochar     
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   55        
*       * Called By:  ON SELECTION BAR 11 OF POPUP menudochar     
*       * Prompt:     Relatório da história dos CB                
*       * Snippet:    32                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io56c
do form cbhistory


*       *********************************************************
*       *                                                         
*       * _6FO0IO56D  ON SELECTION BAR 12 OF POPUP menudochar     
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   56        
*       * Called By:  ON SELECTION BAR 12 OF POPUP menudochar     
*       * Prompt:     Relatório da história do ND                 
*       * Snippet:    33                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io56d
do form ndhistory


*       *********************************************************
*       *                                                         
*       * _6FO0IO56E  ON SELECTION BAR 13 OF POPUP menudochar     
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   57        
*       * Called By:  ON SELECTION BAR 13 OF POPUP menudochar     
*       * Prompt:     Letras dos CB da cópia                      
*       * Snippet:    34                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io56e
Do form CbLetter


*       *********************************************************
*       *                                                         
*       * _6FO0IO56F  ON SELECTION BAR 1 OF POPUP _0s60ii7f5      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   61        
*       * Called By:  ON SELECTION BAR 1 OF POPUP _0s60ii7f5      
*       * Prompt:     Crie/relatório concessionário da cópia      
*       * Snippet:    35                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io56f
DO FORM PrintFranReport WITH 'N'


*       *********************************************************
*       *                                                         
*       * _6FO0IO56G  ON SELECTION BAR 2 OF POPUP _0s60ii7f5      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   62        
*       * Called By:  ON SELECTION BAR 2 OF POPUP _0s60ii7f5      
*       * Prompt:     Relatório do concessionário da reprodução   
*       * Snippet:    36                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io56g
DO FORM PrintFranReport WITH 'R'


*       *********************************************************
*       *                                                         
*       * _6FO0IO56H  ON SELECTION BAR 3 OF POPUP _0s60ii7f5      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   63        
*       * Called By:  ON SELECTION BAR 3 OF POPUP _0s60ii7f5      
*       * Prompt:     Spreadsheet do concessionário da cópia      
*       * Snippet:    37                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io56h
*IF file('jkcusfil.dbf')
	DO FORM print_spreadsheet
*ELSE
*  messagebox(" Select a valid path to data.")
*ENDIF



*       *********************************************************
*       *                                                         
*       * _6FO0IO56I  ON SELECTION BAR 5 OF POPUP _0s60ii7f5      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   66        
*       * Called By:  ON SELECTION BAR 5 OF POPUP _0s60ii7f5      
*       * Prompt:     Verificações devidas de Fran da cópia       
*       * Snippet:    38                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io56i
use data_loc in 0
sele data_loc
if cCompNo="NAT999" or cCompNo="NAT991"
	loca for company_no="NAT000"
else
	loca for company_no=cCompNo
endif
*--> Don't call form if we cannot locate bank information.
if found()
	use
	DO FORM "PrintDueFranChecks"
else
	use
	messagebox("Cannot locate Bank Info.",48,"  No Bank Info Record")
endif


*       *********************************************************
*       *                                                         
*       * _6FO0IO56J  ON SELECTION BAR 6 OF POPUP _0s60ii7f5      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   67        
*       * Called By:  ON SELECTION BAR 6 OF POPUP _0s60ii7f5      
*       * Prompt:     Registo de verificação devido de Fran da cópia 
*       * Snippet:    39                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io56j
DO FORM "print franchisee check register"


*       *********************************************************
*       *                                                         
*       * _6FO0IO56K  ON SELECTION BAR 8 OF POPUP _0s60ii7f5      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   70        
*       * Called By:  ON SELECTION BAR 8 OF POPUP _0s60ii7f5      
*       * Prompt:     Relatório incorporado das dívidas da cópia  
*       * Snippet:    40                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io56k
do form CorporateDuesreport


*       *********************************************************
*       *                                                         
*       * _6FO0IO56L  ON SELECTION BAR 9 OF POPUP _0s60ii7f5      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   71        
*       * Called By:  ON SELECTION BAR 9 OF POPUP _0s60ii7f5      
*       * Prompt:     & dos comp(s) dos trabalhadores da cópia; Relatório da responsabilidade 
*       * Snippet:    41                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io56l
do form liaworkcompreport


*       *********************************************************
*       *                                                         
*       * _6FO0IO56M  ON SELECTION BAR 11 OF POPUP _0s60ii7f5     
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   74        
*       * Called By:  ON SELECTION BAR 11 OF POPUP _0s60ii7f5     
*       * Prompt:     Manutenção do desconto da taxa da contabilidade 
*       * Snippet:    42                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io56m
do form AcctFeeRebate


*       *********************************************************
*       *                                                         
*       * _6FO0IO56N  ON SELECTION BAR 12 OF POPUP _0s60ii7f5     
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   75        
*       * Called By:  ON SELECTION BAR 12 OF POPUP _0s60ii7f5     
*       * Prompt:     Relatório do desconto da taxa da contabilidade da cópia 
*       * Snippet:    43                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io56n
DO FORM accountrebatereport


*       *********************************************************
*       *                                                         
*       * _6FO0IO56O  ON SELECTION BAR 13 OF POPUP _0s60ii7f5     
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   76        
*       * Called By:  ON SELECTION BAR 13 OF POPUP _0s60ii7f5     
*       * Prompt:     Verificação do desconto da taxa da contabilidade da cópia 
*       * Snippet:    44                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io56o
*--> 01/15/2004 KMC
*Do form AcctFeeRebateCheck
use data_loc in 0
sele data_loc
loca for company_no="AcctFee"
*--> Don't call form if we cannot locate bank information.
if found()
	use
	Do form AcctFeeRebateCheck
else
	*--> Only Corporate uses a seperate account for Acct Fee Rebate Checks,
	*--> Masters would use the active regions Special Trust Acct.
	*--> If the "AcctFee" record is not found, drop back to the record
	*--> for the active region.
	loca for company_no=cCompNo
	if found()
		use
		Do form AcctFeeRebateCheck
	else
		use
		messagebox("Cannot locate Bank Info.",48,"  No Bank Info Record")
	endif
endif
*-->






*       *********************************************************
*       *                                                         
*       * _6FO0IO56P  ON SELECTION BAR 1 OF POPUP miscreport      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   80        
*       * Called By:  ON SELECTION BAR 1 OF POPUP miscreport      
*       * Prompt:     Abas do concessionário                      
*       * Snippet:    45                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io56p
Do form PrintTabs


*       *********************************************************
*       *                                                         
*       * _6FO0IO56Q  ON SELECTION BAR 2 OF POPUP miscreport      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   81        
*       * Called By:  ON SELECTION BAR 2 OF POPUP miscreport      
*       * Prompt:     O concessionário alcangou primeiramente uma quantidade de factura especific 
*       * Snippet:    46                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io56q
do form FranFirstAtSomeBillLevel


*       *********************************************************
*       *                                                         
*       * _6FO0IO56R  ON SELECTION BAR 3 OF POPUP miscreport      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   82        
*       * Called By:  ON SELECTION BAR 3 OF POPUP miscreport      
*       * Prompt:     Sumário anual do concessionário             
*       * Snippet:    47                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io56r
DO Form FranYTDReport


*       *********************************************************
*       *                                                         
*       * _6FO0IO56S  ON SELECTION BAR 4 OF POPUP miscreport      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   83        
*       * Called By:  ON SELECTION BAR 4 OF POPUP miscreport      
*       * Prompt:     Relatório da dívida do negativo             
*       * Snippet:    48                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io56s
do form negativedue


*       *********************************************************
*       *                                                         
*       * _6FO0IO56T  ON SELECTION BAR 5 OF POPUP miscreport      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   84        
*       * Called By:  ON SELECTION BAR 5 OF POPUP miscreport      
*       * Prompt:     Relatório coletado não 3%                   
*       * Snippet:    49                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io56t
do form non3collected


*       *********************************************************
*       *                                                         
*       * _6FO0IO56U  ON SELECTION BAR 6 OF POPUP miscreport      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   85        
*       * Called By:  ON SELECTION BAR 6 OF POPUP miscreport      
*       * Prompt:     Relatório do Recap do Pager                 
*       * Snippet:    50                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io56u
Do form PagerRecap


*       *********************************************************
*       *                                                         
*       * _6FO0IO56V  ON SELECTION BAR 7 OF POPUP miscreport      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   86        
*       * Called By:  ON SELECTION BAR 7 OF POPUP miscreport      
*       * Prompt:     Relatório do Recap da fonte                 
*       * Snippet:    51                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io56v
do form supplyrecap


*       *********************************************************
*       *                                                         
*       * _6FO0IO56W  ON SELECTION BAR 1 OF POPUP clientesna      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   90        
*       * Called By:  ON SELECTION BAR 1 OF POPUP clientesna      
*       * Prompt:     Pagamento maioria da factura                
*       * Snippet:    52                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io56w
Do form BulkInvPay


*       *********************************************************
*       *                                                         
*       * _6FO0IO56X  ON SELECTION BAR 2 OF POPUP clientesna      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   91        
*       * Called By:  ON SELECTION BAR 2 OF POPUP clientesna      
*       * Prompt:     Relatório possível do pagamento             
*       * Snippet:    53                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io56x
Do form NatAcctCks with "Report"


*       *********************************************************
*       *                                                         
*       * _6FO0IO56Y  ON SELECTION BAR 3 OF POPUP clientesna      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   92        
*       * Called By:  ON SELECTION BAR 3 OF POPUP clientesna      
*       * Prompt:     Verificações da cópia                       
*       * Snippet:    54                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io56y
use data_loc in 0
sele data_loc
if cCompNo="NAT999" or cCompNo="NAT991"
	loca for company_no="NAT000"
else
	loca for company_no=cCompNo
endif
*--> Don't call form if we cannot locate bank information.
if found()
	use
	Do form NatAcctCks with "Checks"
else
	use
	messagebox("Cannot locate Bank Info.",48,"  No Bank Info Record")
endif




*       *********************************************************
*       *                                                         
*       * _6FO0IO56Z  ON SELECTION BAR 4 OF POPUP clientesna      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:   93        
*       * Called By:  ON SELECTION BAR 4 OF POPUP clientesna      
*       * Prompt:     Registo de verificação                      
*       * Snippet:    55                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io56z
Do Form NatAcctCkRegister


*       *********************************************************
*       *                                                         
*       * _6FO0IO570  ON SELECTION BAR 1 OF POPUP _1eb0mo9tg      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  102        
*       * Called By:  ON SELECTION BAR 1 OF POPUP _1eb0mo9tg      
*       * Prompt:     Relatório da cópia 1099                     
*       * Snippet:    56                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io570
use data_loc in 0
sele data_loc
if cCompNo="NAT999" or cCompNo="NAT991"
	loca for company_no="NAT000"
else
	loca for company_no=cCompNo
endif

if found()
	use
	do form Fran1099Report
else
	use
	messagebox("Cannot find STA Checkbook Info.",48,"  No CheckBook Info")
endif



*       *********************************************************
*       *                                                         
*       * _6FO0IO571  ON SELECTION BAR 2 OF POPUP _1eb0mo9tg      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  103        
*       * Called By:  ON SELECTION BAR 2 OF POPUP _1eb0mo9tg      
*       * Prompt:     Cópia 1099' s                               
*       * Snippet:    57                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io571
Do form Print1099s


*       *********************************************************
*       *                                                         
*       * _6FO0IO572  ON SELECTION BAR 1 OF POPUP companhia       
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  106        
*       * Called By:  ON SELECTION BAR 1 OF POPUP companhia       
*       * Prompt:     Manutenção de lima da companhia             
*       * Snippet:    58                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io572
*--> KMC 06/26/2009
*if lCanadaMaster
*	DO FORM officefileinfo_CM
*else
*	DO FORM officefileinfo
*endif

Do Case
	Case lCanadaMaster
		DO FORM officefileinfo_CM
	Case lBrazil
		DO FORM officefileinfo_BR
	Otherwise
		DO FORM officefileinfo
EndCase
*-->		
	


*       *********************************************************
*       *                                                         
*       * _6FO0IO573  ON SELECTION BAR 2 OF POPUP companhia       
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  107        
*       * Called By:  ON SELECTION BAR 2 OF POPUP companhia       
*       * Prompt:     Manutenção de lima do controle              
*       * Snippet:    59                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io573
DO FORM controlfileinfo


*       *********************************************************
*       *                                                         
*       * _6FO0IO574  ON SELECTION BAR 3 OF POPUP companhia       
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  108        
*       * Called By:  ON SELECTION BAR 3 OF POPUP companhia       
*       * Prompt:     Restaure os parâmetros de sistema (Side1/Side2) 
*       * Snippet:    60                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io574
do form resetsystemparameters


*       *********************************************************
*       *                                                         
*       * _6FO0IO575  ON SELECTION BAR 5 OF POPUP companhia       
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  111        
*       * Called By:  ON SELECTION BAR 5 OF POPUP companhia       
*       * Prompt:     Manutenção especial do registo de verificação da confiança 
*       * Snippet:    61                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io575
use data_loc
if cCompNo="NAT999" or cCompNo="NAT991"
	loca for company_no="NAT000"
else
	loca for company_no=cCompNo
endif

*--> Don't call form if we cannot locate bank information.
if found()
	BankPath = ALLTRIM(data_loc.bank_data)
	use
	DO FORM francheckfileinfo with BankPath
else
	use
	messagebox("Cannot locate Bank Info.",48,"  No Bank Info Record")
endif



*       *********************************************************
*       *                                                         
*       * _6FO0IO576  ON SELECTION BAR 6 OF POPUP companhia       
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  112        
*       * Called By:  ON SELECTION BAR 6 OF POPUP companhia       
*       * Prompt:     Manutenção da informação do banco           
*       * Snippet:    62                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io576
*do form bankinfo

USE data_loc IN 0
SELE data_loc
IF cCompNo="NAT991" OR cCompNo="NAT999"
	LOCA FOR company_no="NAT000"
ELSE
	LOCA FOR company_no=cCompNo
ENDIF

IF FOUND()
	DO FORM bankinfo
ELSE
	CLOSE TABLE ALL
	MESSAGEBOX("No Bank Data Available!",48," Alert")
	RETURN
ENDIF



*       *********************************************************
*       *                                                         
*       * _6FO0IO577  ON SELECTION BAR 11 OF POPUP companhia      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  131        
*       * Called By:  ON SELECTION BAR 11 OF POPUP companhia      
*       * Prompt:     Verificação da taxa da contabilidade da cópia 
*       * Snippet:    63                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io577
use data_loc in 0
sele data_loc
if cCompNo="NAT999" or cCompNo="NAT991"
	loca for company_no="NAT000"
else
	loca for company_no=cCompNo
endif
*--> Don't call form if we cannot locate bank information.
if found()
	use
	do form adv_afr_bp_ck with "AcctFeeReb"
else
	use
	messagebox("Cannot locate Bank Info.",48,"  No Bank Info Record")
endif






*       *********************************************************
*       *                                                         
*       * _6FO0IO578  ON SELECTION BAR 12 OF POPUP companhia      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  132        
*       * Called By:  ON SELECTION BAR 12 OF POPUP companhia      
*       * Prompt:     Cópia que anuncia a verificação da taxa     
*       * Snippet:    64                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io578
use data_loc in 0
sele data_loc
if cCompNo="NAT999" or cCompNo="NAT991"
	loca for company_no="NAT000"
else
	loca for company_no=cCompNo
endif
*--> Don't call form if we cannot locate bank information.
if found()
	use
	do form adv_afr_bp_ck with "AdvFee"
else
	use
	messagebox("Cannot locate Bank Info.",48,"  No Bank Info Record")
endif




*       *********************************************************
*       *                                                         
*       * _6FO0IO579  ON SELECTION BAR 13 OF POPUP companhia      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  133        
*       * Called By:  ON SELECTION BAR 13 OF POPUP companhia      
*       * Prompt:     & de BP da cópia; Verificação bond          
*       * Snippet:    65                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io579
use data_loc in 0
sele data_loc
if cCompNo="NAT999" or cCompNo="NAT991"
	loca for company_no="NAT000"
else
	loca for company_no=cCompNo
endif
*--> Don't call form if we cannot locate bank information.
if found()
	use
	do form adv_afr_bp_ck with "BPBond"
else
	use
	messagebox("Cannot locate Bank Info.",48,"  No Bank Info Record")
endif






*       *********************************************************
*       *                                                         
*       * _6FO0IO57A  ON SELECTION BAR 15 OF POPUP companhia      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  136        
*       * Called By:  ON SELECTION BAR 15 OF POPUP companhia      
*       * Prompt:     Relatório da responsabilidade de imposto da cópia 
*       * Snippet:    66                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io57a
DO FORM taxliability



*       *********************************************************
*       *                                                         
*       * _6FO0IO57B  ON SELECTION BAR 17 OF POPUP companhia      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  139        
*       * Called By:  ON SELECTION BAR 17 OF POPUP companhia      
*       * Prompt:     Relatório das taxas dos inventores          
*       * Snippet:    67                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io57b
do form ffReport


*       *********************************************************
*       *                                                         
*       * _6FO0IO57C  ON SELECTION BAR 18 OF POPUP companhia      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  140        
*       * Called By:  ON SELECTION BAR 18 OF POPUP companhia      
*       * Prompt:     Relatório Receivable das notas              
*       * Snippet:    68                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io57c
Do form NotesReceivableReport


*       *********************************************************
*       *                                                         
*       * _6FO0IO57D  ON SELECTION BAR 19 OF POPUP companhia      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  141        
*       * Called By:  ON SELECTION BAR 19 OF POPUP companhia      
*       * Prompt:     Relatório das obrigações                    
*       * Snippet:    69                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io57d
Do Form ObligationsReport


*       *********************************************************
*       *                                                         
*       * _6FO0IO57E  ON SELECTION BAR 20 OF POPUP companhia      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  142        
*       * Called By:  ON SELECTION BAR 20 OF POPUP companhia      
*       * Prompt:     Rendimento projetado (& do FF; Aluguer)     
*       * Snippet:    70                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io57e
do form ProjectedRevenue


*       *********************************************************
*       *                                                         
*       * _6FO0IO57F  ON SELECTION BAR 24 OF POPUP companhia      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  154        
*       * Called By:  ON SELECTION BAR 24 OF POPUP companhia      
*       * Prompt:     Relatório mestre da concessão               
*       * Snippet:    71                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io57f
do form MasterFranReport


*       *********************************************************
*       *                                                         
*       * _6FO0IO57G  ON SELECTION BAR 26 OF POPUP companhia      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  157        
*       * Called By:  ON SELECTION BAR 26 OF POPUP companhia      
*       * Prompt:     Fim da afixação do mês                      
*       * Snippet:    72                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io57g
DO FORM endofmonthposting


*       *********************************************************
*       *                                                         
*       * _6FO0IO57H  ON SELECTION BAR 1 OF POPUP feescollec      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  117        
*       * Called By:  ON SELECTION BAR 1 OF POPUP feescollec      
*       * Prompt:     As taxas da cópia coletaram o relatório possível do pagamento 
*       * Snippet:    73                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io57h
Do form FeesCollCheck with "Report"


*       *********************************************************
*       *                                                         
*       * _6FO0IO57I  ON SELECTION BAR 2 OF POPUP feescollec      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  118        
*       * Called By:  ON SELECTION BAR 2 OF POPUP feescollec      
*       * Prompt:     As taxas da cópia coletaram a verificação   
*       * Snippet:    74                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io57i
use data_loc in 0
sele data_loc
if cCompNo="NAT999" or cCompNo="NAT991"
	loca for company_no="NAT000"
else
	loca for company_no=cCompNo
endif
*--> Don't call form if we cannot locate bank information.
if found()
	use
	Do form FeesCollCheck with "Checks"
else
	use
	messagebox("Cannot locate Bank Info.",48,"  No Bank Info Record")
endif




*       *********************************************************
*       *                                                         
*       * _6FO0IO57J  ON SELECTION BAR 3 OF POPUP feescollec      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  119        
*       * Called By:  ON SELECTION BAR 3 OF POPUP feescollec      
*       * Prompt:     As taxas da cópia coletaram o registo de verificação 
*       * Snippet:    75                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io57j
Do form FeesCollCheck with "Register"


*       *********************************************************
*       *                                                         
*       * _6FO0IO57K  ON SELECTION BAR 4 OF POPUP feescollec      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  120        
*       * Called By:  ON SELECTION BAR 4 OF POPUP feescollec      
*       * Prompt:     Relatório coletado taxas da cópia           
*       * Snippet:    76                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io57k
Do form FeesCollected


*       *********************************************************
*       *                                                         
*       * _6FO0IO57L  ON SELECTION BAR 5 OF POPUP feescollec      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  121        
*       * Called By:  ON SELECTION BAR 5 OF POPUP feescollec      
*       * Prompt:     Taxas gravadas coletadas                    
*       * Snippet:    77                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io57l
DO FORM recordfeescollected


*       *********************************************************
*       *                                                         
*       * _6FO0IO57M  ON SELECTION BAR 1 OF POPUP negativedu      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  124        
*       * Called By:  ON SELECTION BAR 1 OF POPUP negativedu      
*       * Prompt:     Relatório possível do pagamento do ND da cópia 
*       * Snippet:    78                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io57m
Do form NegDueChecks with "Report"


*       *********************************************************
*       *                                                         
*       * _6FO0IO57N  ON SELECTION BAR 2 OF POPUP negativedu      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  125        
*       * Called By:  ON SELECTION BAR 2 OF POPUP negativedu      
*       * Prompt:     Verificação coletada ND da cópia            
*       * Snippet:    79                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io57n
use data_loc in 0
sele data_loc
if cCompNo="NAT999" or cCompNo="NAT991"
	loca for company_no="NAT000"
else
	loca for company_no=cCompNo
endif
*--> Don't call form if we cannot locate bank information.
if found()
	use
	Do form NegDueChecks with "Checks"
else
	use
	messagebox("Cannot locate Bank Info.",48,"  No Bank Info Record")
endif



*       *********************************************************
*       *                                                         
*       * _6FO0IO57O  ON SELECTION BAR 3 OF POPUP negativedu      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  126        
*       * Called By:  ON SELECTION BAR 3 OF POPUP negativedu      
*       * Prompt:     Registo de verificação do ND da cópia       
*       * Snippet:    80                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io57o
Do form NegDueChecks with "Register"


*       *********************************************************
*       *                                                         
*       * _6FO0IO57P  ON SELECTION BAR 4 OF POPUP negativedu      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  127        
*       * Called By:  ON SELECTION BAR 4 OF POPUP negativedu      
*       * Prompt:     Relatório coletado ND da cópia              
*       * Snippet:    81                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io57p
Do form NegDueCollected with "NDCollected"


*       *********************************************************
*       *                                                         
*       * _6FO0IO57Q  ON SELECTION BAR 5 OF POPUP negativedu      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  128        
*       * Called By:  ON SELECTION BAR 5 OF POPUP negativedu      
*       * Prompt:     Relatório pago do ND da cópia               
*       * Snippet:    82                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io57q
Do form NegDueCollected with "NDPaid"


*       *********************************************************
*       *                                                         
*       * _6FO0IO57R  ON SELECTION BAR 1 OF POPUP specialtru      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  147        
*       * Called By:  ON SELECTION BAR 1 OF POPUP specialtru      
*       * Prompt:     Recap especial da confiança                 
*       * Snippet:    83                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io57r
DO Form SpecialTrustRecap


*       *********************************************************
*       *                                                         
*       * _6FO0IO57S  ON SELECTION BAR 2 OF POPUP specialtru      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  148        
*       * Called By:  ON SELECTION BAR 2 OF POPUP specialtru      
*       * Prompt:     Recap avançado de Fran da confiança especial 
*       * Snippet:    84                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io57s
Do form SpecialTrustFranAdvRecap


*       *********************************************************
*       *                                                         
*       * _6FO0IO57T  ON SELECTION BAR 3 OF POPUP specialtru      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  149        
*       * Called By:  ON SELECTION BAR 3 OF POPUP specialtru      
*       * Prompt:     Depósitos Unrecorded da confiança especial do registro da AR 
*       * Snippet:    85                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io57t
Do form SpecialTrustUnDeposits


*       *********************************************************
*       *                                                         
*       * _6FO0IO57U  ON SELECTION BAR 4 OF POPUP specialtru      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  150        
*       * Called By:  ON SELECTION BAR 4 OF POPUP specialtru      
*       * Prompt:     Dados avançados de transferência            
*       * Snippet:    86                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io57u
DO FORM transprd


*       *********************************************************
*       *                                                         
*       * _6FO0IO57V  ON SELECTION BAR 5 OF POPUP specialtru      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  151        
*       * Called By:  ON SELECTION BAR 5 OF POPUP specialtru      
*       * Prompt:     Edite a lima avançada                       
*       * Snippet:    87                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io57v
DO FORM advedit


*       *********************************************************
*       *                                                         
*       * _6FO0IO57W  ON SELECTION BAR 1 OF POPUP clientesre      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  160        
*       * Called By:  ON SELECTION BAR 1 OF POPUP clientesre      
*       * Prompt:     Manutenção dos recibos de dinheiro          
*       * Snippet:    88                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io57w
DO FORM CASHRECEIPTSINFO


*       *********************************************************
*       *                                                         
*       * _6FO0IO57X  ON SELECTION BAR 2 OF POPUP clientesre      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  161        
*       * Called By:  ON SELECTION BAR 2 OF POPUP clientesre      
*       * Prompt:     Outro deposita a manutenção                 
*       * Snippet:    89                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io57x
do form enterotherdeposits


*       *********************************************************
*       *                                                         
*       * _6FO0IO57Y  ON SELECTION BAR 6 OF POPUP clientesre      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  178        
*       * Called By:  ON SELECTION BAR 6 OF POPUP clientesre      
*       * Prompt:     Registro mensal em Dia                      
*       * Snippet:    90                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io57y
do form MonthlyLogByDay


*       *********************************************************
*       *                                                         
*       * _6FO0IO57Z  ON SELECTION BAR 7 OF POPUP clientesre      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  179        
*       * Called By:  ON SELECTION BAR 7 OF POPUP clientesre      
*       * Prompt:     Por cento pagos em Dia                      
*       * Snippet:    91                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io57z
do form percentbyday


*       *********************************************************
*       *                                                         
*       * _6FO0IO580  ON SELECTION BAR 9 OF POPUP clientesre      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  182        
*       * Called By:  ON SELECTION BAR 9 OF POPUP clientesre      
*       * Prompt:     Importação/borne do LockBox                 
*       * Snippet:    92                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io580
clos all

FileToRead=getfile('txt')
if len(alltrim(FileToRead))=0
	messagebox("Please select a LockBox file to process.",0," System Alert")
	return
endif

*!*	YrPrefix="20"
*!*	PymntID=""
*!*	xDate={  /  /  }
*!*	xTime=" "
*!*	exitProcess=.F.

*!*	rptDate=date()
*!*	rptTime=time()

use LockBox in 0
use LockBoxPost in 0

use Data_Loc in 0
sele Data_Loc
loca for company_no=cCompNo
if found() and len(alltrim(data_loc.lockbox))=7
	thisLockBox=data_loc.lockbox
	use
else
	messagebox("Unable to locate Regions Lockbox number - Contact IT Dept.",0," System Alert")
	clos all
	return
endif		

Do Form LockBoxPost with FileToRead,thisLockBox

*!*	Do ImportData
*!*	if !exitProcess
*!*		Do ProcessData
*!*		Do PostPayments

*!*		sele * from LockBoxPost ;
*!*			where lBoxDate=xDate and lBoxTime=xTime and postdate=rptDate ;
*!*		into cursor tmpOut

*!*		sele tmpOut
*!*		go top
*!*		if !eof()
*!*			rptHeading="LockBox Report"
*!*			report form LockBoxReport preview

*!*			sele * from LockBoxPost ;
*!*				where lBoxDate=xDate and lBoxTime=xTime and postdate=rptDate ;
*!*			and PostResult<>"Posted" ;	
*!*			into cursor tmpOut

*!*			sele tmpOut
*!*			if !eof()
*!*				rptHeading="LockBox Exception Report"
*!*				repo form LockBoxReport preview
*!*			endif
*!*		else
*!*			messagebox("Nothing to Report.",0," System Alert")
*!*		endif
*!*	endif

*!*	clos all
*!*	return

*!*	PROC ImportData
*!*		wait window "Importing LockBox data..." nowait
*!*		crea cursor tmpLockBox ;
*!*			(recType C(1), ;
*!*			PriorCode C(2), ;
*!*			Dest C(10), ;
*!*			Origin C(10), ;
*!*			CreateDate D, ;
*!*			CreateTime C(4), ;
*!*			RefCode C(10), ;
*!*			ServType C(3), ;
*!*			RecSize C(3), ;
*!*			BlockSize C(4), ;
*!*			FormatCode C(1), ;
*!*			BatchNum C(3), ;
*!*			LockBoxNum C(7), ;
*!*			CreditDate D, ;
*!*			ItemNum C(3), ;
*!*			CheckAmt N(11,2), ;
*!*			RouteNum C(9), ;
*!*			AcctNum C(10), ;
*!*			CheckNum C(8), ;
*!*			OverType C(1), ;
*!*			SeqNum C(2), ;
*!*			LastOverInd C(1), ;
*!*	   	 	CustNo C(6), ;
*!*	   	 	InvNo C(18), ;
*!*			PaidAmt N(10,2), ;	
*!*			TotItems C(4), ;
*!*			TotDollars N(11,2), ;
*!*			RecCount C(6))

*!*		create cursor tmpImport ;
*!*			(Data C(80))
*!*			
*!*		sele tmpImport
*!*		append from (FileToRead) type delimited
*!*		go top

*!*		*--> Check that only one unique lockbox number is contained in the file
*!*		*--> and that the lockbox number is correct for the region.
*!*		sele distinct substr(tmpImport.data,8,7) as lockbox ;
*!*			from tmpImport ;
*!*		where left(tmpImport.data,1)="5" ;
*!*		into cursor tmpVerify

*!*		*wait window "Current Lockbox "+curLockBox+" Import LockBox "+tmpVerify.lockbox

*!*		sele tmpVerify
*!*		do case
*!*			case reccount()>1
*!*				wait clear
*!*				messagebox("Import File has multiple LockBoxes - contact IT Dept.",0," System Alert")
*!*				clos all
*!*				exitProcess=.T.
*!*				return
*!*			case tmpVerify.LockBox<>curLockBox
*!*				wait clear
*!*				messagebox("Incorrect LockBox for this region - process stopped.",0," System Alert")
*!*				clos all
*!*				exitProcess=.T.
*!*				return
*!*		endcase		

*!*		xDate = ctod(substr(tmpImport.Data,26,2)+"/" ;
*!*			+substr(tmpImport.Data,28,2)+"/" ;
*!*			+YrPrefix+substr(tmpImport.Data,24,2))
*!*		xTime = substr(tmpImport.Data,30,4)

*!*		*wait window dtoc(xDate)

*!*		sele LockBox
*!*		loca for CreateDate = xDate and ;
*!*			CreateTime = xTime

*!*		if found()
*!*			wait clear
*!*			messagebox("File Already Imported - will check to see if it has been processed.",0," System Alert")
*!*			return
*!*		endif

*!*		sele tmpImport
*!*		scan
*!*			do case
*!*				case left(Data,1)="1"
*!*					sele tmpLockBox
*!*					append blank
*!*					repla recType with "1"
*!*					repla PriorCode with substr(tmpImport.Data,2,2)
*!*					repla Dest with substr(tmpImport.Data,4,10)
*!*					repla Origin with substr(tmpImport.Data,14,10)
*!*					repla CreateDate with ctod(substr(tmpImport.Data,26,2)+"/" ;
*!*						+substr(tmpImport.Data,28,2)+"/" ;
*!*						+YrPrefix+substr(tmpImport.Data,24,2))
*!*					repla CreateTime with substr(tmpImport.Data,30,4)
*!*				case left(Data,1)="2"
*!*					sele tmpLockBox
*!*					append blank
*!*					repla recType with "2"
*!*					repla Dest with substr(tmpImport.Data,2,10)
*!*					repla Origin with substr(tmpImport.Data,12,10)
*!*					repla RefCode with substr(tmpImport.Data,22,10)
*!*					repla ServType with substr(tmpImport.Data,32,3)
*!*					repla RecSize with substr(tmpImport.Data,35,3)
*!*					repla BlockSize with substr(tmpImport.Data,38,4)
*!*					repla FormatCode with substr(tmpImport.Data,42,1)
*!*				case left(Data,1)="5"
*!*					sele tmpLockBox
*!*					append blank
*!*					repla recType with "5"
*!*					repla BatchNum with substr(tmpImport.Data,2,3)
*!*					repla LockBoxNum with substr(tmpImport.Data,8,7)
*!*					repla CreditDate with ctod(substr(tmpImport.Data,17,2)+"/" ;
*!*						+substr(tmpImport.Data,19,2)+"/" ;
*!*						+YrPrefix+substr(tmpImport.Data,15,2))
*!*					repla Dest with substr(tmpImport.Data,21,10)
*!*					repla Origin with substr(tmpImport.Data,31,10)
*!*				case left(Data,1)="6"
*!*					sele tmpLockBox
*!*					append blank
*!*					repla recType with "6"
*!*					repla BatchNum with substr(tmpImport.Data,2,3)
*!*					repla ItemNum with substr(tmpImport.Data,5,3)
*!*					repla CheckAmt with val(substr(tmpImport.Data,8,8)+"."+substr(tmpImport.Data,16,2))
*!*					repla RouteNum with substr(tmpImport.Data,18,9)
*!*					repla AcctNum with substr(tmpImport.Data,27,10)
*!*					repla CheckNum with substr(tmpImport.Data,37,8)
*!*					repla CustNo with substr(tmpImport.Data,45,6)
*!*					repla InvNo with substr(tmpImport.Data,51,18)
*!*					repla PaidAmt with val(substr(tmpImport.Data,69,7)+"."+substr(tmpImport.Data,76,2))
*!*				case left(Data,1)="4"
*!*					sele tmpLockBox
*!*					append blank
*!*					repla recType with "4"
*!*					repla BatchNum with substr(tmpImport.Data,2,3)
*!*					repla ItemNum with substr(tmpImport.Data,5,3)
*!*					repla OverType with substr(tmpImport.Data,8,1)
*!*					repla SeqNum with substr(tmpImport.Data,9,2)
*!*					repla LastOverInd with substr(tmpImport.Data,11,1)
*!*					repla CustNo with substr(tmpImport.Data,12,6)
*!*					repla InvNo with substr(tmpImport.Data,18,18)
*!*					repla PaidAmt with val(substr(tmpImport.Data,36,7)+"."+substr(tmpImport.Data,43,2))
*!*				case left(Data,1)="7"
*!*					sele tmpLockBox
*!*					append blank
*!*					repla recType with "7"
*!*					repla BatchNum with substr(tmpImport.Data,2,3)
*!*					repla LockBoxNum with substr(tmpImport.Data,8,7)
*!*					repla CreditDate with ctod(substr(tmpImport.Data,17,2)+"/" ;
*!*						+substr(tmpImport.Data,19,2)+"/" ;
*!*						+YrPrefix+substr(tmpImport.Data,15,2))
*!*					repla TotItems with substr(tmpImport.Data,21,3)
*!*					repla TotDollars with val(substr(tmpImport.Data,24,8)+"."+substr(tmpImport.Data,32,2))
*!*				case left(Data,1)="8"
*!*					sele tmpLockBox
*!*					append blank
*!*					repla recType with "8"
*!*					repla LockBoxNum with substr(tmpImport.Data,8,7)
*!*					repla CreditDate with ctod(substr(tmpImport.Data,17,2)+"/" ;
*!*						+substr(tmpImport.Data,19,2)+"/" ;
*!*						+YrPrefix+substr(tmpImport.Data,15,2))
*!*					repla TotItems with substr(tmpImport.Data,21,4)
*!*					repla TotDollars with val(substr(tmpImport.Data,25,8)+"."+substr(tmpImport.Data,33,2))
*!*				case left(Data,1)="9"
*!*					sele tmpLockBox
*!*					append blank
*!*					repla recType with "9"
*!*					repla recCount with substr(tmpImport.Data,2,6)
*!*			endcase
*!*			sele tmpImport
*!*		endscan		
*!*		sele tmpLockBox
*!*		scan
*!*			scatter memvar
*!*			insert into LockBox from memvar
*!*		endscan	
*!*		wait clear
*!*	ENDPROC

*!*	PROC ProcessData
*!*		sele LockBox
*!*		lBoxNum=""
*!*		loca for CreateDate=xDate and CreateTime=xTime and empty(process_d)
*!*		if !eof()
*!*			Wait window "Processing LockBox Data..." nowait
*!*			lboxdate=createdate
*!*			lboxtime=createtime
*!*			ImportDate=rptDate
*!*			Process_d=rptDate
*!*			if Process_d<>date()
*!*				Process_t="00:00:00" && Payment was posted to some other date, so use 00:00:00 as the time.
*!*			else
*!*				Process_t=rptTime
*!*			endif
*!*			do while !eof() and rectype<>'9'
*!*				if recType='5'
*!*					lBoxNum=LockBoxNum
*!*					m.Creditdate=LockBox.CreditDate	
*!*					m.Amount=0
*!*					m.PostAmt=0
*!*					m.ItemNum=""
*!*				endif
*!*				if recType='6'
*!*					CheckNo=CheckNum
*!*				endif
*!*				if recType='6' or recType='4'
*!*					m.custno=LockBox.custno
*!*					if len(alltrim(LockBox.invno))<10
*!*						m.InvNo=LockBox.Invno
*!*					else
*!*						m.InvNo=right(LockBox.Invno,15)
*!*					endif
*!*					m.ItemNum=LockBox.ItemNum		
*!*					m.Amount=LockBox.CheckAmt
*!*					m.PostAmt=0		
*!*					insert into LockBoxPost from memvar
*!*				endif	
*!*				repla process_d with rptDate
*!*				repla process_t with rptTime
*!*				skip
*!*			enddo											
*!*		else
*!*			wait clear
*!*			messagebox("File already processed - will check to see if it has been posted.",0," System Alert")
*!*		endif
*!*		wait clear
*!*	ENDPROC
*!*			
*!*	PROC PostPayments
*!*		*suspend
*!*		use jkarofil in 0 order inv_no

*!*		sele LockBoxPost
*!*		set rela to invno into jkarofil
*!*		go top
*!*		loca for lBoxDate=xDate and lBoxTime=xTime and empty(postdate)

*!*		if found()
*!*			wait window "Posting Payments..." nowait
*!*			do while !eof()
*!*				curItemNum=itemNum
*!*				availAmt=Amount
*!*				do while curItemNum=itemNum and !eof()
*!*					if !eof('jkarofil')
*!*						if availAmt>0
*!*							do case
*!*								case empty(jkarofil.check_no)
*!*									PymntID="1"
*!*								case empty(jkarofil.check_no2)
*!*									PymntID="2"
*!*								case empty(jkarofil.check_no3)
*!*									PymntID="3"
*!*								case empty(jkarofil.check_no4)
*!*									PymntID="4"
*!*								case empty(jkarofil.check_no5)
*!*									PymntID="5"
*!*								otherwise
*!*									PymntID="X" && ID for No more room for Payment (No Room)
*!*							endcase
*!*						else
*!*							PymntID="Y"
*!*						endif				
*!*					else
*!*						PymntID="Z" && ID for Invoice not found (Bad Invoice)
*!*					endif

*!*					if !PymntID $ "XYZ"
*!*						sele LockBoxPost
*!*						if availAmt>jkarofil.itm_amt+jkarofil.itm_tax
*!*							repla postAmt 		with jkarofil.itm_amt+jkarofil.itm_tax
*!*							availAmt=availAmt-(jkarofil.itm_amt+jkarofil.itm_tax)			
*!*						else
*!*							repla postamt 		with availAmt
*!*							availAmt=0
*!*						endif
*!*						repla postdate		with rptDate
*!*						repla PostResult 	with "Posted-CK"+PymntID

*!*						*--> KMC 04/01/2008 - Un-remark following to post to AR.
*!*						if PymntID="1"
*!*							repla jkarofil.check_date 	with LockBoxPost.PostDate
*!*							repla jkarofil.check_no 	with LockBoxPost.CheckNo
*!*							repla jkarofil.check_amt	with LockBoxPost.PostAmt
*!*						else
*!*							repla jkarofil.check_dat&PymntID 	with LockBoxPost.PostDate
*!*							repla jkarofil.check_no&PymntID 	with LockBoxPost.CheckNo
*!*							repla jkarofil.check_amt&PymntID 	with LockBoxPost.PostAmt
*!*						endif
*!*						*-->

*!*					else
*!*						select LockBoxPost
*!*						do case
*!*							case PymntID="X"
*!*								repla postdate 		with rptDate
*!*								repla postamt 		with 0
*!*								repla PostResult 	with "No Room"
*!*							case PymntID="Y"
*!*								repla postdate 		with Date()
*!*								repla postamt 		with 0
*!*								repla PostResult 	with "No $$$s"
*!*							case PymntID="Z"
*!*								repla postdate 		with rptDate
*!*								repla postamt 		with 0
*!*								repla PostResult 	with "Bad Invoice"
*!*						endcase				
*!*					endif
*!*					skip
*!*				enddo
*!*			enddo	
*!*			wait clear
*!*		else
*!*			messagebox("File already posted - Will generate posting report.",0," System Alert")
*!*		endif
*!*	ENDPROC
		



*       *********************************************************
*       *                                                         
*       * _6FO0IO581  ON SELECTION BAR 10 OF POPUP clientesre     
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  183        
*       * Called By:  ON SELECTION BAR 10 OF POPUP clientesre     
*       * Prompt:     Relatório da afixação do LockBox            
*       * Snippet:    93                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io581
do form LockBoxPostReport



*       *********************************************************
*       *                                                         
*       * _6FO0IO582  ON SELECTION BAR 1 OF POPUP relatórios      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  166        
*       * Called By:  ON SELECTION BAR 1 OF POPUP relatórios      
*       * Prompt:     Registro da AR                              
*       * Snippet:    94                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io582
Do Form ARLog



*       *********************************************************
*       *                                                         
*       * _6FO0IO583  ON SELECTION BAR 2 OF POPUP relatórios      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  167        
*       * Called By:  ON SELECTION BAR 2 OF POPUP relatórios      
*       * Prompt:     História da AR                              
*       * Snippet:    95                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io583
DO FORM SelectARHistory



*       *********************************************************
*       *                                                         
*       * _6FO0IO584  ON SELECTION BAR 3 OF POPUP relatórios      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  168        
*       * Called By:  ON SELECTION BAR 3 OF POPUP relatórios      
*       * Prompt:     Relatório do envelhecimento                 
*       * Snippet:    96                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io584
DO FORM SelectAging



*       *********************************************************
*       *                                                         
*       * _6FO0IO585  ON SELECTION BAR 4 OF POPUP relatórios      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  169        
*       * Called By:  ON SELECTION BAR 4 OF POPUP relatórios      
*       * Prompt:     Os dinheiros receberam                      
*       * Snippet:    97                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io585
Do form MoniesReceived


*       *********************************************************
*       *                                                         
*       * _6FO0IO586  ON SELECTION BAR 5 OF POPUP relatórios      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  170        
*       * Called By:  ON SELECTION BAR 5 OF POPUP relatórios      
*       * Prompt:     Abra a AR - Por Fran                        
*       * Snippet:    98                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io586
Do form OpenARByFran


*       *********************************************************
*       *                                                         
*       * _6FO0IO587  ON SELECTION BAR 6 OF POPUP relatórios      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  171        
*       * Called By:  ON SELECTION BAR 6 OF POPUP relatórios      
*       * Prompt:     Outro depósitos                             
*       * Snippet:    99                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io587
Do form OtherDeposits





*       *********************************************************
*       *                                                         
*       * _6FO0IO588  ON SELECTION BAR 8 OF POPUP relatórios      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  174        
*       * Called By:  ON SELECTION BAR 8 OF POPUP relatórios      
*       * Prompt:     Abra facturas - revisão do detalhe          
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io588
Do Form OpenInv_DtlReview


*       *********************************************************
*       *                                                         
*       * _6FO0IO589  ON SELECTION BAR 9 OF POPUP relatórios      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  175        
*       * Called By:  ON SELECTION BAR 9 OF POPUP relatórios      
*       * Prompt:     Abra as facturas - Frans que não fazem CB   
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io589
do form OpenInv_nonCB


*       *********************************************************
*       *                                                         
*       * _6FO0IO58A  ON SELECTION BAR 9 OF POPUP utilities       
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  229        
*       * Called By:  ON SELECTION BAR 9 OF POPUP utilities       
*       * Prompt:     Edite o trajeto do banco                    
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io58a
*Do form editbankpath
Do form bankpathinfo



*       *********************************************************
*       *                                                         
*       * _6FO0IO58B  ON SELECTION BAR 10 OF POPUP utilities      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  230        
*       * Called By:  ON SELECTION BAR 10 OF POPUP utilities      
*       * Prompt:     Verificação da cópia STA                    
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io58b
use data_loc in 0
sele data_loc
if cCompNo="NAT999" or cCompNo="NAT991"
	loca for company_no="NAT000"
else
	loca for company_no=cCompNo
endif
*--> Don't call form if we cannot locate bank information.
if found()
	use
	do form SpecialTrustCheck
else
	use
	messagebox("Cannot locate Bank Info.",48,"  No Bank Info Record")
endif




*       *********************************************************
*       *                                                         
*       * _6FO0IO58C  ON SELECTION BAR 11 OF POPUP utilities      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  231        
*       * Called By:  ON SELECTION BAR 11 OF POPUP utilities      
*       * Prompt:     Transferência especial do cliente de confiança 
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io58c
do form SpecialTrustAcctTran


*       *********************************************************
*       *                                                         
*       * _6FO0IO58D  ON SELECTION BAR 1 OF POPUP databaseut      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  188        
*       * Called By:  ON SELECTION BAR 1 OF POPUP databaseut      
*       * Prompt:     Reindex bases de dados                      
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io58d
do form reindexdatabase



*       *********************************************************
*       *                                                         
*       * _6FO0IO58E  ON SELECTION BAR 2 OF POPUP databaseut      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  189        
*       * Called By:  ON SELECTION BAR 2 OF POPUP databaseut      
*       * Prompt:     Clientes lig cruz do reparo                 
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io58e
do form fixcrosslinkedcust


*       *********************************************************
*       *                                                         
*       * _6FO0IO58F  ON SELECTION BAR 3 OF POPUP databaseut      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  190        
*       * Called By:  ON SELECTION BAR 3 OF POPUP databaseut      
*       * Prompt:     Limas do memorando do reparo                
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io58f
*--> Fix Customer Service Files
WAIT window "Repairing Customer Service File..." nowait
USE cDataLoc+"service" in 0
SELE service
COPY to cDataLoc+"tmpServ" type fox2x
USE
tmpFile1=cDataLoc+"oldServ.dbf"
tmpFile2=cDataLoc+"oldServ.fpt"
*--> Delete old files if they exist.
if file(tmpFile1)
	Dele file cDataLoc+"oldServ.dbf"
endif
if file(tmpFile2)
	Dele File cDataLoc+"oldServ.fpt"
endif
*--> Rename current files, so we still have them - just in case.
RENAME cDataLoc+"service.dbf" to cDataLoc+"oldServ.dbf"
RENAME cDataLoc+"service.fpt" to cDataLoc+"oldServ.fpt"
*--> Rename repaired files to proper name for use.
RENAME cDataLoc+"tmpServ.dbf" to cDataLoc+"service.dbf"
RENAME cDataLoc+"tmpServ.fpt" to cDataLoc+"service.fpt"
*--> rebuild Indexes.
WAIT window "Rebuilding Indexes..." nowait
USE cdataLoc+"service" in 0 excl
sele service
Dele TAG ALL
PACK
INDEX ON Cust_No+STR({02/02/2202}-Call_Date) TAG Cust_No
INDEX ON Call_Date                           TAG Call_Date
INDEX ON Cust_No							 TAG Cust
USE

*--> Fix Customer Service History Files
WAIT window "Repairing Customer Service History File..." nowait
USE cDataLoc+"servhst" in 0
SELE servhst
COPY to cDataLoc+"tmpSHst" type fox2x
USE
tmpFile1=cDataLoc+"oldSHst.dbf"
tmpFile2=cDataLoc+"oldSHst.fpt"
*--> Delete old files if they exist.
if file(tmpFile1)
	Dele file cDataLoc+"oldSHst.dbf"
endif
if file(tmpFile2)
	Dele File cDataLoc+"oldSHst.fpt"
endif
*--> Rename current files, so we still have them - just in case.
RENAME cDataLoc+"servhst.dbf" to cDataLoc+"oldSHst.dbf"
RENAME cDataLoc+"servhst.fpt" to cDataLoc+"oldSHst.fpt"
*--> Rename repaired files to proper name for use.
RENAME cDataLoc+"tmpSHst.dbf" to cDataLoc+"servhst.dbf"
RENAME cDataLoc+"tmpSHst.fpt" to cDataLoc+"servhst.fpt"
*--> rebuild Indexes.
WAIT window "Rebuilding Indexes..." nowait
USE cdataLoc+"servhst" in 0 excl
sele servhst
Dele TAG ALL
PACK
INDEX ON Cust_No+STR({02/02/2202}-Call_Date) TAG Cust_No
INDEX ON Call_Date                           TAG Call_Date
INDEX ON Cust_No							 TAG Cust
USE

*--> Fix Collection Calls Files
WAIT window "Repairing Collections File..." nowait
USE cDataLoc+"jkcuscol" in 0
SELE jkcuscol
COPY to cDataLoc+"tmpColl" type fox2x
USE
tmpFile1=cDataLoc+"oldColl.dbf"
tmpFile2=cDataLoc+"oldColl.fpt"
*--> Delete old files if they exist.
if file(tmpFile1)
	Dele file cDataLoc+"oldColl.dbf"
endif
if file(tmpFile2)
	Dele File cDataLoc+"oldColl.fpt"
endif
*--> Rename current files, so we still have them  - just in case.
RENAME cDataLoc+"jkcuscol.dbf" to cDataLoc+"oldColl.dbf"
RENAME cDataLoc+"jkcuscol.fpt" to cDataLoc+"oldColl.fpt"
*--> Rename repaired files to proper name for use.
RENAME cDataLoc+"tmpColl.dbf" to cDataLoc+"jkcuscol.dbf"
RENAME cDataLoc+"tmpColl.fpt" to cDataLoc+"jkcuscol.fpt"
*--> rebuild Indexes.
WAIT window "Rebuilding Indexes..." nowait
USE cDataLoc+"jkcuscol" in 0 excl
Dele TAG ALL
PACK
INDEX ON Cust_No+STR({02/02/2202}-Call_Date) TAG Cust_No
INDEX ON Call_Date                           TAG Call_Date
INDEX ON Cust_No							 TAG Cust
USE

*--> Fix Collection Calls History Files
WAIT window "Repairing Collections History File..." nowait
USE cDataLoc+"collhst" in 0
SELE collhst
COPY to cDataLoc+"tmpCHst" type fox2x
USE
tmpFile1=cDataLoc+"oldCHst.dbf"
tmpFile2=cDataLoc+"oldCHst.fpt"
*--> Delete old files if they exist.
if file(tmpFile1)
	Dele file cDataLoc+"oldCHst.dbf"
endif
if file(tmpFile2)
	Dele File cDataLoc+"oldCHst.fpt"
endif
*--> Rename current files, so we still have them  - just in case.
RENAME cDataLoc+"collhst.dbf" to cDataLoc+"oldCHst.dbf"
RENAME cDataLoc+"collhst.fpt" to cDataLoc+"oldCHst.fpt"
*--> Rename repaired files to proper name for use.
RENAME cDataLoc+"tmpCHst.dbf" to cDataLoc+"collhst.dbf"
RENAME cDataLoc+"tmpCHst.fpt" to cDataLoc+"collhst.fpt"
*--> rebuild Indexes.
WAIT window "Rebuilding Indexes..." nowait
USE cDataLoc+"collhst" in 0 excl
Dele TAG ALL
PACK
INDEX ON Cust_No+STR({02/02/2202}-Call_Date) TAG Cust_No
INDEX ON Call_Date                           TAG Call_Date
INDEX ON Cust_No							 TAG Cust
USE

*--> Fix Franchisee Calls Files
WAIT window "Repairing Franchisee Calls File..." nowait
USE cDataLoc+"FranCall" in 0 alias FranCall
SELE FranCall
COPY to cDataLoc+"tmpFCall" type fox2x
USE
tmpFile1=cDataLoc+"oldFCall.dbf"
tmpFile2=cDataLoc+"oldFCall.fpt"
*--> Delete old files if they exist.
if file(tmpFile1)
	Dele file cDataLoc+"oldFCall.dbf"
endif
if file(tmpFile2)
	Dele File cDataLoc+"oldFCall.fpt"
endif
*--> Rename current files, so we still have them  - just in case.
RENAME cDataLoc+"FranCall.dbf" to cDataLoc+"oldFCall.dbf"
RENAME cDataLoc+"FranCall.fpt" to cDataLoc+"oldFCall.fpt"
*--> Rename repaired files to proper name for use.
RENAME cDataLoc+"tmpFCall.dbf" to cDataLoc+"FranCall.dbf"
RENAME cDataLoc+"tmpFCall.fpt" to cDataLoc+"FranCall.fpt"
*--> rebuild Indexes.
WAIT window "Rebuilding Indexes..." nowait
USE cDataLoc+"FranCall" in 0 excl
Dele TAG ALL
PACK
INDEX ON Dlr_Code+STR({02/02/2202}-Call_Date) TAG FranCall
INDEX ON Call_Date                           TAG Call_Date
INDEX ON Dlr_Code							 TAG Dlr
USE

WAIT clear
Clos all
Clea
RETURN



*       *********************************************************
*       *                                                         
*       * _6FO0IO58G  ON SELECTION BAR 1 OF POPUP systemutil      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  195        
*       * Called By:  ON SELECTION BAR 1 OF POPUP systemutil      
*       * Prompt:     Dados do arquivo                            
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io58g
cMessageTitle = 'Archive Data'
cMessageText = 'Is this the correct Date?'+CHR(13)+CHR(13)+DTOC(DATE())
nDialogType = 4 + 32 + 256
*  4 = Yes and No buttons
*  32 = Question mark icon
*  256 = Second button is default

stop_proc = .F.
nAnswer = MESSAGEBOX(cMessageText, nDialogType, cMessageTitle)

DO CASE
CASE nAnswer = 6

ON ERROR DO stop_proc	

*!*	ON ERROR DO stop_proc WITH ;
*!*	   ERROR( ), MESSAGE( ), MESSAGE(1), PROGRAM( ), LINENO( )

	IF stop_proc=.F.
		use service in 0 excl
		if !file('servhst.dbf')
			sele service
			copy stru to servhst
		endif
		use servhst in 0
	ENDIF
	
	IF stop_proc=.F.
		use jkcuscol in 0 excl
		if !file('collhst.dbf')
			sele jkcuscol
			copy stru to collhst
		endif
		use collhst in 0
	ENDIF	

	IF stop_proc=.F.
		use jkarofil in 0 excl
		if !file('delaro.dbf')
			sele jkarofil
			copy stru to delaro
		endif	
		use delaro in 0
		IF !FILE ('arohist.dbf')
			Sele jkarofil
			COPY STRU TO arohist
		ENDIF
		use arohist in 0
	ENDIF	
	
	*--> KMC 07/27/2004 - To Archive old Telemarketing calls.	
	xTele=.F.
	IF stop_proc = .F.
		if file(cDataLoc+'custleads\custleadcalls.dbf')
			xTele=.T.
			use cDataLoc+"custleads\custleadcalls" in 0 excl
			if !file(cDataLoc+'custleads\clcallhst.dbf')
				sele custleadcalls
				copy stru to cDataLoc+"custleads\clcallhst"
			endif	
			use cDataLoc+"CustLeads\clcallhst" in 0
		endif
	ENDIF	
	*-->

	IF stop_proc
		CLOSE DATA ALL
		ON ERROR && Reset Error routine back to default setting.
		RETURN
	ENDIF

	WAIT WINDOW "Archiving old AR and call records..." NOWAIT
	
	&& KMC 01/25/2001
	&& Get the deleted records and save them to delaro, just in case
	&& we need to bring it back sometime, payments here are virtually
	&& impossible to recover otherwise.
	SET DELE OFF
	SELE * FROM jkarofil WHERE DELETED() INTO TABLE tmp
	SELE delaro
	APPEND FROM tmp
	use
	sele tmp
	use
	dele file tmp.dbf
	SET DELE ON

	&& Select all AR older than 6 months and paid in full.
	SELE * FROM jkarofil WHERE date_inv<GOMONTH(DATE(),-6) AND ;
		itm_amt+itm_tax=check_amt+check_amt2+check_amt3+check_amt4+check_amt5 ;
		AND check_date<GOMONTH(DATE(),-6) ;
		AND check_dat2<GOMONTH(DATE(),-6) ;
		AND check_dat3<GOMONTH(DATE(),-6) ;
		AND check_dat4<GOMONTH(DATE(),-6) ;
		AND check_dat5<GOMONTH(DATE(),-6) ;
		AND !DELETED() ;
		INTO TABLE tmp
	SELE arohist
	APPEND FROM tmp
	use
	sele tmp
	use
	DELE FILE tmp.DBF
	Sele jkarofil
	DELE ALL FOR date_inv<GOMONTH(DATE(),-6) AND ;
		itm_amt+itm_tax=check_amt+check_amt2+check_amt3+check_amt4+check_amt5 ;
		AND check_date<GOMONTH(DATE(),-6) ;
		AND check_dat2<GOMONTH(DATE(),-6) ;
		AND check_dat3<GOMONTH(DATE(),-6) ;
		AND check_dat4<GOMONTH(DATE(),-6) ;
		AND check_dat5<GOMONTH(DATE(),-6)
	PACK
	use
	
	&& Select all Customer Service records older than 6 months.
	WAIT WINDOW "Archiving old Customer Service records..." NOWAIT
	SELE * FROM service WHERE call_date<GOMONTH(DATE(),-6) AND !DELETED() INTO TABLE tmp
	SELE servhst
	APPEND FROM tmp
	use
	sele tmp
	use
	DELE FILE tmp.DBF
	sele service
	DELE ALL FOR call_date<GOMONTH(DATE(),-6)
	PACK
	use
	
	&& Select all Collection records more than 6 months old.
	WAIT WINDOW "Archiving old Collections records..." NOWAIT
	SELE * FROM jkcuscol WHERE call_date<GOMONTH(DATE(),-6) AND !DELETED() INTO TABLE tmp
	SELE collhst
	APPEND FROM tmp
	use
	sele tmp
	use
	dele file tmp.dbf
	sele jkcuscol
	DELE ALL FOR call_date<GOMONTH(DATE(),-6)
	PACK
	use

	&& KMC 07/27/2004 - Select all Telemarketing calls more than 6 months old.
	if xTele
		WAIT WINDOW "Archiving old Telemarketing calls..." NOWAIT
		SELE * FROM cDataLoc+"custleads\custleadcalls" WHERE calldate<GOMONTH(DATE(),-6) AND !DELETED() INTO TABLE tmp
		IF _TALLY > 0
			SELE clcallhst
			APPEND FROM tmp
			use
			sele tmp
			use
			dele file tmp.dbf
			sele custleadcalls
			DELE ALL FOR calldate<GOMONTH(DATE(),-6)
			PACK
			use	
		ENDIF	
	endif
	
	clos data all
	ON ERROR
	WAIT CLEAR
	MESSAGEBOX("Archive Data Completed!",48)
	
CASE nAnswer = 7
	* WAIT WINDOW 'You chose No'
ENDCASE

PROC stop_proc
*!*	PARAMETER merror, mess, mess1, mprog, mlineno
*!*	CLEAR
*!*	?
*!*	?
*!*	?
*!*	?
*!*	?
*!*	?
*!*	?
*!*	?
*!*	?

*!*	?"Error number: " + LTRIM(STR(merror))
*!*	?"Error message: " +  mess
*!*	?"Line of code with error: " + mess1
*!*	?"Line number of error: " + LTRIM(STR(mlineno))
*!*	?"Program with error: " + mprog
*!*	WAIT WIND

	WAIT CLEAR
	CLOSE DATA ALL
	ON ERROR
	messagebox("WARNING!  Someone is still in the system.  Please try again later.",48," System Alert")
	stop_proc=.T.
RETURN



*       *********************************************************
*       *                                                         
*       * _6FO0IO58H  ON SELECTION BAR 2 OF POPUP systemutil      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  196        
*       * Called By:  ON SELECTION BAR 2 OF POPUP systemutil      
*       * Prompt:     Calculadora do pagamento                    
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io58h
do form payments


*       *********************************************************
*       *                                                         
*       * _6FO0IO58I  ON SELECTION BAR 3 OF POPUP systemutil      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  197        
*       * Called By:  ON SELECTION BAR 3 OF POPUP systemutil      
*       * Prompt:     A recordação arquivou a factura             
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io58i
DO FORM RECALLARCHIVEDINVOICE with "Recall"


*       *********************************************************
*       *                                                         
*       * _6FO0IO58J  ON SELECTION BAR 4 OF POPUP systemutil      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  198        
*       * Called By:  ON SELECTION BAR 4 OF POPUP systemutil      
*       * Prompt:     Factura suprimida recordação                
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io58j
DO FORM RecallDeletedInvoice



*       *********************************************************
*       *                                                         
*       * _6FO0IO58K  ON SELECTION BAR 5 OF POPUP systemutil      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  199        
*       * Called By:  ON SELECTION BAR 5 OF POPUP systemutil      
*       * Prompt:     Verificações reversas do Charge-Back        
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io58k
DO FORM REVERSECHARGEBACKCHECKS


*       *********************************************************
*       *                                                         
*       * _6FO0IO58L  ON SELECTION BAR 6 OF POPUP systemutil      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  200        
*       * Called By:  ON SELECTION BAR 6 OF POPUP systemutil      
*       * Prompt:     Factura rachada                             
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io58l
x=messagebox(" Be sure that all CB/TAR checks have been printed BEFORE splitting an invoice."+CHR(13)+ ;
" Failure to do so can result in CB/TAR checks not being generated for the invoice being split."+CHR(13)+ ;
" If you're not sure, run the appropriate Possible CB/TAR report to be certain the invoice"+CHR(13)+ ;
" in question does not have TAR monies waiting to be paid.",65," Invoice Splitter Message")
if x=1
	DO FORM RECALLARCHIVEDINVOICE with "Split"
else
	return
endif		


*       *********************************************************
*       *                                                         
*       * _6FO0IO58M  ON SELECTION BAR 7 OF POPUP systemutil      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  201        
*       * Called By:  ON SELECTION BAR 7 OF POPUP systemutil      
*       * Prompt:     Cliente de Untransfer                       
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io58m
DO FORM UNTRANSFERCUSTOMER


*       *********************************************************
*       *                                                         
*       * _6FO0IO58N  ON SELECTION BAR 9 OF POPUP systemutil      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  204        
*       * Called By:  ON SELECTION BAR 9 OF POPUP systemutil      
*       * Prompt:     Dados da exportação à televenda             
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io58n
x=messagebox ("Click 'OK' to update your Telemarketing database"+CHR(13)+;
			"with data from your customer database."+CHR(13)+CHR(13),1," System Alert")
if x<>1
	return
endif	

create cursor CheckLeads ;
	(cust_no C(6), ;
	cus_name C(30), ;
	cus_addr C(30), ;
	cus_phone C(10), ;
	LeadId I, ;
	company C(30), ;
	addr1 C(30), ;
	phone C(14))	

use custleads\custleads in 0 order phone
sele custleads
go top
curRegionCode=regioncode

use custleads\keys in 0
sele keys
set filt to table="CUSTLEADS"

*--> KMC 11/15/2006
ZipLen=5
if "$" $ cDataloc
	ZipLen=7
endif	
*-->

*--> Get all cancelled customers that have cancellation dates of 60 days or more ago.
wait window "Selecting all Cancelled accounts..." nowait
sele cust_no, cus_name as Company, cus_addr as Addr1, cus_city as city, cus_state as state, ;
	left(cus_zip,ZipLen) as zip, cus_phone as phone, class_type as accttype, cont_bill, ;
	"Franchise Accounting" as leadsource, "PreCust" as Status, "Outsource" as currentven, ;
	" " as GroupType, -1 as enteredby, -1 as assignedto, 1 as salesid, curRegionCode as regioncode, ;
	date() as createdate, "USA" as Country, canc_date, candescr ;
	from jkcusfil ;
	where flag<>"A" and empty(secondfran) and !empty(canc_date) ;
	and len(alltrim(cus_phone))=10 ;
	and canc_date=<date()-60 ;
	into cursor tmpCancCust ;
	order by cust_no

*--> Import Cancelled accounts into Telemarketing database.
sele tmpCancCust
set rela to phone into CustLeads
go top
wait window "Updating Telemarking data with Cancelled accounts..." nowait
do while !eof('tmpCancCust')
	if eof('CustLeads')
		*--> Update Telemarketing with JK's cancelled customers.
		wait window "Updating Telemarking data with Cancelled account "+tmpCancCust.cust_no+" - adding record..." nowait
		scatter memvar
		
		*--> KMC 11/15/2006
		if len(alltrim(tmpCancCust.zip))=0
			m.zip=replicate("9",ZipLen)
		endif	
		*-->
		
		notes="JK Customer "+cust_no+" Cancelled "+DTOC(TmpCancCust.canc_date)+ ;
			iif(!empty(TmpCancCust.candescr)," - Reason: "+alltrim(TmpCancCust.candescr),"") + ;
			"--> system "+dtoc(date())+"."
		BudgetAmt=TmpCancCust.cont_bill
		id=keys.nextid
		repla keys.nextid with keys.nextid+1
		insert into CustLeads\CustLeads from memvar
		repla CustLeads.lastcontac with NULL CustLeads.callbdate with NULL ;
		CustLeads.lastmailda with NULL CustLeads.startdate with NULL CustLeads.solddate with NULL
	else
		if Custleads.Status<>"Sold" and CustLeads.AcctType<>"Franchise Prospect" ;
			and !"JK Customer "+TmpCancCust.cust_no+" Cancelled "+DTOC(TmpCancCust.canc_date) $ CustLeads.Notes
			wait window "Updating Telemarking data with Cancelled account "+tmpCancCust.cust_no+" - updating record..." nowait
			sele CustLeads
			repla Status with "PreCust"					&& Flag as a Previous Customer.
			repla GroupType with "" 					&& GroupType is no longer used.
			repla AcctType with TmpCancCust.accttype	&& Set Account Type.
			repla BudgetAmt with TmpCancCust.cont_bill	&& Store Cancelled accounts Cont Bill Amt.
			repla ContractAm with 0						&& Clear old contract amt.
			repla SoldDate with NULL	 				&& Clear old Sold date.
			repla StartDate with NULL		  			&& Clear old Start date.
			repla UDF7 with 0							&& Clear old assigned to value.
			if empty(CustLeads.callbdate) or isnull(CustLeads.callbdate)
				*--> If there is no call back date set, unassign the lead.
				repla CallBackBy with ""				&& Clear Call Back by value.
				repla AssignedTo with -1				&& Unassign Lead.
			endif	
			repla notes with alltrim(CustLeads.notes)+" JK Customer "+TmpCancCust.cust_no+ ;
				" Cancelled "+DTOC(TmpCancCust.canc_date)+ ;
				iif(!empty(TmpCancCust.candescr)," - Reason: "+alltrim(TmpCancCust.candescr),"") + ;
				"--> system "+dtoc(date())+"."
		endif
	endif
	sele TmpCancCust	
	skip	
enddo	
use

*--> Get all active customers.
wait window "Selecting all Active accounts..." nowait
sele cust_no, cus_name as Company, cus_addr as Addr1, cus_city as city, cus_state as state, ;
	left(cus_zip,ZipLen) as zip, cus_phone as phone, class_type as accttype, ;
	"Franchise Accounting" as leadsource, "CurCust" as Status, "Outsource" as currentven , ;
	" " as GroupType, -1 as enteredby, -1 as assignedto, 1 as salesid, curRegionCode as regioncode, ;
	date() as createdate, "USA" as Country ;
	from jkcusfil ;
	where flag="A" and empty(secondfran) and empty(canc_date) ;
	and len(alltrim(cus_phone))=10 ;
	into cursor tmpCurCust ;
	order by cust_no
	
*--> Import Active Customers into Telemarketing database.
sele tmpCurCust
set rela to phone into CustLeads
go top
wait window "Updating Telemarking data with Active accounts..." nowait
BudgetAmt=0 && Clear BudgetAmt value last set during Cancelled accounts export.
do while !eof('tmpCurCust')
	if eof('CustLeads')
		*--> Update Telemarketing with JK's current customers.
		wait window "Updating Telemarking data with Active account "+tmpCurCust.cust_no+" - adding record..." nowait
		scatter memvar
		
		*--> KMC 11/15/2006
		if len(alltrim(tmpCurCust.zip))=0
			m.zip=replicate("9",ZipLen)
		endif	
		*-->
		
		notes="JK Customer "+tmpCurCust.cust_no+"--> system "+dtoc(date())+"."
		id=keys.nextid
		repla keys.nextid with keys.nextid+1
		insert into CustLeads\CustLeads from memvar
		repla CustLeads.lastcontac with NULL CustLeads.callbdate with NULL ;
		CustLeads.lastmailda with NULL CustLeads.startdate with NULL CustLeads.solddate with NULL
	else
		if CustLeads.Status<>"CurCust" and AcctType<>"Franchise Prospect"
			if empty(CustLeads.callbdate) or isnull(CustLeads.callbdate)
				wait window "Updating Telemarking data with Active account "+tmpCurCust.cust_no+" - updating record..." nowait
				sele CustLeads
				repla Status with "CurCust"					&& Flag as a Current Customer.
				repla GroupType with ""						&& GroupType is no longer used.
				repla CallBackBy with ""					&& Clear Call Back by value.
				repla UDF7 with Assignedto					&& So we know who the lead WAS assigned to.
				repla AssignedTo with -1					&& Unassign Lead.
				repla AcctType with TmpCurCust.accttype		&& Set Account Type.
				repla CurrentVen with "Outsource" 		&& Using JK, so account Outsources cleaning services.
				if !"JK Customer "+tmpCurCust.cust_no$CustLeads.notes
					repla notes with alltrim(CustLeads.notes)+ ;
					" JK Customer "+tmpCurCust.cust_no+"--> system "+dtoc(date())+"."
				endif
				&& Any data pertaining to a sold account is left alone.  It will be cleared if
				&& and when the account cancels ands gets updated to PreCust status.	
			else
				if CustLeads.status="Active" or CustLeads.Status="Telemark" ;
				or CustLeads.Status="CustSales" or CustLeads.Status="PreCust"
					*--> Lead is NOT flagged as 'CurCust' AND is not a Franchise Prospect
					*--> but DOES have a Call Back Date.  Not sure of this lead
					*--> (call back date set.. don't want to kill anyones call back),
					*--> so copy it to CheckLeads.
					wait window "Updating Telemarking data with Active account "+tmpCurCust.cust_no+" - updating record..." nowait
					sele CustLeads
					scatter fields company, addr1, phone memvar
					LeadId=CustLeads.Id
					insert into CheckLeads from memvar		
					sele CheckLeads
					repla cust_no with tmpCurCust.cust_no
					repla cus_name with tmpCurCust.company
					repla cus_addr with tmpCurCust.addr1
					repla cus_phone with tmpCurCust.phone
				else
					*--> Status is either "DoNotCall", NotQual" or "Sold"
					*--> AND there is a call back date set.  Based on the
					*--> Status of the lead, the call back date is irrelevant.
					*--> Change status to 'CurCust' and unassign the lead.
					wait window "Updating Telemarking data with Active account "+tmpCurCust.cust_no+" - updating record..." nowait
					sele CustLeads
					repla Status with "CurCust"					&& Flag as a Current Customer.
					repla GroupType with ""						&& GroupType is no longer used.
					repla CallBackBy with ""					&& Clear Call Back by value.
					repla CallBDate with NULL					&& Clear Call Back by value.
					repla UDF7 with Assignedto					&& So we know who the lead WAS assigned to.
					repla AssignedTo with -1					&& Unassign Lead.
					repla AcctType with TmpCurCust.accttype		&& Set Account Type.
					repla CurrentVen with "Outsource" 		&& Using JK, so account Outsources cleaning services.
					if !"JK Customer "+tmpCurCust.cust_no$CustLeads.notes
						repla notes with alltrim(CustLeads.notes)+ ;
						" JK Customer "+tmpCurCust.cust_no+"--> system "+dtoc(date())+"."
					endif
					&& Any data pertaining to a sold account is left alone.  It will be cleared if and
					&& when the account cancels ands gets updated to PreCust status.	
				endif			
			endif
		endif
	endif
	sele TmpCurCust	
	skip	
enddo	
use

wait clear

sele CheckLeads
go top
if !eof()
	copy to "Leads_to_Check_"+left(cCompNo,3) type xls
	x=messagebox ("Excel Spreadsheet "+sys(5)+sys(2003)+"\Leads_To_Check_"+left(cCompNo,3)+" has been created."+CHR(13)+ ;
		"This spreadsheet lists leads that the system believes may be current customers."+CHR(13)+ ;
		"Please look over the spreadsheet and manually update these leads to"+CHR(13)+ ;
		"'Current Customer' status if appropriate.",0," Alert")
else
	wait window "Export Complete.  Press any key to continue."
endif
clos all
return



*       *********************************************************
*       *                                                         
*       * _6FO0IO58O  ON SELECTION BAR 10 OF POPUP systemutil     
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  205        
*       * Called By:  ON SELECTION BAR 10 OF POPUP systemutil     
*       * Prompt:     Ligações da televenda da importação         
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io58o
USE custleads\custleads IN 0
SELE custleads
GO TOP

IF EOF()
	CLOS ALL
	MESSAGEBOX("There must be at least one lead in the leads database before data can be imported."," System Alert")
	RETURN
ELSE
	clos all
	do form importleads
endif	


*       *********************************************************
*       *                                                         
*       * _6FO0IO58P  ON SELECTION BAR 12 OF POPUP systemutil     
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  208        
*       * Called By:  ON SELECTION BAR 12 OF POPUP systemutil     
*       * Prompt:     Dados da letra dos CB da exportação         
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io58p
Do Form CBLetterExport


*       *********************************************************
*       *                                                         
*       * _6FO0IO58Q  ON SELECTION BAR 13 OF POPUP systemutil     
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  209        
*       * Called By:  ON SELECTION BAR 13 OF POPUP systemutil     
*       * Prompt:     Dados da factura da exportação              
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io58q
Do Form InvoiceData



*       *********************************************************
*       *                                                         
*       * _6FO0IO58R  ON SELECTION BAR 15 OF POPUP systemutil     
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  212        
*       * Called By:  ON SELECTION BAR 15 OF POPUP systemutil     
*       * Prompt:     Manutenção da CPI                           
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io58r
*FK 7/25/05 Get CPI path
PUBLIC CPIPath
USE data_loc IN 0
SELE data_loc
x=LEN(ALLTRIM(fran_acct))
DO WHILE x=>1
	curChar=SUBSTR(fran_acct,x,1)
	IF curChar="\"
		EXIT
	ELSE
		x=x-1
	ENDIF
ENDDO
IF x<>0
	CPIPath=LEFT(fran_acct,x)+"CPIData"
ELSE
	MESSAGEBOX("Cannot Locate CPI Directory Info.",48,"Alert")
	RETURN
ENDIF

IF FILE(CPIPath+'\CPI.DBF')
	DO FORM CPIfileinfo
ELSE
	MESSAGEBOX("Cannot Locate CPI Table Info.",48,"Alert")
	RETURN
ENDIF



*       *********************************************************
*       *                                                         
*       * _6FO0IO58S  ON SELECTION BAR 1 OF POPUP taxutiliti      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  217        
*       * Called By:  ON SELECTION BAR 1 OF POPUP taxutiliti      
*       * Prompt:     Tabela de imposto da cópia                  
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io58s
IF USED('jktaxtbl')
	SELE jktaxtbl
	USE
ENDIF	
USE jktaxtbl in 0 ORDER countyname
go top
REPO FORM taxtable PREV
CLOSE ALL



*       *********************************************************
*       *                                                         
*       * _6FO0IO58T  ON SELECTION BAR 2 OF POPUP taxutiliti      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  218        
*       * Called By:  ON SELECTION BAR 2 OF POPUP taxutiliti      
*       * Prompt:     Tabela de imposto da actualização           
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io58t
DO FORM ACCESSCODE


*       *********************************************************
*       *                                                         
*       * _6FO0IO58U  ON SELECTION BAR 1 OF POPUP batchentry      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  234        
*       * Called By:  ON SELECTION BAR 1 OF POPUP batchentry      
*       * Prompt:     Entrada do grupo                            
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io58u
DO form BatchTrxEntry



*       *********************************************************
*       *                                                         
*       * _6FO0IO58V  ON SELECTION BAR 2 OF POPUP batchentry      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  235        
*       * Called By:  ON SELECTION BAR 2 OF POPUP batchentry      
*       * Prompt:     Relatório do grupo                          
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io58v
Do form BatchReport


*       *********************************************************
*       *                                                         
*       * _6FO0IO58W  ON SELECTION BAR 3 OF POPUP batchentry      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  236        
*       * Called By:  ON SELECTION BAR 3 OF POPUP batchentry      
*       * Prompt:     Borne do grupo                              
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io58w
x=messagebox ("Click OK to post all Un-Posted Batch Transactions",1," Jani-King")
if x=1
	do postbatchtrx
endif	


*       *********************************************************
*       *                                                         
*       * _6FO0IO58X  ON SELECTION BAR 5 OF POPUP batchentry      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU_BR.MPR,            Record:  238        
*       * Called By:  ON SELECTION BAR 5 OF POPUP batchentry      
*       * Prompt:     Spreadsheet do sumário do vendedor da importação 
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0io58x
do form importafflinkdata
