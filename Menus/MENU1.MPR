*       *********************************************************
*       *                                                         
*       * 09/23/2022             MENU1.MPR              08:42:21  
*       *                                                         
*       *********************************************************
*       *                                                         
*       * Author's Name                                           
*       *                                                         
*       * Copyright (C) 2022 Company Name                         
*       * Address                                                 
*       * City,     Zip                                           
*       *                                                         
*       * Description:                                            
*       * This PROGRAM was automatically generated BY GENMENU.    
*       *                                                         
*       *********************************************************


*       *********************************************************
*       *                                                         
*       *                      Menu Definition                    
*       *                                                         
*       *********************************************************
*

SET SYSMENU TO
SET SYSMENU AUTOMATIC

DEFINE PAD _6fo0inokn OF _MSYSMENU PROMPT "\<File" COLOR SCHEME 3 ;
	KEY ALT+F, ""
DEFINE PAD _msm_edit OF _MSYSMENU PROMPT "\<Edit" COLOR SCHEME 3 ;
	KEY ALT+E, "ALT+E" ;
	SKIP FOR lDataPathOk=.F. ;
	MESSAGE "Edits text or current selection"
DEFINE PAD _6fo0inoko OF _MSYSMENU PROMPT "\<Customer" COLOR SCHEME 3 ;
	KEY ALT+C, "" ;
	SKIP FOR lDataPathOk=.F. or MenCust="0"
DEFINE PAD _6fo0inokp OF _MSYSMENU PROMPT "F\<ranchisee" COLOR SCHEME 3 ;
	KEY ALT+R, "" ;
	SKIP FOR lDataPathOk=.F. or MenFran="0"
DEFINE PAD _6fo0inokq OF _MSYSMENU PROMPT "Com\<pany" COLOR SCHEME 3 ;
	KEY ALT+P, "" ;
	SKIP FOR lDataPathOk=.F. or MenComp="0"
DEFINE PAD _6fo0inokr OF _MSYSMENU PROMPT "\<Accounts Receivable" COLOR SCHEME 3 ;
	KEY ALT+A, "" ;
	SKIP FOR lDataPathOk=.F. or MenAR="0"
DEFINE PAD _6fo0inoks OF _MSYSMENU PROMPT "\<Utilities" COLOR SCHEME 3 ;
	KEY ALT+U, "" ;
	SKIP FOR lDataPathOk=.F.  or MenUtil="0"
ON PAD _6fo0inokn OF _MSYSMENU ACTIVATE POPUP file
ON PAD _msm_edit OF _MSYSMENU ACTIVATE POPUP edit
ON PAD _6fo0inoko OF _MSYSMENU ACTIVATE POPUP customers
ON PAD _6fo0inokp OF _MSYSMENU ACTIVATE POPUP franchisee
ON PAD _6fo0inokq OF _MSYSMENU ACTIVATE POPUP company
ON PAD _6fo0inokr OF _MSYSMENU ACTIVATE POPUP accountsre
ON PAD _6fo0inoks OF _MSYSMENU ACTIVATE POPUP utilities

DEFINE POPUP file MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF file PROMPT "Select Data Location"
DEFINE BAR 2 OF file PROMPT "Select Printer"
DEFINE BAR 3 OF file PROMPT "Exit"
ON SELECTION BAR 1 OF file ;
	DO _6fo0inokt ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 2 OF file ;
	DO _6fo0inoku ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 3 OF file ;
	DO _6fo0inokv ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")

DEFINE POPUP edit MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR _med_cut OF edit PROMPT "Cut" ;
	KEY CTRL+X, "Ctrl+X" ;
	MESSAGE "Removes the selection and places it onto the Clipboard"
DEFINE BAR _med_copy OF edit PROMPT "Copy" ;
	KEY CTRL+C, "Ctrl+C" ;
	MESSAGE "Copies the selection onto the Clipboard"
DEFINE BAR _med_paste OF edit PROMPT "Paste" ;
	KEY CTRL+V, "Ctrl+V" ;
	MESSAGE "Pastes the contents of the Clipboard"

DEFINE POPUP customers MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF customers PROMPT "Customer File Maintenance" ;
	SKIP FOR CustMaint="0"
DEFINE BAR 2 OF customers PROMPT "Customer Transaction Maintenance" ;
	SKIP FOR CustTrx="0"
DEFINE BAR 3 OF customers PROMPT "\-"
DEFINE BAR 4 OF customers PROMPT "Create Monthly Customer Transactions" ;
	SKIP FOR CreateBillRun="0"
DEFINE BAR 5 OF customers PROMPT "Delete Monthly Customer Transactions" ;
	SKIP FOR CreateBillRun="0" or (CreateBillRun="1" and ! "D" $ CreateBillRun)
DEFINE BAR 6 OF customers PROMPT "\-"
DEFINE BAR 7 OF customers PROMPT "Consolidated Billing" ;
	SKIP FOR ConsolBilling="0"
DEFINE BAR 8 OF customers PROMPT "    Add Invoice to Existing Consolidated Bill" ;
	SKIP FOR ConsolBilling="0"
DEFINE BAR 9 OF customers PROMPT "\-"
DEFINE BAR 10 OF customers PROMPT "Invoices" ;
	SKIP FOR CustInv="0"
DEFINE BAR 11 OF customers PROMPT "Past Dues" ;
	SKIP FOR CustPastDue="0"
DEFINE BAR 12 OF customers PROMPT "\-"
DEFINE BAR 13 OF customers PROMPT "Create Mail Merge File" ;
	SKIP FOR CustMMFile="0"
DEFINE BAR 14 OF customers PROMPT "Fax-A-Comment - under construction" ;
	SKIP FOR 1=1
DEFINE BAR 15 OF customers PROMPT "Print Inspection Forms" ;
	SKIP FOR CustInsp="0"
DEFINE BAR 16 OF customers PROMPT "Print  Labels"
ON SELECTION BAR 1 OF customers ;
	DO _6fo0inokw ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 2 OF customers ;
	DO _6fo0inokx ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 4 OF customers ;
	DO _6fo0inoky ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 5 OF customers ;
	DO _6fo0inokz ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 7 OF customers ;
	DO _6fo0inol0 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 8 OF customers ;
	DO _6fo0inol1 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 10 OF customers ;
	DO _6fo0inol2 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON BAR 11 OF customers ACTIVATE POPUP pastdues
ON SELECTION BAR 13 OF customers ;
	DO _6fo0inol3 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 14 OF customers ;
	DO _6fo0inol4 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 15 OF customers ;
	DO _6fo0inol5 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 16 OF customers ;
	DO _6fo0inol6 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")

DEFINE POPUP pastdues MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF pastdues PROMPT "Past Due Notices"
DEFINE BAR 2 OF pastdues PROMPT "Past Due Report"
ON SELECTION BAR 1 OF pastdues ;
	DO _6fo0inol7 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 2 OF pastdues ;
	DO _6fo0inol8 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")

DEFINE POPUP franchisee MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF franchisee PROMPT "Franchisee File Maintenenance" ;
	SKIP FOR FranMaint="0"
DEFINE BAR 2 OF franchisee PROMPT "Franchisee Transaction File Maintenance" ;
	SKIP FOR FranTrx="0"
DEFINE BAR 3 OF franchisee PROMPT "Lease File Maintenance" ;
	SKIP FOR LeaseFileMaint="0"
DEFINE BAR 4 OF franchisee PROMPT "Lease Transfer" ;
	SKIP FOR LeaseTransfer="0"
DEFINE BAR 5 OF franchisee PROMPT "Obligations" ;
	SKIP FOR FranOblig="0"
DEFINE BAR 6 OF franchisee PROMPT "\-"
DEFINE BAR 7 OF franchisee PROMPT "Charge-Back Menu" ;
	SKIP FOR FranCBMenu="0"
DEFINE BAR 8 OF franchisee PROMPT "\-"
DEFINE BAR 9 OF franchisee PROMPT "Franchisee Reports Menu" ;
	SKIP FOR FranRptsMenu="0"
DEFINE BAR 10 OF franchisee PROMPT "\-"
DEFINE BAR 11 OF franchisee PROMPT "Misc Reports" ;
	SKIP FOR FranMiscRpts="0"
DEFINE BAR 12 OF franchisee PROMPT "\-"
DEFINE BAR 13 OF franchisee PROMPT "National Accounts" ;
	SKIP FOR FranNatAccts="0"
DEFINE BAR 14 OF franchisee PROMPT "\-"
DEFINE BAR 15 OF franchisee PROMPT "Create Mail Merge File" ;
	SKIP FOR FranMMFile="0"
DEFINE BAR 16 OF franchisee PROMPT "Print Labels"
DEFINE BAR 17 OF franchisee PROMPT "\-"
DEFINE BAR 18 OF franchisee PROMPT "1099 Menu" ;
	SKIP FOR Fran1099Menu="0"
ON SELECTION BAR 1 OF franchisee ;
	DO _6fo0inol9 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 2 OF franchisee ;
	DO _6fo0inola ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 3 OF franchisee ;
	DO _6fo0inolb ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 4 OF franchisee ;
	DO _6fo0inolc ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 5 OF franchisee ;
	DO _6fo0inold ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON BAR 7 OF franchisee ACTIVATE POPUP chargeback
ON BAR 9 OF franchisee ACTIVATE POPUP _0s60ii7f5
ON BAR 11 OF franchisee ACTIVATE POPUP miscreport
ON BAR 13 OF franchisee ACTIVATE POPUP nationalac
ON SELECTION BAR 15 OF franchisee ;
	DO _6fo0inole ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 16 OF franchisee ;
	DO _6fo0inolf ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON BAR 18 OF franchisee ACTIVATE POPUP _1eb0mo9tg

DEFINE POPUP chargeback MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF chargeback PROMPT "Weekly - Poss CB/TAR Report"
DEFINE BAR 2 OF chargeback PROMPT "Weekly - CB/TAR Checks"
DEFINE BAR 3 OF chargeback PROMPT "Monthly - Poss CB/TAR Report"
DEFINE BAR 4 OF chargeback PROMPT "Monthly - CB/TAR Checks"
DEFINE BAR 5 OF chargeback PROMPT "CB/TAR Check Register"
DEFINE BAR 6 OF chargeback PROMPT "\-"
DEFINE BAR 7 OF chargeback PROMPT "Possible CB Report"
DEFINE BAR 8 OF chargeback PROMPT "Perform CB Procedure"
DEFINE BAR 9 OF chargeback PROMPT "Final CB Report"
DEFINE BAR 10 OF chargeback PROMPT "\-"
DEFINE BAR 11 OF chargeback PROMPT "CB History Report"
DEFINE BAR 12 OF chargeback PROMPT "ND History Report"
DEFINE BAR 13 OF chargeback PROMPT "Print CB Letters"
ON SELECTION BAR 1 OF chargeback ;
	DO _6fo0inolg ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 2 OF chargeback ;
	DO _6fo0inolh ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 3 OF chargeback ;
	DO _6fo0inoli ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 4 OF chargeback ;
	DO _6fo0inolj ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 5 OF chargeback ;
	DO _6fo0inolk ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 7 OF chargeback ;
	DO _6fo0inoll ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 8 OF chargeback ;
	DO _6fo0inolm ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 9 OF chargeback ;
	DO _6fo0inoln ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 11 OF chargeback ;
	DO _6fo0inolo ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 12 OF chargeback ;
	DO _6fo0inolp ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 13 OF chargeback ;
	DO _6fo0inolq ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")

DEFINE POPUP _0s60ii7f5 MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF _0s60ii7f5 PROMPT "Create/Print Franchisee Report"
DEFINE BAR 2 OF _0s60ii7f5 PROMPT "Re-Print Franchisee \<Report"
DEFINE BAR 3 OF _0s60ii7f5 PROMPT "Print Franchisee \<Spreadsheet"
DEFINE BAR 4 OF _0s60ii7f5 PROMPT "\-"
DEFINE BAR 5 OF _0s60ii7f5 PROMPT "Print \<Due Fran Checks"
DEFINE BAR 6 OF _0s60ii7f5 PROMPT "Print Due Fran \<Check Register"
DEFINE BAR 7 OF _0s60ii7f5 PROMPT "Print Franchisee ACH Report" ;
	SKIP FOR !file('ACHConfig')
DEFINE BAR 8 OF _0s60ii7f5 PROMPT "\-"
DEFINE BAR 9 OF _0s60ii7f5 PROMPT "Print Cor\<porate Dues Report"
DEFINE BAR 10 OF _0s60ii7f5 PROMPT "Print \<Workers Comp & Liability Report" ;
	SKIP FOR 1=1
DEFINE BAR 11 OF _0s60ii7f5 PROMPT "\-"
DEFINE BAR 12 OF _0s60ii7f5 PROMPT "Accounting Fee Rebate Maintenance"
DEFINE BAR 13 OF _0s60ii7f5 PROMPT "Print Accoun\<ting Fee Rebate Report"
DEFINE BAR 14 OF _0s60ii7f5 PROMPT "Print \<Accounting Fee Rebate Check"
ON SELECTION BAR 1 OF _0s60ii7f5 ;
	DO _6fo0inolr ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 2 OF _0s60ii7f5 ;
	DO _6fo0inols ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 3 OF _0s60ii7f5 ;
	DO _6fo0inolt ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 5 OF _0s60ii7f5 ;
	DO _6fo0inolu ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 6 OF _0s60ii7f5 ;
	DO _6fo0inolv ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 7 OF _0s60ii7f5 ;
	DO _6fo0inolw ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 9 OF _0s60ii7f5 ;
	DO _6fo0inolx ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 10 OF _0s60ii7f5 ;
	DO _6fo0inoly ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 12 OF _0s60ii7f5 ;
	DO _6fo0inolz ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 13 OF _0s60ii7f5 ;
	DO _6fo0inom0 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 14 OF _0s60ii7f5 ;
	DO _6fo0inom1 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")

DEFINE POPUP miscreport MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF miscreport PROMPT "Franchisee Tabs"
DEFINE BAR 2 OF miscreport PROMPT "Franchisee First  Reached a Specified Billing Amount"
DEFINE BAR 3 OF miscreport PROMPT "Franchisee Revenue Report"
DEFINE BAR 4 OF miscreport PROMPT "Franchisee Yearly Summary"
DEFINE BAR 5 OF miscreport PROMPT "Negative Due Report"
DEFINE BAR 6 OF miscreport PROMPT "Non 3 % Collected Report"
DEFINE BAR 7 OF miscreport PROMPT "Pager Recap Report"
DEFINE BAR 8 OF miscreport PROMPT "Supply Recap Report"
ON SELECTION BAR 1 OF miscreport ;
	DO _6fo0inom2 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 2 OF miscreport ;
	DO _6fo0inom3 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 3 OF miscreport ;
	DO _6fo0inom4 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 4 OF miscreport ;
	DO _6fo0inom5 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 5 OF miscreport ;
	DO _6fo0inom6 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 6 OF miscreport ;
	DO _6fo0inom7 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 7 OF miscreport ;
	DO _6fo0inom8 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 8 OF miscreport ;
	DO _6fo0inom9 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")

DEFINE POPUP nationalac MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF nationalac PROMPT "Bulk Invoice Payment"
DEFINE BAR 2 OF nationalac PROMPT "Possible Payment Report"
DEFINE BAR 3 OF nationalac PROMPT "Print Checks"
DEFINE BAR 4 OF nationalac PROMPT "Check Register"
ON SELECTION BAR 1 OF nationalac ;
	DO _6fo0inoma ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 2 OF nationalac ;
	DO _6fo0inomb ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 3 OF nationalac ;
	DO _6fo0inomc ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 4 OF nationalac ;
	DO _6fo0inomd ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")

DEFINE POPUP _1eb0mo9tg MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF _1eb0mo9tg PROMPT "Print 1099 Report"
DEFINE BAR 2 OF _1eb0mo9tg PROMPT "Print 1099's"
ON SELECTION BAR 1 OF _1eb0mo9tg ;
	DO _6fo0inome ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 2 OF _1eb0mo9tg ;
	DO _6fo0inomf ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")

DEFINE POPUP company MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF company PROMPT "Company File Maintenance" ;
	SKIP FOR CompFileMaint="0"
DEFINE BAR 2 OF company PROMPT "Control File Maintenance" ;
	SKIP FOR ControlFileMaint="0"
DEFINE BAR 3 OF company PROMPT "Reset System Parameters (Side1/Side2)" ;
	SKIP FOR ResetParam="0"
DEFINE BAR 4 OF company PROMPT "\-"
DEFINE BAR 5 OF company PROMPT "Special Trust Check Register Maintenance" ;
	SKIP FOR STACheckReg="0"
DEFINE BAR 6 OF company PROMPT "Bank Information Maintenance" ;
	SKIP FOR BankAcctInfo="0"
DEFINE BAR 7 OF company PROMPT "\-"
DEFINE BAR 8 OF company PROMPT "Fees Collected"
DEFINE BAR 9 OF company PROMPT "Negative Due"
DEFINE BAR 10 OF company PROMPT "\-"
DEFINE BAR 11 OF company PROMPT "Print Accounting Fee Check"
DEFINE BAR 12 OF company PROMPT "Print Advertising Fee Check"
DEFINE BAR 13 OF company PROMPT "Print BP & Bond Check"
DEFINE BAR 14 OF company PROMPT "\-"
DEFINE BAR 15 OF company PROMPT "Print Tax Liability Report"
DEFINE BAR 16 OF company PROMPT "\-"
DEFINE BAR 17 OF company PROMPT "DRO Report"
DEFINE BAR 18 OF company PROMPT "Finders Fees Report"
DEFINE BAR 19 OF company PROMPT "Notes Receivable Report"
DEFINE BAR 20 OF company PROMPT "Obligations Report"
DEFINE BAR 21 OF company PROMPT "Projected Revenue (FF & Lease)"
DEFINE BAR 22 OF company PROMPT "\-"
DEFINE BAR 23 OF company PROMPT "Special Trust Recap"
DEFINE BAR 24 OF company PROMPT "\-"
DEFINE BAR 25 OF company PROMPT "Master Franchise Report" ;
	SKIP FOR !file('CanadaMaster')
DEFINE BAR 26 OF company PROMPT "\-"
DEFINE BAR 27 OF company PROMPT "End Of Month Posting"
ON SELECTION BAR 1 OF company ;
	DO _6fo0inomg ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 2 OF company ;
	DO _6fo0inomh ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 3 OF company ;
	DO _6fo0inomi ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 5 OF company ;
	DO _6fo0inomj ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 6 OF company ;
	DO _6fo0inomk ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON BAR 8 OF company ACTIVATE POPUP feescollec
ON BAR 9 OF company ACTIVATE POPUP negativedu
ON SELECTION BAR 11 OF company ;
	DO _6fo0inoml ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 12 OF company ;
	DO _6fo0inomm ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 13 OF company ;
	DO _6fo0inomn ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 15 OF company ;
	DO _6fo0inomo ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 17 OF company ;
	DO _6fo0inomp ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 18 OF company ;
	DO _6fo0inomq ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 19 OF company ;
	DO _6fo0inomr ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 20 OF company ;
	DO _6fo0inoms ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 21 OF company ;
	DO _6fo0inomt ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON BAR 23 OF company ACTIVATE POPUP specialtru
ON SELECTION BAR 25 OF company ;
	DO _6fo0inomu ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 27 OF company ;
	DO _6fo0inomv ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")

DEFINE POPUP feescollec MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF feescollec PROMPT "Print Fees Collected Possible Payment Report"
DEFINE BAR 2 OF feescollec PROMPT "Print Fees Collected Check"
DEFINE BAR 3 OF feescollec PROMPT "Print Fees Collected Check Register"
DEFINE BAR 4 OF feescollec PROMPT "Print Fees Collected Report"
DEFINE BAR 5 OF feescollec PROMPT "Record Fees Collected"
ON SELECTION BAR 1 OF feescollec ;
	DO _6fo0inomw ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 2 OF feescollec ;
	DO _6fo0inomx ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 3 OF feescollec ;
	DO _6fo0inomy ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 4 OF feescollec ;
	DO _6fo0inomz ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 5 OF feescollec ;
	DO _6fo0inon0 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")

DEFINE POPUP negativedu MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF negativedu PROMPT "Print ND Possible  Payment Report"
DEFINE BAR 2 OF negativedu PROMPT "Print ND Collected Check"
DEFINE BAR 3 OF negativedu PROMPT "Print ND Check Register"
DEFINE BAR 4 OF negativedu PROMPT "Print ND Collected Report"
DEFINE BAR 5 OF negativedu PROMPT "Print ND Paid Report"
ON SELECTION BAR 1 OF negativedu ;
	DO _6fo0inon1 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 2 OF negativedu ;
	DO _6fo0inon2 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 3 OF negativedu ;
	DO _6fo0inon3 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 4 OF negativedu ;
	DO _6fo0inon4 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 5 OF negativedu ;
	DO _6fo0inon5 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")

DEFINE POPUP specialtru MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF specialtru PROMPT "Special Trust Recap"
DEFINE BAR 2 OF specialtru PROMPT "Special Trust Fran Advance Recap"
DEFINE BAR 3 OF specialtru PROMPT "Special Trust Unrecorded Deposits From AR Log"
DEFINE BAR 4 OF specialtru PROMPT "Transfer Advance Data"
DEFINE BAR 5 OF specialtru PROMPT "Edit Advance File"
ON SELECTION BAR 1 OF specialtru ;
	DO _6fo0inon6 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 2 OF specialtru ;
	DO _6fo0inon7 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 3 OF specialtru ;
	DO _6fo0inon8 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 4 OF specialtru ;
	DO _6fo0inon9 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 5 OF specialtru ;
	DO _6fo0inona ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")

DEFINE POPUP accountsre MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF accountsre PROMPT "Cash Receipts Maintenance"
DEFINE BAR 2 OF accountsre PROMPT "Other Deposits Maintenance"
DEFINE BAR 3 OF accountsre PROMPT "\-"
DEFINE BAR 4 OF accountsre PROMPT "AR Reports"
DEFINE BAR 5 OF accountsre PROMPT "\-"
DEFINE BAR 6 OF accountsre PROMPT "Monthly Log By Day"
DEFINE BAR 7 OF accountsre PROMPT "Percent Pd By Day"
DEFINE BAR 8 OF accountsre PROMPT "\-"
DEFINE BAR 9 OF accountsre PROMPT "LockBox Import/Post" ;
	SKIP FOR !LockBoxAvail
DEFINE BAR 10 OF accountsre PROMPT "LockBox Posting Report" ;
	SKIP FOR !LockBoxAvail
ON SELECTION BAR 1 OF accountsre ;
	DO _6fo0inonb ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 2 OF accountsre ;
	DO _6fo0inonc ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON BAR 4 OF accountsre ACTIVATE POPUP arreports
ON SELECTION BAR 6 OF accountsre ;
	DO _6fo0inond ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 7 OF accountsre ;
	DO _6fo0inone ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 9 OF accountsre ;
	DO _6fo0inonf ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 10 OF accountsre ;
	DO _6fo0inong ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")

DEFINE POPUP arreports MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF arreports PROMPT "AR Log"
DEFINE BAR 2 OF arreports PROMPT "AR History"
DEFINE BAR 3 OF arreports PROMPT "Aging Report"
DEFINE BAR 4 OF arreports PROMPT "Monies Received"
DEFINE BAR 5 OF arreports PROMPT "Open AR - By Fran"
DEFINE BAR 6 OF arreports PROMPT "Other Deposits"
DEFINE BAR 7 OF arreports PROMPT "\-"
DEFINE BAR 8 OF arreports PROMPT "Open Invoices - Detail Review"
DEFINE BAR 9 OF arreports PROMPT "Open Invoices - Frans that do not CB"
ON SELECTION BAR 1 OF arreports ;
	DO _6fo0inonh ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 2 OF arreports ;
	DO _6fo0inoni ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 3 OF arreports ;
	DO _6fo0inonj ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 4 OF arreports ;
	DO _6fo0inonk ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 5 OF arreports ;
	DO _6fo0inonl ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 6 OF arreports ;
	DO _6fo0inonm ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 8 OF arreports ;
	DO _6fo0inonn ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 9 OF arreports ;
	DO _6fo0inono ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")

DEFINE POPUP utilities MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF utilities PROMPT "Database Utilities" ;
	SKIP FOR DBUtilities="0"
DEFINE BAR 2 OF utilities PROMPT "\-"
DEFINE BAR 3 OF utilities PROMPT "System Utilities"
DEFINE BAR 4 OF utilities PROMPT "\-"
DEFINE BAR 5 OF utilities PROMPT "Tax Utilities" ;
	SKIP FOR TaxUtil="0"
DEFINE BAR 6 OF utilities PROMPT "\-"
DEFINE BAR 7 OF utilities PROMPT "Management Reports" ;
	SKIP FOR MgmtRpts<>"1"
DEFINE BAR 8 OF utilities PROMPT "\-"
DEFINE BAR 9 OF utilities PROMPT "Edit Bank Path" ;
	SKIP FOR BankPath="0"
DEFINE BAR 10 OF utilities PROMPT "Print  STA Check" ;
	SKIP FOR STACheck="0"
DEFINE BAR 11 OF utilities PROMPT "Special Trust Account Transfer"
DEFINE BAR 12 OF utilities PROMPT "Batch Entry" ;
	SKIP FOR !(BatchEntry="1" and file('Batch_AP.dbf'))
ON BAR 1 OF utilities ACTIVATE POPUP databaseut
ON BAR 3 OF utilities ACTIVATE POPUP systemutil
ON BAR 5 OF utilities ACTIVATE POPUP taxutiliti
ON BAR 7 OF utilities ACTIVATE POPUP management
ON SELECTION BAR 9 OF utilities ;
	DO _6fo0inonp ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 10 OF utilities ;
	DO _6fo0inonq ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 11 OF utilities ;
	DO _6fo0inonr ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON BAR 12 OF utilities ACTIVATE POPUP batchentry

DEFINE POPUP databaseut MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF databaseut PROMPT "Reindex Databases"
DEFINE BAR 2 OF databaseut PROMPT "Fix Cross Linked Customers"
DEFINE BAR 3 OF databaseut PROMPT "Fix Memo Files"
ON SELECTION BAR 1 OF databaseut ;
	DO _6fo0inons ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 2 OF databaseut ;
	DO _6fo0inont ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 3 OF databaseut ;
	DO _6fo0inonu ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")

DEFINE POPUP systemutil MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF systemutil PROMPT "Archive Data" ;
	SKIP FOR ArchiveData="0"
DEFINE BAR 2 OF systemutil PROMPT "Bulk Contract Incr/Decr" ;
	SKIP FOR CreateBillRun<>"1AED"
DEFINE BAR 3 OF systemutil PROMPT "Payment Calculator"
DEFINE BAR 4 OF systemutil PROMPT "Recall Archived Invoice" ;
	SKIP FOR RecallArchInv="0"
DEFINE BAR 5 OF systemutil PROMPT "Recall Deleted Invoice" ;
	SKIP FOR RecallDeleInv="0"
DEFINE BAR 6 OF systemutil PROMPT "Reverse Charge-Back Checks" ;
	SKIP FOR ReverseCB="0"
DEFINE BAR 7 OF systemutil PROMPT "Split Invoice" ;
	SKIP FOR SplitInv="0"
DEFINE BAR 8 OF systemutil PROMPT "Untransfer Customer" ;
	SKIP FOR UntranCust="0"
DEFINE BAR 9 OF systemutil PROMPT "\-"
DEFINE BAR 10 OF systemutil PROMPT "Export Data to Telemarketing" ;
	SKIP FOR ! file("custleads\custleads.dbf") or ExportToTele="0"
DEFINE BAR 11 OF systemutil PROMPT "Import Telemarketing Leads" ;
	SKIP FOR ! file("custleads\custleads.dbf") or ImportTeleData="0"
DEFINE BAR 12 OF systemutil PROMPT "\-"
DEFINE BAR 13 OF systemutil PROMPT "Export CB Letter Data"
DEFINE BAR 14 OF systemutil PROMPT "Export Invoice Data" ;
	SKIP FOR ExportInvData="0"
DEFINE BAR 15 OF systemutil PROMPT "Export Special Trust GL Data to Traverse" ;
	SKIP FOR !file('solomon_lookup.dbf')
DEFINE BAR 16 OF systemutil PROMPT "\-"
DEFINE BAR 17 OF systemutil PROMPT "CPI Maintenance" ;
	SKIP FOR CPIMaint="0"
DEFINE BAR 18 OF systemutil PROMPT "\-"
DEFINE BAR 19 OF systemutil PROMPT "Export Lead Data"
DEFINE BAR 20 OF systemutil PROMPT "\-" ;
	SKIP FOR !lCanadaMaster
DEFINE BAR 21 OF systemutil PROMPT "Create Regional Office Billing Adj Trxs" ;
	SKIP FOR !lCanadaMaster
ON SELECTION BAR 1 OF systemutil ;
	DO _6fo0inonv ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 2 OF systemutil ;
	DO _6fo0inonw ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 3 OF systemutil ;
	DO _6fo0inonx ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 4 OF systemutil ;
	DO _6fo0inony ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 5 OF systemutil ;
	DO _6fo0inonz ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 6 OF systemutil ;
	DO _6fo0inoo0 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 7 OF systemutil ;
	DO _6fo0inoo1 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 8 OF systemutil ;
	DO _6fo0inoo2 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 10 OF systemutil ;
	DO _6fo0inoo3 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 11 OF systemutil ;
	DO _6fo0inoo4 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 13 OF systemutil ;
	DO _6fo0inoo5 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 14 OF systemutil ;
	DO _6fo0inoo6 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 15 OF systemutil ;
	DO _6fo0inoo7 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 17 OF systemutil ;
	DO _6fo0inoo8 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 19 OF systemutil ;
	DO _6fo0inoo9 ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 21 OF systemutil ;
	DO _6fo0inooa ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")

DEFINE POPUP taxutiliti MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF taxutiliti PROMPT "Print Tax Table"
DEFINE BAR 2 OF taxutiliti PROMPT "Update Tax Table" ;
	SKIP FOR ! "E" $ TaxUtil or ! "A" $ TaxUtil
ON SELECTION BAR 1 OF taxutiliti ;
	DO _6fo0inoob ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 2 OF taxutiliti ;
	DO _6fo0inooc ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")

DEFINE POPUP management MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF management PROMPT "Business Analysis Report" ;
	SKIP FOR 1=1
DEFINE BAR 2 OF management PROMPT "Income / Expense and Perf. Analysis" ;
	SKIP FOR 1=1
DEFINE BAR 3 OF management PROMPT "Active Franchisees Report"
DEFINE BAR 4 OF management PROMPT "Cease to Do Business Report"
DEFINE BAR 5 OF management PROMPT "Consolidated Spreadsheet"
DEFINE BAR 6 OF management PROMPT "Consolidated Franchisee Revenue"
ON SELECTION BAR 1 OF management do form businessanalysis
ON SELECTION BAR 2 OF management do form incomeexpense
ON SELECTION BAR 3 OF management do form activefranchisee
ON SELECTION BAR 4 OF management do form ceasetodobusiness
ON SELECTION BAR 5 OF management do form consolidatedspreadsheet
ON SELECTION BAR 6 OF management do form consolidatedfranrevenue

DEFINE POPUP batchentry MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF batchentry PROMPT "Batch Entry"
DEFINE BAR 2 OF batchentry PROMPT "Batch Report"
DEFINE BAR 3 OF batchentry PROMPT "Batch Post"
DEFINE BAR 4 OF batchentry PROMPT "\-"
DEFINE BAR 5 OF batchentry PROMPT "Import Vendor Summary Spreadsheet"
ON SELECTION BAR 1 OF batchentry ;
	DO _6fo0inood ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 2 OF batchentry ;
	DO _6fo0inooe ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 3 OF batchentry ;
	DO _6fo0inoof ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")
ON SELECTION BAR 5 OF batchentry ;
	DO _6fo0inoog ;
	IN LOCFILE("FRACCTREPORTS_MASTER\MENUS\MENU1" ,"MPX;MPR|FXP;PRG" ,"WHERE is MENU1?")


*       *********************************************************
*       *                                                         
*       *                 Cleanup Code & Procedures               
*       *                                                         
*       *********************************************************
*

READ EVENTS

*       *********************************************************
*       *                                                         
*       * _6FO0INOKT  ON SELECTION BAR 1 OF POPUP file            
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:    5          
*       * Called By:  ON SELECTION BAR 1 OF POPUP file            
*       * Prompt:     Select Data Location                        
*       * Snippet:    1                                           
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inokt
clos all && KMC 06/25/2004
do form RegionSelect  && KMC 12/02/2005

*!*	cDataLoc=GetDIR(cDataLoc,"Select Data Location")
*!*	lDataPathOk=.F.
*!*	IF LEN(TRIM(cDataLoc))>0
*!*		SET PATH TO &cDataLoc
*!*		if !file ("jkcusfil.dbf")
*!*			cCompNo=""
*!*			cOfficeName=""
*!*			messagebox("Location Invalid, Select another location.",32," 	Invalid Data Location")
*!*			_screen.caption="Franchisee Accounting - No Region Selected"
*!*			lDataPathOK=.F.
*!*		else
*!*			*--> KMC 04/28/2003 Store the last used data path (used as the default path when app is first run).
*!*			create table LastDataPath ;
*!*				(curPath C(100))
*!*			use LastDataPath
*!*			curPath=cDataLoc
*!*			insert into LastDataPath from memvar	
*!*			sele LastDataPath
*!*			use
*!*			*-->
*!*		
*!*			use jkcmpfil in 0
*!*			sele jkcmpfil
*!*			locate for control_no=1
*!*			if found()
*!*				cCompNo=Company_no
*!*				cOfficeName=alltrim(dsp_name)
*!*				if file(cDataLoc+"CanadaMaster") && Canada Master but NOT Toronto
*!*					lCanadaMaster=.T.
*!*				else
*!*					lCanadaMaster=.F.
*!*				endif		
*!*				_screen.caption=cCompNo+" "+cOfficeName+" - "+vfpprinter
*!*				lDataPathOk=.T.
*!*				do ProcessAppUpdates  && KMC 01/13/2005
*!*			else
*!*				cCompNo=""
*!*				cOfficeName=""
*!*				messagebox("Cannot locate valid Company record.",48,"  Invalid Company Record")
*!*				lDataPathOK=.F.
*!*			endif	
*!*	    	use
*!*		endif	
*!*	else
*!*		cCompNo=""
*!*		cOfficeName=""
*!*		messagebox ("No data path selected.",32,"  Invalid Data Path")
*!*		_screen.caption="Franchisee Accounting - No Region Selected"
*!*		lDataPathOK=.F.
*!*	ENDIF

*!*	clos all && KMC 06/25/2004



*       *********************************************************
*       *                                                         
*       * _6FO0INOKU  ON SELECTION BAR 2 OF POPUP file            
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:    6          
*       * Called By:  ON SELECTION BAR 2 OF POPUP file            
*       * Prompt:     Select Printer                              
*       * Snippet:    2                                           
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inoku
SYS(1037)
vfpprinter = SET("printer",3) && Sets VFP default printer to the user selected printer.
_screen.caption=cCompNo+" "+cOfficeName+" - "+vfpprinter


*       *********************************************************
*       *                                                         
*       * _6FO0INOKV  ON SELECTION BAR 3 OF POPUP file            
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:    7          
*       * Called By:  ON SELECTION BAR 3 OF POPUP file            
*       * Prompt:     Exit                                        
*       * Snippet:    3                                           
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inokv
*CLEA EVENTS
*CLOS ALL
*CLEA ALL

*--> KMC 04/28/2003 Store the last used data path (used as the default path when app is first run).
create table LastDataPath ;
	(curPath C(100), ;
	sysPath C(100), ;
	sysID I)
use LastDataPath
curPath=cDataLoc
sysPath=cSystemPath	&& KMC 06/09/2014
sysID=nSystemID		&& KMC 06/09/2014

insert into LastDataPath from memvar	
sele LastDataPath
use
*-->

QUIT




*       *********************************************************
*       *                                                         
*       * _6FO0INOKW  ON SELECTION BAR 1 OF POPUP customers       
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   15          
*       * Called By:  ON SELECTION BAR 1 OF POPUP customers       
*       * Prompt:     Customer File Maintenance                   
*       * Snippet:    4                                           
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inokw
*do form customerscreen
PUBLIC oForm1
*if !file('NewCustFormTest')
	DO FORM customerfileinfo name oForm1
*else
*	DO FORM customerfileinfo_inwork_suspension_option name oForm1
*endif	


*       *********************************************************
*       *                                                         
*       * _6FO0INOKX  ON SELECTION BAR 2 OF POPUP customers       
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   16          
*       * Called By:  ON SELECTION BAR 2 OF POPUP customers       
*       * Prompt:     Customer Transaction Maintenance            
*       * Snippet:    5                                           
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inokx
CLOSE TABLE ALL
*USE jkctlfil INDEX jkctlfil IN 0 ALIAS ctl
USE jkctlfil ORDER key IN 0 ALIAS ctl
SELE ctl
IF !SEEK(PADL(RIGHT(cCompNo,1),3))
	MESSAGEBOX("Cannot find Bill Month/Year in jkctlfil.  Notify MIS Dept.",48,"Alert")
	CLOSE TABLE ALL	
	RETURN
ENDIF

tdate = CTOD(ALLTRIM(STR(ctl.fn_LsMon)) +'/01/'+ALLTRIM(STR(ctl.fn_LsYear)))
tmonth = CMONTH(tdate)

*USE jkinvfil INDEX jkinvfil IN 0 ALIAS invrec
USE jkinvfil ORDER key IN 0 ALIAS invrec
SELE invrec
SET FILTER TO bill_mon = ctl.fn_LsMon AND bill_year = ctl.fn_LsYear
GO TOP
IF EOF()
MESSAGEBOX("The Bill Run has not been created for "+tmonth+' '+ALLTRIM(STR(ctl.fn_LsYear))+'.'+ CHR(13) ;
		+"You must create the Bill Run before you can create additional transactions for this period.",48,"Alert")
	CLOSE TABLE ALL	
	RETURN
ENDIF
PUBLIC oForm1

if "$" $ cDataLoc
	DO FORM custtraninfo_toronto NAME oForm1 WITH "FromMenu"
else
	DO FORM custtraninfo NAME oForm1 WITH "FromMenu"
endif


*       *********************************************************
*       *                                                         
*       * _6FO0INOKY  ON SELECTION BAR 4 OF POPUP customers       
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   18          
*       * Called By:  ON SELECTION BAR 4 OF POPUP customers       
*       * Prompt:     Create Monthly Customer Transactions        
*       * Snippet:    6                                           
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inoky
DO FORM monthlycusttran


*       *********************************************************
*       *                                                         
*       * _6FO0INOKZ  ON SELECTION BAR 5 OF POPUP customers       
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   19          
*       * Called By:  ON SELECTION BAR 5 OF POPUP customers       
*       * Prompt:     Delete Monthly Customer Transactions        
*       * Snippet:    7                                           
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inokz
DO FORM deletemonthlycusttran


*       *********************************************************
*       *                                                         
*       * _6FO0INOL0  ON SELECTION BAR 7 OF POPUP customers       
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   21          
*       * Called By:  ON SELECTION BAR 7 OF POPUP customers       
*       * Prompt:     Consolidated Billing                        
*       * Snippet:    8                                           
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inol0
Do Form ConsolBill


*       *********************************************************
*       *                                                         
*       * _6FO0INOL1  ON SELECTION BAR 8 OF POPUP customers       
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   22          
*       * Called By:  ON SELECTION BAR 8 OF POPUP customers       
*       * Prompt:     Add Invoice to Existing Consolidated Bill   
*       * Snippet:    9                                           
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inol1
do form consolbill_addinvoice


*       *********************************************************
*       *                                                         
*       * _6FO0INOL2  ON SELECTION BAR 10 OF POPUP customers      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   24          
*       * Called By:  ON SELECTION BAR 10 OF POPUP customers      
*       * Prompt:     Invoices                                    
*       * Snippet:    10                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inol2
DO FORM selectinvtype



*       *********************************************************
*       *                                                         
*       * _6FO0INOL3  ON SELECTION BAR 13 OF POPUP customers      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   31          
*       * Called By:  ON SELECTION BAR 13 OF POPUP customers      
*       * Prompt:     Create Mail Merge File                      
*       * Snippet:    11                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inol3
Do Form CustMailMerge


*       *********************************************************
*       *                                                         
*       * _6FO0INOL4  ON SELECTION BAR 14 OF POPUP customers      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   32          
*       * Called By:  ON SELECTION BAR 14 OF POPUP customers      
*       * Prompt:     Fax-A-Comment - under construction          
*       * Snippet:    12                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inol4
ON ERROR DO NoWinfax

WAIT WIND "Please Wait!  Checking Winfax Software..." NOWAIT
PUBLIC goterr

goterr = .F.

oFax = CREATEOBJECT("WinFax.SDKSend")

IF goterr = .F.
	DO FORM faxacomment
ENDIF

PROC NoWinfax
	goterr = .T.
	WAIT CLEAR
	ON ERROR
	MESSAGEBOX("Fax-A-Comment requires Winfax Pro."+CHR(13)+;
	"Install Winfax Pro Software and try again.", 48," Fax-A-Comment Alert")
RETURN



*       *********************************************************
*       *                                                         
*       * _6FO0INOL5  ON SELECTION BAR 15 OF POPUP customers      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   33          
*       * Called By:  ON SELECTION BAR 15 OF POPUP customers      
*       * Prompt:     Print Inspection Forms                      
*       * Snippet:    13                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inol5
do form inspform


*       *********************************************************
*       *                                                         
*       * _6FO0INOL6  ON SELECTION BAR 16 OF POPUP customers      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   34          
*       * Called By:  ON SELECTION BAR 16 OF POPUP customers      
*       * Prompt:     Print  Labels                               
*       * Snippet:    14                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inol6
DO FORM custlabels


*       *********************************************************
*       *                                                         
*       * _6FO0INOL7  ON SELECTION BAR 1 OF POPUP pastdues        
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   27          
*       * Called By:  ON SELECTION BAR 1 OF POPUP pastdues        
*       * Prompt:     Past Due Notices                            
*       * Snippet:    15                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inol7
DO FORM print_past_due



*       *********************************************************
*       *                                                         
*       * _6FO0INOL8  ON SELECTION BAR 2 OF POPUP pastdues        
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   28          
*       * Called By:  ON SELECTION BAR 2 OF POPUP pastdues        
*       * Prompt:     Past Due Report                             
*       * Snippet:    16                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inol8
DO FORM print_pd_report



*       *********************************************************
*       *                                                         
*       * _6FO0INOL9  ON SELECTION BAR 1 OF POPUP franchisee      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   37          
*       * Called By:  ON SELECTION BAR 1 OF POPUP franchisee      
*       * Prompt:     Franchisee File Maintenenance               
*       * Snippet:    17                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inol9
PUBLIC oForm1
DO FORM franchiseefileinfo name oForm1


*       *********************************************************
*       *                                                         
*       * _6FO0INOLA  ON SELECTION BAR 2 OF POPUP franchisee      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   38          
*       * Called By:  ON SELECTION BAR 2 OF POPUP franchisee      
*       * Prompt:     Franchisee Transaction File Maintenance     
*       * Snippet:    18                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inola
PUBLIC oForm1
if "$" $ cDataLoc
	DO FORM frantraninfo_Toronto NAME oForm1
else
	DO FORM frantraninfo NAME oForm1
endif



*       *********************************************************
*       *                                                         
*       * _6FO0INOLB  ON SELECTION BAR 3 OF POPUP franchisee      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   39          
*       * Called By:  ON SELECTION BAR 3 OF POPUP franchisee      
*       * Prompt:     Lease File Maintenance                      
*       * Snippet:    19                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inolb
if "$" $ cDataLoc
	DO FORM leasefileinfo_toronto
else
	DO FORM leasefileinfo
endif	


*       *********************************************************
*       *                                                         
*       * _6FO0INOLC  ON SELECTION BAR 4 OF POPUP franchisee      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   40          
*       * Called By:  ON SELECTION BAR 4 OF POPUP franchisee      
*       * Prompt:     Lease Transfer                              
*       * Snippet:    20                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inolc
do form transferlease


*       *********************************************************
*       *                                                         
*       * _6FO0INOLD  ON SELECTION BAR 5 OF POPUP franchisee      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   41          
*       * Called By:  ON SELECTION BAR 5 OF POPUP franchisee      
*       * Prompt:     Obligations                                 
*       * Snippet:    21                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inold
Do Form Obligations



*       *********************************************************
*       *                                                         
*       * _6FO0INOLE  ON SELECTION BAR 15 OF POPUP franchisee     
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   98          
*       * Called By:  ON SELECTION BAR 15 OF POPUP franchisee     
*       * Prompt:     Create Mail Merge File                      
*       * Snippet:    22                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inole
do form FranMailMerge


*       *********************************************************
*       *                                                         
*       * _6FO0INOLF  ON SELECTION BAR 16 OF POPUP franchisee     
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   99          
*       * Called By:  ON SELECTION BAR 16 OF POPUP franchisee     
*       * Prompt:     Print Labels                                
*       * Snippet:    23                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inolf
DO FORM franlabels


*       *********************************************************
*       *                                                         
*       * _6FO0INOLG  ON SELECTION BAR 1 OF POPUP chargeback      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   45          
*       * Called By:  ON SELECTION BAR 1 OF POPUP chargeback      
*       * Prompt:     Weekly - Poss CB/TAR Report                 
*       * Snippet:    24                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inolg
do form CbPay with "WeeklyReport"



*       *********************************************************
*       *                                                         
*       * _6FO0INOLH  ON SELECTION BAR 2 OF POPUP chargeback      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   46          
*       * Called By:  ON SELECTION BAR 2 OF POPUP chargeback      
*       * Prompt:     Weekly - CB/TAR Checks                      
*       * Snippet:    25                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inolh
use data_loc in 0
sele data_loc
if cCompNo="NAT999" or cCompNo="NAT991"
	loca for company_no="NAT000"
else
	loca for company_no=cCompNo
endif
*--> Don't call form if we cannot locate bank information.
if found()
	use
	Do form CbPAy with "WeeklyChecks"
else
	use
	messagebox("Cannot locate Bank Info.",48,"  No Bank Info Record")
endif




*       *********************************************************
*       *                                                         
*       * _6FO0INOLI  ON SELECTION BAR 3 OF POPUP chargeback      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   47          
*       * Called By:  ON SELECTION BAR 3 OF POPUP chargeback      
*       * Prompt:     Monthly - Poss CB/TAR Report                
*       * Snippet:    26                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inoli
x=messagebox("Do not continue until all report corrections have been made"+chr(13)+ ;
"and final Franchise reports and checks have been printed." + CHR(13)+CHR(13)+ ;
"NO corrections can be entered that affect a Franchisee's"+chr(13)+ ;
"report AFTER this report has been run." +CHR(13)+CHR(13)+ ;
"Do you wish to procede? (Press 'No' if you're not sure).",276,+REPLICATE(" ",30)+"System Alert - WARNING")
if x=6	
	Do form CbPay with "MonthlyReport"
else
	return
endif	
	


*       *********************************************************
*       *                                                         
*       * _6FO0INOLJ  ON SELECTION BAR 4 OF POPUP chargeback      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   48          
*       * Called By:  ON SELECTION BAR 4 OF POPUP chargeback      
*       * Prompt:     Monthly - CB/TAR Checks                     
*       * Snippet:    27                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inolj
use data_loc in 0
sele data_loc
if cCompNo="NAT999" or cCompNo="NAT991"
	loca for company_no="NAT000"
else
	loca for company_no=cCompNo
endif
*--> Don't call form if we cannot locate bank information.
if found()
	use
	Do form CbPay with "MonthlyChecks"
else
	use
	messagebox("Cannot locate Bank Info.",48,"  No Bank Info Record")
endif




*       *********************************************************
*       *                                                         
*       * _6FO0INOLK  ON SELECTION BAR 5 OF POPUP chargeback      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   49          
*       * Called By:  ON SELECTION BAR 5 OF POPUP chargeback      
*       * Prompt:     CB/TAR Check Register                       
*       * Snippet:    28                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inolk
DO Form CBTarRegister


*       *********************************************************
*       *                                                         
*       * _6FO0INOLL  ON SELECTION BAR 7 OF POPUP chargeback      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   51          
*       * Called By:  ON SELECTION BAR 7 OF POPUP chargeback      
*       * Prompt:     Possible CB Report                          
*       * Snippet:    29                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inoll
sele count(dlr_code) as FranCnt from jkdlrfil where CB<>"Y" and status="Y" into cursor tmpOut
sele tmpOut
if FranCnt>0
	x=messagebox("There are "+alltrim(str(FranCnt))+" Franchisee's that are flagged to NOT Charge Back."+chr(13)+ ;
			   "Would you like to see a list of these Franchisee's?",68," System Alert")	
	if x = 6
		sele dlr_code, dlr_name, date_sign from jkdlrfil where CB<>"Y" and status="Y" order by dlr_code into cursor tmpOut
		RegionName=cOfficeName
		rptTitle = "Franchisee's Flagged to NOT Charge Back"
		repo form NoCBList preview
	endif
endif
sele tmpOut
use
sele jkdlrfil
use
DO form CBProcess with "PossCBRpt"



*       *********************************************************
*       *                                                         
*       * _6FO0INOLM  ON SELECTION BAR 8 OF POPUP chargeback      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   52          
*       * Called By:  ON SELECTION BAR 8 OF POPUP chargeback      
*       * Prompt:     Perform CB Procedure                        
*       * Snippet:    30                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inolm
Do form CBProcess with "PerformCB"


*       *********************************************************
*       *                                                         
*       * _6FO0INOLN  ON SELECTION BAR 9 OF POPUP chargeback      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   53          
*       * Called By:  ON SELECTION BAR 9 OF POPUP chargeback      
*       * Prompt:     Final CB Report                             
*       * Snippet:    31                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inoln
Do form FinalCBRpt


*       *********************************************************
*       *                                                         
*       * _6FO0INOLO  ON SELECTION BAR 11 OF POPUP chargeback     
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   55          
*       * Called By:  ON SELECTION BAR 11 OF POPUP chargeback     
*       * Prompt:     CB History Report                           
*       * Snippet:    32                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inolo
do form cbhistory


*       *********************************************************
*       *                                                         
*       * _6FO0INOLP  ON SELECTION BAR 12 OF POPUP chargeback     
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   56          
*       * Called By:  ON SELECTION BAR 12 OF POPUP chargeback     
*       * Prompt:     ND History Report                           
*       * Snippet:    33                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inolp
do form ndhistory


*       *********************************************************
*       *                                                         
*       * _6FO0INOLQ  ON SELECTION BAR 13 OF POPUP chargeback     
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   57          
*       * Called By:  ON SELECTION BAR 13 OF POPUP chargeback     
*       * Prompt:     Print CB Letters                            
*       * Snippet:    34                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inolq
Do form CbLetter


*       *********************************************************
*       *                                                         
*       * _6FO0INOLR  ON SELECTION BAR 1 OF POPUP _0s60ii7f5      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   61          
*       * Called By:  ON SELECTION BAR 1 OF POPUP _0s60ii7f5      
*       * Prompt:     Create/Print Franchisee Report              
*       * Snippet:    35                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inolr
DO FORM PrintFranReport WITH 'N'


*       *********************************************************
*       *                                                         
*       * _6FO0INOLS  ON SELECTION BAR 2 OF POPUP _0s60ii7f5      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   62          
*       * Called By:  ON SELECTION BAR 2 OF POPUP _0s60ii7f5      
*       * Prompt:     Re-Print Franchisee Report                  
*       * Snippet:    36                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inols
DO FORM PrintFranReport WITH 'R'


*       *********************************************************
*       *                                                         
*       * _6FO0INOLT  ON SELECTION BAR 3 OF POPUP _0s60ii7f5      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   63          
*       * Called By:  ON SELECTION BAR 3 OF POPUP _0s60ii7f5      
*       * Prompt:     Print Franchisee Spreadsheet                
*       * Snippet:    37                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inolt
*IF file('jkcusfil.dbf')
	DO FORM print_spreadsheet
*ELSE
*  messagebox(" Select a valid path to data.")
*ENDIF



*       *********************************************************
*       *                                                         
*       * _6FO0INOLU  ON SELECTION BAR 5 OF POPUP _0s60ii7f5      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   66          
*       * Called By:  ON SELECTION BAR 5 OF POPUP _0s60ii7f5      
*       * Prompt:     Print Due Fran Checks                       
*       * Snippet:    38                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inolu
use data_loc in 0
sele data_loc
if cCompNo="NAT999" or cCompNo="NAT991"
	loca for company_no="NAT000"
else
	loca for company_no=cCompNo
endif
*--> Don't call form if we cannot locate bank information.
if found()
	use
	DO FORM "PrintDueFranChecks"
else
	use
	messagebox("Cannot locate Bank Info.",48,"  No Bank Info Record")
endif


*       *********************************************************
*       *                                                         
*       * _6FO0INOLV  ON SELECTION BAR 6 OF POPUP _0s60ii7f5      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   67          
*       * Called By:  ON SELECTION BAR 6 OF POPUP _0s60ii7f5      
*       * Prompt:     Print Due Fran Check Register               
*       * Snippet:    39                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inolv
DO FORM "print franchisee check register"


*       *********************************************************
*       *                                                         
*       * _6FO0INOLW  ON SELECTION BAR 7 OF POPUP _0s60ii7f5      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   68          
*       * Called By:  ON SELECTION BAR 7 OF POPUP _0s60ii7f5      
*       * Prompt:     Print Franchisee ACH Report                 
*       * Snippet:    40                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inolw
do form "ACHReport"


*       *********************************************************
*       *                                                         
*       * _6FO0INOLX  ON SELECTION BAR 9 OF POPUP _0s60ii7f5      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   71          
*       * Called By:  ON SELECTION BAR 9 OF POPUP _0s60ii7f5      
*       * Prompt:     Print Corporate Dues Report                 
*       * Snippet:    41                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inolx
do form CorporateDuesreport


*       *********************************************************
*       *                                                         
*       * _6FO0INOLY  ON SELECTION BAR 10 OF POPUP _0s60ii7f5     
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   72          
*       * Called By:  ON SELECTION BAR 10 OF POPUP _0s60ii7f5     
*       * Prompt:     Print Workers Comp & Liability Report       
*       * Snippet:    42                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inoly
do form liaworkcompreport


*       *********************************************************
*       *                                                         
*       * _6FO0INOLZ  ON SELECTION BAR 12 OF POPUP _0s60ii7f5     
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   75          
*       * Called By:  ON SELECTION BAR 12 OF POPUP _0s60ii7f5     
*       * Prompt:     Accounting Fee Rebate Maintenance           
*       * Snippet:    43                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inolz
do form AcctFeeRebate


*       *********************************************************
*       *                                                         
*       * _6FO0INOM0  ON SELECTION BAR 13 OF POPUP _0s60ii7f5     
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   76          
*       * Called By:  ON SELECTION BAR 13 OF POPUP _0s60ii7f5     
*       * Prompt:     Print Accounting Fee Rebate Report          
*       * Snippet:    44                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inom0
DO FORM accountrebatereport


*       *********************************************************
*       *                                                         
*       * _6FO0INOM1  ON SELECTION BAR 14 OF POPUP _0s60ii7f5     
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   77          
*       * Called By:  ON SELECTION BAR 14 OF POPUP _0s60ii7f5     
*       * Prompt:     Print Accounting Fee Rebate Check           
*       * Snippet:    45                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inom1
*--> 01/15/2004 KMC
*Do form AcctFeeRebateCheck
use data_loc in 0
sele data_loc
loca for company_no="AcctFee"
*--> Don't call form if we cannot locate bank information.
if found()
	use
	Do form AcctFeeRebateCheck
else
	*--> Only Corporate uses a seperate account for Acct Fee Rebate Checks,
	*--> Masters would use the active regions Special Trust Acct.
	*--> If the "AcctFee" record is not found, drop back to the record
	*--> for the active region.
	loca for company_no=cCompNo
	if found()
		use
		Do form AcctFeeRebateCheck
	else
		use
		messagebox("Cannot locate Bank Info.",48,"  No Bank Info Record")
	endif
endif
*-->






*       *********************************************************
*       *                                                         
*       * _6FO0INOM2  ON SELECTION BAR 1 OF POPUP miscreport      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   81          
*       * Called By:  ON SELECTION BAR 1 OF POPUP miscreport      
*       * Prompt:     Franchisee Tabs                             
*       * Snippet:    46                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inom2
Do form PrintTabs


*       *********************************************************
*       *                                                         
*       * _6FO0INOM3  ON SELECTION BAR 2 OF POPUP miscreport      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   82          
*       * Called By:  ON SELECTION BAR 2 OF POPUP miscreport      
*       * Prompt:     Franchisee First  Reached a Specified Billing Amount 
*       * Snippet:    47                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inom3
do form FranFirstAtSomeBillLevel


*       *********************************************************
*       *                                                         
*       * _6FO0INOM4  ON SELECTION BAR 3 OF POPUP miscreport      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   83          
*       * Called By:  ON SELECTION BAR 3 OF POPUP miscreport      
*       * Prompt:     Franchisee Revenue Report                   
*       * Snippet:    48                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inom4
do form FranRevenue


*       *********************************************************
*       *                                                         
*       * _6FO0INOM5  ON SELECTION BAR 4 OF POPUP miscreport      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   84          
*       * Called By:  ON SELECTION BAR 4 OF POPUP miscreport      
*       * Prompt:     Franchisee Yearly Summary                   
*       * Snippet:    49                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inom5
DO Form FranYTDReport


*       *********************************************************
*       *                                                         
*       * _6FO0INOM6  ON SELECTION BAR 5 OF POPUP miscreport      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   85          
*       * Called By:  ON SELECTION BAR 5 OF POPUP miscreport      
*       * Prompt:     Negative Due Report                         
*       * Snippet:    50                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inom6
do form negativedue


*       *********************************************************
*       *                                                         
*       * _6FO0INOM7  ON SELECTION BAR 6 OF POPUP miscreport      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   86          
*       * Called By:  ON SELECTION BAR 6 OF POPUP miscreport      
*       * Prompt:     Non 3 % Collected Report                    
*       * Snippet:    51                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inom7
do form non3collected


*       *********************************************************
*       *                                                         
*       * _6FO0INOM8  ON SELECTION BAR 7 OF POPUP miscreport      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   87          
*       * Called By:  ON SELECTION BAR 7 OF POPUP miscreport      
*       * Prompt:     Pager Recap Report                          
*       * Snippet:    52                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inom8
Do form PagerRecap


*       *********************************************************
*       *                                                         
*       * _6FO0INOM9  ON SELECTION BAR 8 OF POPUP miscreport      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   88          
*       * Called By:  ON SELECTION BAR 8 OF POPUP miscreport      
*       * Prompt:     Supply Recap Report                         
*       * Snippet:    53                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inom9
do form supplyrecap


*       *********************************************************
*       *                                                         
*       * _6FO0INOMA  ON SELECTION BAR 1 OF POPUP nationalac      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   92          
*       * Called By:  ON SELECTION BAR 1 OF POPUP nationalac      
*       * Prompt:     Bulk Invoice Payment                        
*       * Snippet:    54                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inoma
Do form BulkInvPay


*       *********************************************************
*       *                                                         
*       * _6FO0INOMB  ON SELECTION BAR 2 OF POPUP nationalac      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   93          
*       * Called By:  ON SELECTION BAR 2 OF POPUP nationalac      
*       * Prompt:     Possible Payment Report                     
*       * Snippet:    55                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inomb
Do form NatAcctCks with "Report"


*       *********************************************************
*       *                                                         
*       * _6FO0INOMC  ON SELECTION BAR 3 OF POPUP nationalac      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   94          
*       * Called By:  ON SELECTION BAR 3 OF POPUP nationalac      
*       * Prompt:     Print Checks                                
*       * Snippet:    56                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inomc
use data_loc in 0
sele data_loc
if cCompNo="NAT999" or cCompNo="NAT991"
	loca for company_no="NAT000"
else
	loca for company_no=cCompNo
endif
*--> Don't call form if we cannot locate bank information.
if found()
	use
	Do form NatAcctCks with "Checks"
else
	use
	messagebox("Cannot locate Bank Info.",48,"  No Bank Info Record")
endif




*       *********************************************************
*       *                                                         
*       * _6FO0INOMD  ON SELECTION BAR 4 OF POPUP nationalac      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:   95          
*       * Called By:  ON SELECTION BAR 4 OF POPUP nationalac      
*       * Prompt:     Check Register                              
*       * Snippet:    57                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inomd
Do Form NatAcctCkRegister


*       *********************************************************
*       *                                                         
*       * _6FO0INOME  ON SELECTION BAR 1 OF POPUP _1eb0mo9tg      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  104          
*       * Called By:  ON SELECTION BAR 1 OF POPUP _1eb0mo9tg      
*       * Prompt:     Print 1099 Report                           
*       * Snippet:    58                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inome
use data_loc in 0
sele data_loc
if cCompNo="NAT999" or cCompNo="NAT991"
	loca for company_no="NAT000"
else
	loca for company_no=cCompNo
endif

if found()
	use
	do form Fran1099Report
else
	use
	messagebox("Cannot find STA Checkbook Info.",48,"  No CheckBook Info")
endif



*       *********************************************************
*       *                                                         
*       * _6FO0INOMF  ON SELECTION BAR 2 OF POPUP _1eb0mo9tg      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  105          
*       * Called By:  ON SELECTION BAR 2 OF POPUP _1eb0mo9tg      
*       * Prompt:     Print 1099's                                
*       * Snippet:    59                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inomf
Do form Print1099s


*       *********************************************************
*       *                                                         
*       * _6FO0INOMG  ON SELECTION BAR 1 OF POPUP company         
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  108          
*       * Called By:  ON SELECTION BAR 1 OF POPUP company         
*       * Prompt:     Company File Maintenance                    
*       * Snippet:    60                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inomg
*--> KMC 06/26/2009
*if lCanadaMaster
*	DO FORM officefileinfo_CM
*else
*	DO FORM officefileinfo
*endif

Do Case
	Case lCanadaMaster
		DO FORM officefileinfo_CM
	Case lBrazil
		DO FORM officefileinfo_BR
	Otherwise
		DO FORM officefileinfo
EndCase
*-->		
	


*       *********************************************************
*       *                                                         
*       * _6FO0INOMH  ON SELECTION BAR 2 OF POPUP company         
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  109          
*       * Called By:  ON SELECTION BAR 2 OF POPUP company         
*       * Prompt:     Control File Maintenance                    
*       * Snippet:    61                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inomh
DO FORM controlfileinfo


*       *********************************************************
*       *                                                         
*       * _6FO0INOMI  ON SELECTION BAR 3 OF POPUP company         
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  110          
*       * Called By:  ON SELECTION BAR 3 OF POPUP company         
*       * Prompt:     Reset System Parameters (Side1/Side2)       
*       * Snippet:    62                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inomi
do form resetsystemparameters


*       *********************************************************
*       *                                                         
*       * _6FO0INOMJ  ON SELECTION BAR 5 OF POPUP company         
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  113          
*       * Called By:  ON SELECTION BAR 5 OF POPUP company         
*       * Prompt:     Special Trust Check Register Maintenance    
*       * Snippet:    63                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inomj
use data_loc
if cCompNo="NAT999" or cCompNo="NAT991"
	loca for company_no="NAT000"
else
	loca for company_no=cCompNo
endif

*--> Don't call form if we cannot locate bank information.
if found()
	BankPath = ALLTRIM(data_loc.bank_data)
	use
	DO FORM francheckfileinfo with BankPath
else
	use
	messagebox("Cannot locate Bank Info.",48,"  No Bank Info Record")
endif



*       *********************************************************
*       *                                                         
*       * _6FO0INOMK  ON SELECTION BAR 6 OF POPUP company         
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  114          
*       * Called By:  ON SELECTION BAR 6 OF POPUP company         
*       * Prompt:     Bank Information Maintenance                
*       * Snippet:    64                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inomk
*do form bankinfo

USE data_loc IN 0
SELE data_loc
IF cCompNo="NAT991" OR cCompNo="NAT999"
	LOCA FOR company_no="NAT000"
ELSE
	LOCA FOR company_no=cCompNo
ENDIF

IF FOUND()
	DO FORM bankinfo
ELSE
	CLOSE TABLE ALL
	MESSAGEBOX("No Bank Data Available!",48," Alert")
	RETURN
ENDIF



*       *********************************************************
*       *                                                         
*       * _6FO0INOML  ON SELECTION BAR 11 OF POPUP company        
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  133          
*       * Called By:  ON SELECTION BAR 11 OF POPUP company        
*       * Prompt:     Print Accounting Fee Check                  
*       * Snippet:    65                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inoml
use data_loc in 0
sele data_loc
if cCompNo="NAT999" or cCompNo="NAT991"
	loca for company_no="NAT000"
else
	loca for company_no=cCompNo
endif
*--> Don't call form if we cannot locate bank information.
if found()
	use
	do form adv_afr_bp_ck with "AcctFeeReb"
else
	use
	messagebox("Cannot locate Bank Info.",48,"  No Bank Info Record")
endif






*       *********************************************************
*       *                                                         
*       * _6FO0INOMM  ON SELECTION BAR 12 OF POPUP company        
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  134          
*       * Called By:  ON SELECTION BAR 12 OF POPUP company        
*       * Prompt:     Print Advertising Fee Check                 
*       * Snippet:    66                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inomm
use data_loc in 0
sele data_loc
if cCompNo="NAT999" or cCompNo="NAT991"
	loca for company_no="NAT000"
else
	loca for company_no=cCompNo
endif
*--> Don't call form if we cannot locate bank information.
if found()
	use
	do form adv_afr_bp_ck with "AdvFee"
else
	use
	messagebox("Cannot locate Bank Info.",48,"  No Bank Info Record")
endif




*       *********************************************************
*       *                                                         
*       * _6FO0INOMN  ON SELECTION BAR 13 OF POPUP company        
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  135          
*       * Called By:  ON SELECTION BAR 13 OF POPUP company        
*       * Prompt:     Print BP & Bond Check                       
*       * Snippet:    67                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inomn
use data_loc in 0
sele data_loc
if cCompNo="NAT999" or cCompNo="NAT991"
	loca for company_no="NAT000"
else
	loca for company_no=cCompNo
endif
*--> Don't call form if we cannot locate bank information.
if found()
	use
	do form adv_afr_bp_ck with "BPBond"
else
	use
	messagebox("Cannot locate Bank Info.",48,"  No Bank Info Record")
endif






*       *********************************************************
*       *                                                         
*       * _6FO0INOMO  ON SELECTION BAR 15 OF POPUP company        
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  138          
*       * Called By:  ON SELECTION BAR 15 OF POPUP company        
*       * Prompt:     Print Tax Liability Report                  
*       * Snippet:    68                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inomo
DO FORM taxliability



*       *********************************************************
*       *                                                         
*       * _6FO0INOMP  ON SELECTION BAR 17 OF POPUP company        
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  141          
*       * Called By:  ON SELECTION BAR 17 OF POPUP company        
*       * Prompt:     DRO Report                                  
*       * Snippet:    69                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inomp
do form dro_report


*       *********************************************************
*       *                                                         
*       * _6FO0INOMQ  ON SELECTION BAR 18 OF POPUP company        
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  142          
*       * Called By:  ON SELECTION BAR 18 OF POPUP company        
*       * Prompt:     Finders Fees Report                         
*       * Snippet:    70                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inomq
do form ffReport


*       *********************************************************
*       *                                                         
*       * _6FO0INOMR  ON SELECTION BAR 19 OF POPUP company        
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  143          
*       * Called By:  ON SELECTION BAR 19 OF POPUP company        
*       * Prompt:     Notes Receivable Report                     
*       * Snippet:    71                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inomr
Do form NotesReceivableReport


*       *********************************************************
*       *                                                         
*       * _6FO0INOMS  ON SELECTION BAR 20 OF POPUP company        
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  144          
*       * Called By:  ON SELECTION BAR 20 OF POPUP company        
*       * Prompt:     Obligations Report                          
*       * Snippet:    72                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inoms
Do Form ObligationsReport


*       *********************************************************
*       *                                                         
*       * _6FO0INOMT  ON SELECTION BAR 21 OF POPUP company        
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  145          
*       * Called By:  ON SELECTION BAR 21 OF POPUP company        
*       * Prompt:     Projected Revenue (FF & Lease)              
*       * Snippet:    73                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inomt
do form ProjectedRevenue


*       *********************************************************
*       *                                                         
*       * _6FO0INOMU  ON SELECTION BAR 25 OF POPUP company        
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  157          
*       * Called By:  ON SELECTION BAR 25 OF POPUP company        
*       * Prompt:     Master Franchise Report                     
*       * Snippet:    74                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inomu
do form MasterFranReport


*       *********************************************************
*       *                                                         
*       * _6FO0INOMV  ON SELECTION BAR 27 OF POPUP company        
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  160          
*       * Called By:  ON SELECTION BAR 27 OF POPUP company        
*       * Prompt:     End Of Month Posting                        
*       * Snippet:    75                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inomv
DO FORM endofmonthposting


*       *********************************************************
*       *                                                         
*       * _6FO0INOMW  ON SELECTION BAR 1 OF POPUP feescollec      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  119          
*       * Called By:  ON SELECTION BAR 1 OF POPUP feescollec      
*       * Prompt:     Print Fees Collected Possible Payment Report 
*       * Snippet:    76                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inomw
Do form FeesCollCheck with "Report"


*       *********************************************************
*       *                                                         
*       * _6FO0INOMX  ON SELECTION BAR 2 OF POPUP feescollec      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  120          
*       * Called By:  ON SELECTION BAR 2 OF POPUP feescollec      
*       * Prompt:     Print Fees Collected Check                  
*       * Snippet:    77                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inomx
use data_loc in 0
sele data_loc
if cCompNo="NAT999" or cCompNo="NAT991"
	loca for company_no="NAT000"
else
	loca for company_no=cCompNo
endif
*--> Don't call form if we cannot locate bank information.
if found()
	use
	Do form FeesCollCheck with "Checks"
else
	use
	messagebox("Cannot locate Bank Info.",48,"  No Bank Info Record")
endif




*       *********************************************************
*       *                                                         
*       * _6FO0INOMY  ON SELECTION BAR 3 OF POPUP feescollec      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  121          
*       * Called By:  ON SELECTION BAR 3 OF POPUP feescollec      
*       * Prompt:     Print Fees Collected Check Register         
*       * Snippet:    78                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inomy
Do form FeesCollCheck with "Register"


*       *********************************************************
*       *                                                         
*       * _6FO0INOMZ  ON SELECTION BAR 4 OF POPUP feescollec      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  122          
*       * Called By:  ON SELECTION BAR 4 OF POPUP feescollec      
*       * Prompt:     Print Fees Collected Report                 
*       * Snippet:    79                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inomz
Do form FeesCollected


*       *********************************************************
*       *                                                         
*       * _6FO0INON0  ON SELECTION BAR 5 OF POPUP feescollec      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  123          
*       * Called By:  ON SELECTION BAR 5 OF POPUP feescollec      
*       * Prompt:     Record Fees Collected                       
*       * Snippet:    80                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inon0
DO FORM recordfeescollected


*       *********************************************************
*       *                                                         
*       * _6FO0INON1  ON SELECTION BAR 1 OF POPUP negativedu      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  126          
*       * Called By:  ON SELECTION BAR 1 OF POPUP negativedu      
*       * Prompt:     Print ND Possible  Payment Report           
*       * Snippet:    81                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inon1
Do form NegDueChecks with "Report"


*       *********************************************************
*       *                                                         
*       * _6FO0INON2  ON SELECTION BAR 2 OF POPUP negativedu      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  127          
*       * Called By:  ON SELECTION BAR 2 OF POPUP negativedu      
*       * Prompt:     Print ND Collected Check                    
*       * Snippet:    82                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inon2
use data_loc in 0
sele data_loc
if cCompNo="NAT999" or cCompNo="NAT991"
	loca for company_no="NAT000"
else
	loca for company_no=cCompNo
endif
*--> Don't call form if we cannot locate bank information.
if found()
	use
	Do form NegDueChecks with "Checks"
else
	use
	messagebox("Cannot locate Bank Info.",48,"  No Bank Info Record")
endif



*       *********************************************************
*       *                                                         
*       * _6FO0INON3  ON SELECTION BAR 3 OF POPUP negativedu      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  128          
*       * Called By:  ON SELECTION BAR 3 OF POPUP negativedu      
*       * Prompt:     Print ND Check Register                     
*       * Snippet:    83                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inon3
Do form NegDueChecks with "Register"


*       *********************************************************
*       *                                                         
*       * _6FO0INON4  ON SELECTION BAR 4 OF POPUP negativedu      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  129          
*       * Called By:  ON SELECTION BAR 4 OF POPUP negativedu      
*       * Prompt:     Print ND Collected Report                   
*       * Snippet:    84                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inon4
Do form NegDueCollected with "NDCollected"


*       *********************************************************
*       *                                                         
*       * _6FO0INON5  ON SELECTION BAR 5 OF POPUP negativedu      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  130          
*       * Called By:  ON SELECTION BAR 5 OF POPUP negativedu      
*       * Prompt:     Print ND Paid Report                        
*       * Snippet:    85                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inon5
Do form NegDueCollected with "NDPaid"


*       *********************************************************
*       *                                                         
*       * _6FO0INON6  ON SELECTION BAR 1 OF POPUP specialtru      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  150          
*       * Called By:  ON SELECTION BAR 1 OF POPUP specialtru      
*       * Prompt:     Special Trust Recap                         
*       * Snippet:    86                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inon6
DO Form SpecialTrustRecap


*       *********************************************************
*       *                                                         
*       * _6FO0INON7  ON SELECTION BAR 2 OF POPUP specialtru      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  151          
*       * Called By:  ON SELECTION BAR 2 OF POPUP specialtru      
*       * Prompt:     Special Trust Fran Advance Recap            
*       * Snippet:    87                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inon7
Do form SpecialTrustFranAdvRecap


*       *********************************************************
*       *                                                         
*       * _6FO0INON8  ON SELECTION BAR 3 OF POPUP specialtru      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  152          
*       * Called By:  ON SELECTION BAR 3 OF POPUP specialtru      
*       * Prompt:     Special Trust Unrecorded Deposits From AR Log 
*       * Snippet:    88                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inon8
Do form SpecialTrustUnDeposits


*       *********************************************************
*       *                                                         
*       * _6FO0INON9  ON SELECTION BAR 4 OF POPUP specialtru      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  153          
*       * Called By:  ON SELECTION BAR 4 OF POPUP specialtru      
*       * Prompt:     Transfer Advance Data                       
*       * Snippet:    89                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inon9
DO FORM transprd


*       *********************************************************
*       *                                                         
*       * _6FO0INONA  ON SELECTION BAR 5 OF POPUP specialtru      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  154          
*       * Called By:  ON SELECTION BAR 5 OF POPUP specialtru      
*       * Prompt:     Edit Advance File                           
*       * Snippet:    90                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inona
DO FORM advedit


*       *********************************************************
*       *                                                         
*       * _6FO0INONB  ON SELECTION BAR 1 OF POPUP accountsre      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  163          
*       * Called By:  ON SELECTION BAR 1 OF POPUP accountsre      
*       * Prompt:     Cash Receipts Maintenance                   
*       * Snippet:    91                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inonb
DO FORM CASHRECEIPTSINFO


*       *********************************************************
*       *                                                         
*       * _6FO0INONC  ON SELECTION BAR 2 OF POPUP accountsre      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  164          
*       * Called By:  ON SELECTION BAR 2 OF POPUP accountsre      
*       * Prompt:     Other Deposits Maintenance                  
*       * Snippet:    92                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inonc
do form enterotherdeposits


*       *********************************************************
*       *                                                         
*       * _6FO0INOND  ON SELECTION BAR 6 OF POPUP accountsre      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  181          
*       * Called By:  ON SELECTION BAR 6 OF POPUP accountsre      
*       * Prompt:     Monthly Log By Day                          
*       * Snippet:    93                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inond
do form MonthlyLogByDay


*       *********************************************************
*       *                                                         
*       * _6FO0INONE  ON SELECTION BAR 7 OF POPUP accountsre      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  182          
*       * Called By:  ON SELECTION BAR 7 OF POPUP accountsre      
*       * Prompt:     Percent Pd By Day                           
*       * Snippet:    94                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inone
do form percentbyday


*       *********************************************************
*       *                                                         
*       * _6FO0INONF  ON SELECTION BAR 9 OF POPUP accountsre      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  185          
*       * Called By:  ON SELECTION BAR 9 OF POPUP accountsre      
*       * Prompt:     LockBox Import/Post                         
*       * Snippet:    95                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inonf
clos all

FileToRead=getfile('txt')
if len(alltrim(FileToRead))=0
	messagebox("Please select a LockBox file to process.",0," System Alert")
	return
endif

*!*	YrPrefix="20"
*!*	PymntID=""
*!*	xDate={  /  /  }
*!*	xTime=" "
*!*	exitProcess=.F.

*!*	rptDate=date()
*!*	rptTime=time()

use LockBox in 0
use LockBoxPost in 0

use Data_Loc in 0
sele Data_Loc
loca for company_no=cCompNo
if found() and len(alltrim(data_loc.lockbox))=7
	thisLockBox=data_loc.lockbox
	use
else
	messagebox("Unable to locate Regions Lockbox number - Contact IT Dept.",0," System Alert")
	clos all
	return
endif		

Do Form LockBoxPost with FileToRead,thisLockBox

*!*	Do ImportData
*!*	if !exitProcess
*!*		Do ProcessData
*!*		Do PostPayments

*!*		sele * from LockBoxPost ;
*!*			where lBoxDate=xDate and lBoxTime=xTime and postdate=rptDate ;
*!*		into cursor tmpOut

*!*		sele tmpOut
*!*		go top
*!*		if !eof()
*!*			rptHeading="LockBox Report"
*!*			report form LockBoxReport preview

*!*			sele * from LockBoxPost ;
*!*				where lBoxDate=xDate and lBoxTime=xTime and postdate=rptDate ;
*!*			and PostResult<>"Posted" ;	
*!*			into cursor tmpOut

*!*			sele tmpOut
*!*			if !eof()
*!*				rptHeading="LockBox Exception Report"
*!*				repo form LockBoxReport preview
*!*			endif
*!*		else
*!*			messagebox("Nothing to Report.",0," System Alert")
*!*		endif
*!*	endif

*!*	clos all
*!*	return

*!*	PROC ImportData
*!*		wait window "Importing LockBox data..." nowait
*!*		crea cursor tmpLockBox ;
*!*			(recType C(1), ;
*!*			PriorCode C(2), ;
*!*			Dest C(10), ;
*!*			Origin C(10), ;
*!*			CreateDate D, ;
*!*			CreateTime C(4), ;
*!*			RefCode C(10), ;
*!*			ServType C(3), ;
*!*			RecSize C(3), ;
*!*			BlockSize C(4), ;
*!*			FormatCode C(1), ;
*!*			BatchNum C(3), ;
*!*			LockBoxNum C(7), ;
*!*			CreditDate D, ;
*!*			ItemNum C(3), ;
*!*			CheckAmt N(11,2), ;
*!*			RouteNum C(9), ;
*!*			AcctNum C(10), ;
*!*			CheckNum C(8), ;
*!*			OverType C(1), ;
*!*			SeqNum C(2), ;
*!*			LastOverInd C(1), ;
*!*	   	 	CustNo C(6), ;
*!*	   	 	InvNo C(18), ;
*!*			PaidAmt N(10,2), ;	
*!*			TotItems C(4), ;
*!*			TotDollars N(11,2), ;
*!*			RecCount C(6))

*!*		create cursor tmpImport ;
*!*			(Data C(80))
*!*			
*!*		sele tmpImport
*!*		append from (FileToRead) type delimited
*!*		go top

*!*		*--> Check that only one unique lockbox number is contained in the file
*!*		*--> and that the lockbox number is correct for the region.
*!*		sele distinct substr(tmpImport.data,8,7) as lockbox ;
*!*			from tmpImport ;
*!*		where left(tmpImport.data,1)="5" ;
*!*		into cursor tmpVerify

*!*		*wait window "Current Lockbox "+curLockBox+" Import LockBox "+tmpVerify.lockbox

*!*		sele tmpVerify
*!*		do case
*!*			case reccount()>1
*!*				wait clear
*!*				messagebox("Import File has multiple LockBoxes - contact IT Dept.",0," System Alert")
*!*				clos all
*!*				exitProcess=.T.
*!*				return
*!*			case tmpVerify.LockBox<>curLockBox
*!*				wait clear
*!*				messagebox("Incorrect LockBox for this region - process stopped.",0," System Alert")
*!*				clos all
*!*				exitProcess=.T.
*!*				return
*!*		endcase		

*!*		xDate = ctod(substr(tmpImport.Data,26,2)+"/" ;
*!*			+substr(tmpImport.Data,28,2)+"/" ;
*!*			+YrPrefix+substr(tmpImport.Data,24,2))
*!*		xTime = substr(tmpImport.Data,30,4)

*!*		*wait window dtoc(xDate)

*!*		sele LockBox
*!*		loca for CreateDate = xDate and ;
*!*			CreateTime = xTime

*!*		if found()
*!*			wait clear
*!*			messagebox("File Already Imported - will check to see if it has been processed.",0," System Alert")
*!*			return
*!*		endif

*!*		sele tmpImport
*!*		scan
*!*			do case
*!*				case left(Data,1)="1"
*!*					sele tmpLockBox
*!*					append blank
*!*					repla recType with "1"
*!*					repla PriorCode with substr(tmpImport.Data,2,2)
*!*					repla Dest with substr(tmpImport.Data,4,10)
*!*					repla Origin with substr(tmpImport.Data,14,10)
*!*					repla CreateDate with ctod(substr(tmpImport.Data,26,2)+"/" ;
*!*						+substr(tmpImport.Data,28,2)+"/" ;
*!*						+YrPrefix+substr(tmpImport.Data,24,2))
*!*					repla CreateTime with substr(tmpImport.Data,30,4)
*!*				case left(Data,1)="2"
*!*					sele tmpLockBox
*!*					append blank
*!*					repla recType with "2"
*!*					repla Dest with substr(tmpImport.Data,2,10)
*!*					repla Origin with substr(tmpImport.Data,12,10)
*!*					repla RefCode with substr(tmpImport.Data,22,10)
*!*					repla ServType with substr(tmpImport.Data,32,3)
*!*					repla RecSize with substr(tmpImport.Data,35,3)
*!*					repla BlockSize with substr(tmpImport.Data,38,4)
*!*					repla FormatCode with substr(tmpImport.Data,42,1)
*!*				case left(Data,1)="5"
*!*					sele tmpLockBox
*!*					append blank
*!*					repla recType with "5"
*!*					repla BatchNum with substr(tmpImport.Data,2,3)
*!*					repla LockBoxNum with substr(tmpImport.Data,8,7)
*!*					repla CreditDate with ctod(substr(tmpImport.Data,17,2)+"/" ;
*!*						+substr(tmpImport.Data,19,2)+"/" ;
*!*						+YrPrefix+substr(tmpImport.Data,15,2))
*!*					repla Dest with substr(tmpImport.Data,21,10)
*!*					repla Origin with substr(tmpImport.Data,31,10)
*!*				case left(Data,1)="6"
*!*					sele tmpLockBox
*!*					append blank
*!*					repla recType with "6"
*!*					repla BatchNum with substr(tmpImport.Data,2,3)
*!*					repla ItemNum with substr(tmpImport.Data,5,3)
*!*					repla CheckAmt with val(substr(tmpImport.Data,8,8)+"."+substr(tmpImport.Data,16,2))
*!*					repla RouteNum with substr(tmpImport.Data,18,9)
*!*					repla AcctNum with substr(tmpImport.Data,27,10)
*!*					repla CheckNum with substr(tmpImport.Data,37,8)
*!*					repla CustNo with substr(tmpImport.Data,45,6)
*!*					repla InvNo with substr(tmpImport.Data,51,18)
*!*					repla PaidAmt with val(substr(tmpImport.Data,69,7)+"."+substr(tmpImport.Data,76,2))
*!*				case left(Data,1)="4"
*!*					sele tmpLockBox
*!*					append blank
*!*					repla recType with "4"
*!*					repla BatchNum with substr(tmpImport.Data,2,3)
*!*					repla ItemNum with substr(tmpImport.Data,5,3)
*!*					repla OverType with substr(tmpImport.Data,8,1)
*!*					repla SeqNum with substr(tmpImport.Data,9,2)
*!*					repla LastOverInd with substr(tmpImport.Data,11,1)
*!*					repla CustNo with substr(tmpImport.Data,12,6)
*!*					repla InvNo with substr(tmpImport.Data,18,18)
*!*					repla PaidAmt with val(substr(tmpImport.Data,36,7)+"."+substr(tmpImport.Data,43,2))
*!*				case left(Data,1)="7"
*!*					sele tmpLockBox
*!*					append blank
*!*					repla recType with "7"
*!*					repla BatchNum with substr(tmpImport.Data,2,3)
*!*					repla LockBoxNum with substr(tmpImport.Data,8,7)
*!*					repla CreditDate with ctod(substr(tmpImport.Data,17,2)+"/" ;
*!*						+substr(tmpImport.Data,19,2)+"/" ;
*!*						+YrPrefix+substr(tmpImport.Data,15,2))
*!*					repla TotItems with substr(tmpImport.Data,21,3)
*!*					repla TotDollars with val(substr(tmpImport.Data,24,8)+"."+substr(tmpImport.Data,32,2))
*!*				case left(Data,1)="8"
*!*					sele tmpLockBox
*!*					append blank
*!*					repla recType with "8"
*!*					repla LockBoxNum with substr(tmpImport.Data,8,7)
*!*					repla CreditDate with ctod(substr(tmpImport.Data,17,2)+"/" ;
*!*						+substr(tmpImport.Data,19,2)+"/" ;
*!*						+YrPrefix+substr(tmpImport.Data,15,2))
*!*					repla TotItems with substr(tmpImport.Data,21,4)
*!*					repla TotDollars with val(substr(tmpImport.Data,25,8)+"."+substr(tmpImport.Data,33,2))
*!*				case left(Data,1)="9"
*!*					sele tmpLockBox
*!*					append blank
*!*					repla recType with "9"
*!*					repla recCount with substr(tmpImport.Data,2,6)
*!*			endcase
*!*			sele tmpImport
*!*		endscan		
*!*		sele tmpLockBox
*!*		scan
*!*			scatter memvar
*!*			insert into LockBox from memvar
*!*		endscan	
*!*		wait clear
*!*	ENDPROC

*!*	PROC ProcessData
*!*		sele LockBox
*!*		lBoxNum=""
*!*		loca for CreateDate=xDate and CreateTime=xTime and empty(process_d)
*!*		if !eof()
*!*			Wait window "Processing LockBox Data..." nowait
*!*			lboxdate=createdate
*!*			lboxtime=createtime
*!*			ImportDate=rptDate
*!*			Process_d=rptDate
*!*			if Process_d<>date()
*!*				Process_t="00:00:00" && Payment was posted to some other date, so use 00:00:00 as the time.
*!*			else
*!*				Process_t=rptTime
*!*			endif
*!*			do while !eof() and rectype<>'9'
*!*				if recType='5'
*!*					lBoxNum=LockBoxNum
*!*					m.Creditdate=LockBox.CreditDate	
*!*					m.Amount=0
*!*					m.PostAmt=0
*!*					m.ItemNum=""
*!*				endif
*!*				if recType='6'
*!*					CheckNo=CheckNum
*!*				endif
*!*				if recType='6' or recType='4'
*!*					m.custno=LockBox.custno
*!*					if len(alltrim(LockBox.invno))<10
*!*						m.InvNo=LockBox.Invno
*!*					else
*!*						m.InvNo=right(LockBox.Invno,15)
*!*					endif
*!*					m.ItemNum=LockBox.ItemNum		
*!*					m.Amount=LockBox.CheckAmt
*!*					m.PostAmt=0		
*!*					insert into LockBoxPost from memvar
*!*				endif	
*!*				repla process_d with rptDate
*!*				repla process_t with rptTime
*!*				skip
*!*			enddo											
*!*		else
*!*			wait clear
*!*			messagebox("File already processed - will check to see if it has been posted.",0," System Alert")
*!*		endif
*!*		wait clear
*!*	ENDPROC
*!*			
*!*	PROC PostPayments
*!*		*suspend
*!*		use jkarofil in 0 order inv_no

*!*		sele LockBoxPost
*!*		set rela to invno into jkarofil
*!*		go top
*!*		loca for lBoxDate=xDate and lBoxTime=xTime and empty(postdate)

*!*		if found()
*!*			wait window "Posting Payments..." nowait
*!*			do while !eof()
*!*				curItemNum=itemNum
*!*				availAmt=Amount
*!*				do while curItemNum=itemNum and !eof()
*!*					if !eof('jkarofil')
*!*						if availAmt>0
*!*							do case
*!*								case empty(jkarofil.check_no)
*!*									PymntID="1"
*!*								case empty(jkarofil.check_no2)
*!*									PymntID="2"
*!*								case empty(jkarofil.check_no3)
*!*									PymntID="3"
*!*								case empty(jkarofil.check_no4)
*!*									PymntID="4"
*!*								case empty(jkarofil.check_no5)
*!*									PymntID="5"
*!*								otherwise
*!*									PymntID="X" && ID for No more room for Payment (No Room)
*!*							endcase
*!*						else
*!*							PymntID="Y"
*!*						endif				
*!*					else
*!*						PymntID="Z" && ID for Invoice not found (Bad Invoice)
*!*					endif

*!*					if !PymntID $ "XYZ"
*!*						sele LockBoxPost
*!*						if availAmt>jkarofil.itm_amt+jkarofil.itm_tax
*!*							repla postAmt 		with jkarofil.itm_amt+jkarofil.itm_tax
*!*							availAmt=availAmt-(jkarofil.itm_amt+jkarofil.itm_tax)			
*!*						else
*!*							repla postamt 		with availAmt
*!*							availAmt=0
*!*						endif
*!*						repla postdate		with rptDate
*!*						repla PostResult 	with "Posted-CK"+PymntID

*!*						*--> KMC 04/01/2008 - Un-remark following to post to AR.
*!*						if PymntID="1"
*!*							repla jkarofil.check_date 	with LockBoxPost.PostDate
*!*							repla jkarofil.check_no 	with LockBoxPost.CheckNo
*!*							repla jkarofil.check_amt	with LockBoxPost.PostAmt
*!*						else
*!*							repla jkarofil.check_dat&PymntID 	with LockBoxPost.PostDate
*!*							repla jkarofil.check_no&PymntID 	with LockBoxPost.CheckNo
*!*							repla jkarofil.check_amt&PymntID 	with LockBoxPost.PostAmt
*!*						endif
*!*						*-->

*!*					else
*!*						select LockBoxPost
*!*						do case
*!*							case PymntID="X"
*!*								repla postdate 		with rptDate
*!*								repla postamt 		with 0
*!*								repla PostResult 	with "No Room"
*!*							case PymntID="Y"
*!*								repla postdate 		with Date()
*!*								repla postamt 		with 0
*!*								repla PostResult 	with "No $$$s"
*!*							case PymntID="Z"
*!*								repla postdate 		with rptDate
*!*								repla postamt 		with 0
*!*								repla PostResult 	with "Bad Invoice"
*!*						endcase				
*!*					endif
*!*					skip
*!*				enddo
*!*			enddo	
*!*			wait clear
*!*		else
*!*			messagebox("File already posted - Will generate posting report.",0," System Alert")
*!*		endif
*!*	ENDPROC
		



*       *********************************************************
*       *                                                         
*       * _6FO0INONG  ON SELECTION BAR 10 OF POPUP accountsre     
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  186          
*       * Called By:  ON SELECTION BAR 10 OF POPUP accountsre     
*       * Prompt:     LockBox Posting Report                      
*       * Snippet:    96                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inong
do form LockBoxPostReport



*       *********************************************************
*       *                                                         
*       * _6FO0INONH  ON SELECTION BAR 1 OF POPUP arreports       
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  169          
*       * Called By:  ON SELECTION BAR 1 OF POPUP arreports       
*       * Prompt:     AR Log                                      
*       * Snippet:    97                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inonh
Do Form ARLog



*       *********************************************************
*       *                                                         
*       * _6FO0INONI  ON SELECTION BAR 2 OF POPUP arreports       
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  170          
*       * Called By:  ON SELECTION BAR 2 OF POPUP arreports       
*       * Prompt:     AR History                                  
*       * Snippet:    98                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inoni
DO FORM SelectARHistory



*       *********************************************************
*       *                                                         
*       * _6FO0INONJ  ON SELECTION BAR 3 OF POPUP arreports       
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  171          
*       * Called By:  ON SELECTION BAR 3 OF POPUP arreports       
*       * Prompt:     Aging Report                                
*       * Snippet:    99                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inonj
DO FORM SelectAging



*       *********************************************************
*       *                                                         
*       * _6FO0INONK  ON SELECTION BAR 4 OF POPUP arreports       
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  172          
*       * Called By:  ON SELECTION BAR 4 OF POPUP arreports       
*       * Prompt:     Monies Received                             
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inonk
Do form MoniesReceived


*       *********************************************************
*       *                                                         
*       * _6FO0INONL  ON SELECTION BAR 5 OF POPUP arreports       
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  173          
*       * Called By:  ON SELECTION BAR 5 OF POPUP arreports       
*       * Prompt:     Open AR - By Fran                           
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inonl
Do form OpenARByFran


*       *********************************************************
*       *                                                         
*       * _6FO0INONM  ON SELECTION BAR 6 OF POPUP arreports       
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  174          
*       * Called By:  ON SELECTION BAR 6 OF POPUP arreports       
*       * Prompt:     Other Deposits                              
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inonm
Do form OtherDeposits





*       *********************************************************
*       *                                                         
*       * _6FO0INONN  ON SELECTION BAR 8 OF POPUP arreports       
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  177          
*       * Called By:  ON SELECTION BAR 8 OF POPUP arreports       
*       * Prompt:     Open Invoices - Detail Review               
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inonn
Do Form OpenInv_DtlReview


*       *********************************************************
*       *                                                         
*       * _6FO0INONO  ON SELECTION BAR 9 OF POPUP arreports       
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  178          
*       * Called By:  ON SELECTION BAR 9 OF POPUP arreports       
*       * Prompt:     Open Invoices - Frans that do not CB        
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inono
do form OpenInv_nonCB


*       *********************************************************
*       *                                                         
*       * _6FO0INONP  ON SELECTION BAR 9 OF POPUP utilities       
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  242          
*       * Called By:  ON SELECTION BAR 9 OF POPUP utilities       
*       * Prompt:     Edit Bank Path                              
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inonp
*Do form editbankpath
Do form bankpathinfo



*       *********************************************************
*       *                                                         
*       * _6FO0INONQ  ON SELECTION BAR 10 OF POPUP utilities      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  243          
*       * Called By:  ON SELECTION BAR 10 OF POPUP utilities      
*       * Prompt:     Print  STA Check                            
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inonq
use data_loc in 0
sele data_loc
if cCompNo="NAT999" or cCompNo="NAT991"
	loca for company_no="NAT000"
else
	loca for company_no=cCompNo
endif
*--> Don't call form if we cannot locate bank information.
if found()
	use
	do form SpecialTrustCheck
else
	use
	messagebox("Cannot locate Bank Info.",48,"  No Bank Info Record")
endif




*       *********************************************************
*       *                                                         
*       * _6FO0INONR  ON SELECTION BAR 11 OF POPUP utilities      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  244          
*       * Called By:  ON SELECTION BAR 11 OF POPUP utilities      
*       * Prompt:     Special Trust Account Transfer              
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inonr
do form SpecialTrustAcctTran


*       *********************************************************
*       *                                                         
*       * _6FO0INONS  ON SELECTION BAR 1 OF POPUP databaseut      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  191          
*       * Called By:  ON SELECTION BAR 1 OF POPUP databaseut      
*       * Prompt:     Reindex Databases                           
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inons
do form reindexdatabase



*       *********************************************************
*       *                                                         
*       * _6FO0INONT  ON SELECTION BAR 2 OF POPUP databaseut      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  192          
*       * Called By:  ON SELECTION BAR 2 OF POPUP databaseut      
*       * Prompt:     Fix Cross Linked Customers                  
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inont
do form fixcrosslinkedcust


*       *********************************************************
*       *                                                         
*       * _6FO0INONU  ON SELECTION BAR 3 OF POPUP databaseut      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  193          
*       * Called By:  ON SELECTION BAR 3 OF POPUP databaseut      
*       * Prompt:     Fix Memo Files                              
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inonu
*--> Fix Customer Service Files
WAIT window "Repairing Customer Service File..." nowait
USE cDataLoc+"service" in 0
SELE service
COPY to cDataLoc+"tmpServ" type fox2x
USE
tmpFile1=cDataLoc+"oldServ.dbf"
tmpFile2=cDataLoc+"oldServ.fpt"
*--> Delete old files if they exist.
if file(tmpFile1)
	Dele file cDataLoc+"oldServ.dbf"
endif
if file(tmpFile2)
	Dele File cDataLoc+"oldServ.fpt"
endif
*--> Rename current files, so we still have them - just in case.
RENAME cDataLoc+"service.dbf" to cDataLoc+"oldServ.dbf"
RENAME cDataLoc+"service.fpt" to cDataLoc+"oldServ.fpt"
*--> Rename repaired files to proper name for use.
RENAME cDataLoc+"tmpServ.dbf" to cDataLoc+"service.dbf"
RENAME cDataLoc+"tmpServ.fpt" to cDataLoc+"service.fpt"
*--> rebuild Indexes.
WAIT window "Rebuilding Indexes..." nowait
USE cdataLoc+"service" in 0 excl
sele service
Dele TAG ALL
PACK
INDEX ON Cust_No+STR({02/02/2202}-Call_Date) TAG Cust_No
INDEX ON Call_Date                           TAG Call_Date
INDEX ON Cust_No							 TAG Cust
USE

*--> Fix Customer Service History Files
WAIT window "Repairing Customer Service History File..." nowait
USE cDataLoc+"servhst" in 0
SELE servhst
COPY to cDataLoc+"tmpSHst" type fox2x
USE
tmpFile1=cDataLoc+"oldSHst.dbf"
tmpFile2=cDataLoc+"oldSHst.fpt"
*--> Delete old files if they exist.
if file(tmpFile1)
	Dele file cDataLoc+"oldSHst.dbf"
endif
if file(tmpFile2)
	Dele File cDataLoc+"oldSHst.fpt"
endif
*--> Rename current files, so we still have them - just in case.
RENAME cDataLoc+"servhst.dbf" to cDataLoc+"oldSHst.dbf"
RENAME cDataLoc+"servhst.fpt" to cDataLoc+"oldSHst.fpt"
*--> Rename repaired files to proper name for use.
RENAME cDataLoc+"tmpSHst.dbf" to cDataLoc+"servhst.dbf"
RENAME cDataLoc+"tmpSHst.fpt" to cDataLoc+"servhst.fpt"
*--> rebuild Indexes.
WAIT window "Rebuilding Indexes..." nowait
USE cdataLoc+"servhst" in 0 excl
sele servhst
Dele TAG ALL
PACK
INDEX ON Cust_No+STR({02/02/2202}-Call_Date) TAG Cust_No
INDEX ON Call_Date                           TAG Call_Date
INDEX ON Cust_No							 TAG Cust
USE

*--> Fix Collection Calls Files
WAIT window "Repairing Collections File..." nowait
USE cDataLoc+"jkcuscol" in 0
SELE jkcuscol
COPY to cDataLoc+"tmpColl" type fox2x
USE
tmpFile1=cDataLoc+"oldColl.dbf"
tmpFile2=cDataLoc+"oldColl.fpt"
*--> Delete old files if they exist.
if file(tmpFile1)
	Dele file cDataLoc+"oldColl.dbf"
endif
if file(tmpFile2)
	Dele File cDataLoc+"oldColl.fpt"
endif
*--> Rename current files, so we still have them  - just in case.
RENAME cDataLoc+"jkcuscol.dbf" to cDataLoc+"oldColl.dbf"
RENAME cDataLoc+"jkcuscol.fpt" to cDataLoc+"oldColl.fpt"
*--> Rename repaired files to proper name for use.
RENAME cDataLoc+"tmpColl.dbf" to cDataLoc+"jkcuscol.dbf"
RENAME cDataLoc+"tmpColl.fpt" to cDataLoc+"jkcuscol.fpt"
*--> rebuild Indexes.
WAIT window "Rebuilding Indexes..." nowait
USE cDataLoc+"jkcuscol" in 0 excl
Dele TAG ALL
PACK
INDEX ON Cust_No+STR({02/02/2202}-Call_Date) TAG Cust_No
INDEX ON Call_Date                           TAG Call_Date
INDEX ON Cust_No							 TAG Cust
USE

*--> Fix Collection Calls History Files
WAIT window "Repairing Collections History File..." nowait
USE cDataLoc+"collhst" in 0
SELE collhst
COPY to cDataLoc+"tmpCHst" type fox2x
USE
tmpFile1=cDataLoc+"oldCHst.dbf"
tmpFile2=cDataLoc+"oldCHst.fpt"
*--> Delete old files if they exist.
if file(tmpFile1)
	Dele file cDataLoc+"oldCHst.dbf"
endif
if file(tmpFile2)
	Dele File cDataLoc+"oldCHst.fpt"
endif
*--> Rename current files, so we still have them  - just in case.
RENAME cDataLoc+"collhst.dbf" to cDataLoc+"oldCHst.dbf"
RENAME cDataLoc+"collhst.fpt" to cDataLoc+"oldCHst.fpt"
*--> Rename repaired files to proper name for use.
RENAME cDataLoc+"tmpCHst.dbf" to cDataLoc+"collhst.dbf"
RENAME cDataLoc+"tmpCHst.fpt" to cDataLoc+"collhst.fpt"
*--> rebuild Indexes.
WAIT window "Rebuilding Indexes..." nowait
USE cDataLoc+"collhst" in 0 excl
Dele TAG ALL
PACK
INDEX ON Cust_No+STR({02/02/2202}-Call_Date) TAG Cust_No
INDEX ON Call_Date                           TAG Call_Date
INDEX ON Cust_No							 TAG Cust
USE

*--> Fix Franchisee Calls Files
WAIT window "Repairing Franchisee Calls File..." nowait
USE cDataLoc+"FranCall" in 0 alias FranCall
SELE FranCall
COPY to cDataLoc+"tmpFCall" type fox2x
USE
tmpFile1=cDataLoc+"oldFCall.dbf"
tmpFile2=cDataLoc+"oldFCall.fpt"
*--> Delete old files if they exist.
if file(tmpFile1)
	Dele file cDataLoc+"oldFCall.dbf"
endif
if file(tmpFile2)
	Dele File cDataLoc+"oldFCall.fpt"
endif
*--> Rename current files, so we still have them  - just in case.
RENAME cDataLoc+"FranCall.dbf" to cDataLoc+"oldFCall.dbf"
RENAME cDataLoc+"FranCall.fpt" to cDataLoc+"oldFCall.fpt"
*--> Rename repaired files to proper name for use.
RENAME cDataLoc+"tmpFCall.dbf" to cDataLoc+"FranCall.dbf"
RENAME cDataLoc+"tmpFCall.fpt" to cDataLoc+"FranCall.fpt"
*--> rebuild Indexes.
WAIT window "Rebuilding Indexes..." nowait
USE cDataLoc+"FranCall" in 0 excl
Dele TAG ALL
PACK
INDEX ON Dlr_Code+STR({02/02/2202}-Call_Date) TAG FranCall
INDEX ON Call_Date                           TAG Call_Date
INDEX ON Dlr_Code							 TAG Dlr
USE

WAIT clear
Clos all
Clea
RETURN



*       *********************************************************
*       *                                                         
*       * _6FO0INONV  ON SELECTION BAR 1 OF POPUP systemutil      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  198          
*       * Called By:  ON SELECTION BAR 1 OF POPUP systemutil      
*       * Prompt:     Archive Data                                
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inonv
cMessageTitle = 'Archive Data'
cMessageText = 'Is this the correct Date?'+CHR(13)+CHR(13)+DTOC(DATE())
nDialogType = 4 + 32 + 256
*  4 = Yes and No buttons
*  32 = Question mark icon
*  256 = Second button is default

stop_proc = .F.
nAnswer = MESSAGEBOX(cMessageText, nDialogType, cMessageTitle)

DO CASE
CASE nAnswer = 6

ON ERROR DO stop_proc	

*!*	ON ERROR DO stop_proc WITH ;
*!*	   ERROR( ), MESSAGE( ), MESSAGE(1), PROGRAM( ), LINENO( )

	IF stop_proc=.F.
		use service in 0 excl
		if !file('servhst.dbf')
			sele service
			copy stru to servhst
		endif
		use servhst in 0
	ENDIF
	
	IF stop_proc=.F.
		use jkcuscol in 0 excl
		if !file('collhst.dbf')
			sele jkcuscol
			copy stru to collhst
		endif
		use collhst in 0
	ENDIF	

	IF stop_proc=.F.
		use jkarofil in 0 excl
		if !file('delaro.dbf')
			sele jkarofil
			copy stru to delaro
		endif	
		use delaro in 0
		IF !FILE ('arohist.dbf')
			Sele jkarofil
			COPY STRU TO arohist
		ENDIF
		use arohist in 0
	ENDIF	
	
	*--> KMC 07/27/2004 - To Archive old Telemarketing calls.	
	xTele=.F.
	IF stop_proc = .F.
		if file(cDataLoc+'custleads\custleadcalls.dbf')
			xTele=.T.
			use cDataLoc+"custleads\custleadcalls" in 0 excl
			if !file(cDataLoc+'custleads\clcallhst.dbf')
				sele custleadcalls
				copy stru to cDataLoc+"custleads\clcallhst"
			endif	
			use cDataLoc+"CustLeads\clcallhst" in 0
		endif
	ENDIF	
	*-->

	IF stop_proc
		CLOSE DATA ALL
		ON ERROR && Reset Error routine back to default setting.
		RETURN
	ENDIF

	WAIT WINDOW "Archiving old AR and call records..." NOWAIT
	
	&& KMC 01/25/2001
	&& Get the deleted records and save them to delaro, just in case
	&& we need to bring it back sometime, payments here are virtually
	&& impossible to recover otherwise.
	SET DELE OFF
	SELE * FROM jkarofil WHERE DELETED() INTO TABLE tmp
	SELE delaro
	APPEND FROM tmp
	use
	sele tmp
	use
	dele file tmp.dbf
	SET DELE ON

	&& Select all AR older than 6 months and paid in full.
	SELE * FROM jkarofil WHERE date_inv<GOMONTH(DATE(),-6) AND ;
		itm_amt+itm_tax=check_amt+check_amt2+check_amt3+check_amt4+check_amt5 ;
		AND check_date<GOMONTH(DATE(),-6) ;
		AND check_dat2<GOMONTH(DATE(),-6) ;
		AND check_dat3<GOMONTH(DATE(),-6) ;
		AND check_dat4<GOMONTH(DATE(),-6) ;
		AND check_dat5<GOMONTH(DATE(),-6) ;
		AND !DELETED() ;
		INTO TABLE tmp
	SELE arohist
	APPEND FROM tmp
	use
	sele tmp
	use
	DELE FILE tmp.DBF
	Sele jkarofil
	DELE ALL FOR date_inv<GOMONTH(DATE(),-6) AND ;
		itm_amt+itm_tax=check_amt+check_amt2+check_amt3+check_amt4+check_amt5 ;
		AND check_date<GOMONTH(DATE(),-6) ;
		AND check_dat2<GOMONTH(DATE(),-6) ;
		AND check_dat3<GOMONTH(DATE(),-6) ;
		AND check_dat4<GOMONTH(DATE(),-6) ;
		AND check_dat5<GOMONTH(DATE(),-6)
	PACK
	use
	
	&& Select all Customer Service records older than 6 months.
	WAIT WINDOW "Archiving old Customer Service records..." NOWAIT
	SELE * FROM service WHERE call_date<GOMONTH(DATE(),-6) AND !DELETED() INTO TABLE tmp
	SELE servhst
	APPEND FROM tmp
	use
	sele tmp
	use
	DELE FILE tmp.DBF
	sele service
	DELE ALL FOR call_date<GOMONTH(DATE(),-6)
	PACK
	use
	
	&& Select all Collection records more than 6 months old.
	WAIT WINDOW "Archiving old Collections records..." NOWAIT
	SELE * FROM jkcuscol WHERE call_date<GOMONTH(DATE(),-6) AND !DELETED() INTO TABLE tmp
	SELE collhst
	APPEND FROM tmp
	use
	sele tmp
	use
	dele file tmp.dbf
	sele jkcuscol
	DELE ALL FOR call_date<GOMONTH(DATE(),-6)
	PACK
	use

	&& KMC 07/27/2004 - Select all Telemarketing calls more than 6 months old.
	if xTele
		WAIT WINDOW "Archiving old Telemarketing calls..." NOWAIT
		SELE * FROM cDataLoc+"custleads\custleadcalls" WHERE calldate<GOMONTH(DATE(),-6) AND !DELETED() INTO TABLE tmp
		IF _TALLY > 0
			SELE clcallhst
			APPEND FROM tmp
			use
			sele tmp
			use
			dele file tmp.dbf
			sele custleadcalls
			DELE ALL FOR calldate<GOMONTH(DATE(),-6)
			PACK
			use	
		ENDIF	
	endif
	
	clos data all
	ON ERROR
	WAIT CLEAR
	MESSAGEBOX("Archive Data Completed!",48)
	
CASE nAnswer = 7
	* WAIT WINDOW 'You chose No'
ENDCASE

PROC stop_proc
*!*	PARAMETER merror, mess, mess1, mprog, mlineno
*!*	CLEAR
*!*	?
*!*	?
*!*	?
*!*	?
*!*	?
*!*	?
*!*	?
*!*	?
*!*	?

*!*	?"Error number: " + LTRIM(STR(merror))
*!*	?"Error message: " +  mess
*!*	?"Line of code with error: " + mess1
*!*	?"Line number of error: " + LTRIM(STR(mlineno))
*!*	?"Program with error: " + mprog
*!*	WAIT WIND

	WAIT CLEAR
	CLOSE DATA ALL
	ON ERROR
	messagebox("WARNING!  Someone is still in the system.  Please try again later.",48," System Alert")
	stop_proc=.T.
RETURN



*       *********************************************************
*       *                                                         
*       * _6FO0INONW  ON SELECTION BAR 2 OF POPUP systemutil      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  199          
*       * Called By:  ON SELECTION BAR 2 OF POPUP systemutil      
*       * Prompt:     Bulk Contract Incr/Decr                     
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inonw
do form BulkContractIncrease


*       *********************************************************
*       *                                                         
*       * _6FO0INONX  ON SELECTION BAR 3 OF POPUP systemutil      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  200          
*       * Called By:  ON SELECTION BAR 3 OF POPUP systemutil      
*       * Prompt:     Payment Calculator                          
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inonx
do form payments


*       *********************************************************
*       *                                                         
*       * _6FO0INONY  ON SELECTION BAR 4 OF POPUP systemutil      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  201          
*       * Called By:  ON SELECTION BAR 4 OF POPUP systemutil      
*       * Prompt:     Recall Archived Invoice                     
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inony
DO FORM RECALLARCHIVEDINVOICE with "Recall"


*       *********************************************************
*       *                                                         
*       * _6FO0INONZ  ON SELECTION BAR 5 OF POPUP systemutil      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  202          
*       * Called By:  ON SELECTION BAR 5 OF POPUP systemutil      
*       * Prompt:     Recall Deleted Invoice                      
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inonz
DO FORM RecallDeletedInvoice



*       *********************************************************
*       *                                                         
*       * _6FO0INOO0  ON SELECTION BAR 6 OF POPUP systemutil      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  203          
*       * Called By:  ON SELECTION BAR 6 OF POPUP systemutil      
*       * Prompt:     Reverse Charge-Back Checks                  
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inoo0
DO FORM REVERSECHARGEBACKCHECKS


*       *********************************************************
*       *                                                         
*       * _6FO0INOO1  ON SELECTION BAR 7 OF POPUP systemutil      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  204          
*       * Called By:  ON SELECTION BAR 7 OF POPUP systemutil      
*       * Prompt:     Split Invoice                               
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inoo1
x=messagebox(" Be sure that all CB/TAR checks have been printed BEFORE splitting an invoice."+CHR(13)+ ;
" Failure to do so can result in CB/TAR checks not being generated for the invoice being split."+CHR(13)+ ;
" If you're not sure, run the appropriate Possible CB/TAR report to be certain the invoice"+CHR(13)+ ;
" in question does not have TAR monies waiting to be paid.",65," Invoice Splitter Message")
if x=1
	DO FORM RECALLARCHIVEDINVOICE with "Split"
else
	return
endif		


*       *********************************************************
*       *                                                         
*       * _6FO0INOO2  ON SELECTION BAR 8 OF POPUP systemutil      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  205          
*       * Called By:  ON SELECTION BAR 8 OF POPUP systemutil      
*       * Prompt:     Untransfer Customer                         
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inoo2
DO FORM UNTRANSFERCUSTOMER


*       *********************************************************
*       *                                                         
*       * _6FO0INOO3  ON SELECTION BAR 10 OF POPUP systemutil     
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  208          
*       * Called By:  ON SELECTION BAR 10 OF POPUP systemutil     
*       * Prompt:     Export Data to Telemarketing                
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inoo3
x=messagebox ("Click 'OK' to update your Telemarketing database"+CHR(13)+;
			"with data from your customer database."+CHR(13)+CHR(13),1," System Alert")
if x<>1
	return
endif	

create cursor CheckLeads ;
	(cust_no C(6), ;
	cus_name C(30), ;
	cus_addr C(30), ;
	cus_phone C(10), ;
	LeadId I, ;
	company C(30), ;
	addr1 C(30), ;
	phone C(14))	

use custleads\custleads in 0 order phone
sele custleads
go top
curRegionCode=regioncode

use custleads\keys in 0
sele keys
set filt to table="CUSTLEADS"

*--> KMC 11/15/2006
ZipLen=5
if "$" $ cDataloc
	ZipLen=7
endif	
*-->

*--> Get all cancelled customers that have cancellation dates of 60 days or more ago.
*--> KMC 02/14/2013 - Added cont_2 as lname to query.
wait window "Selecting all Cancelled accounts..." nowait
sele cust_no, cus_name as Company, cus_addr as Addr1, cus_city as city, cus_state as state, ;
	left(cus_zip,ZipLen) as zip, cus_phone as phone, cont_2 as lname, class_type as accttype, cont_bill, ;
	"Franchise Accounting" as leadsource, "PreCust" as Status, "Outsource" as currentven, ;
	" " as GroupType, -1 as enteredby, -1 as assignedto, 1 as salesid, curRegionCode as regioncode, ;
	date() as createdate, "USA" as Country, canc_date, candescr ;
	from jkcusfil ;
	where flag<>"A" and empty(secondfran) and !empty(canc_date) ;
	and len(alltrim(cus_phone))=10 ;
	and canc_date=<date()-60 ;
	into cursor tmpCancCust ;
	order by cust_no

*--> Import Cancelled accounts into Telemarketing database.
sele tmpCancCust
set rela to phone into CustLeads
go top
wait window "Updating Telemarking data with Cancelled accounts..." nowait
do while !eof('tmpCancCust')
	if eof('CustLeads')
		*--> Update Telemarketing with JK's cancelled customers.
		wait window "Updating Telemarking data with Cancelled account "+tmpCancCust.cust_no+" - adding record..." nowait
		scatter memvar
		
		*--> KMC 11/15/2006
		if len(alltrim(tmpCancCust.zip))=0
			m.zip=replicate("9",ZipLen)
		endif	
		*-->
		
		notes="JK Customer "+cust_no+" Cancelled "+DTOC(TmpCancCust.canc_date)+ ;
			iif(!empty(TmpCancCust.candescr)," - Reason: "+alltrim(TmpCancCust.candescr),"") + ;
			"--> system "+dtoc(date())+"."
		BudgetAmt=TmpCancCust.cont_bill
		id=keys.nextid
		repla keys.nextid with keys.nextid+1
		insert into CustLeads\CustLeads from memvar
		repla CustLeads.lastcontac with NULL CustLeads.callbdate with NULL ;
		CustLeads.lastmailda with NULL CustLeads.startdate with NULL CustLeads.solddate with NULL
	else
		if Custleads.Status<>"Sold" and CustLeads.AcctType<>"Franchise Prospect" ;
			and !"JK Customer "+TmpCancCust.cust_no+" Cancelled "+DTOC(TmpCancCust.canc_date) $ CustLeads.Notes
			wait window "Updating Telemarking data with Cancelled account "+tmpCancCust.cust_no+" - updating record..." nowait
			sele CustLeads
			repla Status with "PreCust"					&& Flag as a Previous Customer.
			repla GroupType with "" 					&& GroupType is no longer used.
			repla AcctType with TmpCancCust.accttype	&& Set Account Type.
			repla BudgetAmt with TmpCancCust.cont_bill	&& Store Cancelled accounts Cont Bill Amt.
			repla ContractAm with 0						&& Clear old contract amt.
			repla SoldDate with NULL	 				&& Clear old Sold date.
			repla StartDate with NULL		  			&& Clear old Start date.
			repla UDF7 with 0							&& Clear old assigned to value.
			if empty(CustLeads.callbdate) or isnull(CustLeads.callbdate)
				*--> If there is no call back date set, unassign the lead.
				repla CallBackBy with ""				&& Clear Call Back by value.
				repla AssignedTo with -1				&& Unassign Lead.
			endif	
			repla notes with alltrim(CustLeads.notes)+" JK Customer "+TmpCancCust.cust_no+ ;
				" Cancelled "+DTOC(TmpCancCust.canc_date)+ ;
				iif(!empty(TmpCancCust.candescr)," - Reason: "+alltrim(TmpCancCust.candescr),"") + ;
				"--> system "+dtoc(date())+"."
		endif
	endif
	sele TmpCancCust	
	skip	
enddo	
use

*--> Get all active customers.
*--> KMC 02/14/2013 - Added cont_2 as lname to query.
wait window "Selecting all Active accounts..." nowait
sele cust_no, cus_name as Company, cus_addr as Addr1, cus_city as city, cus_state as state, ;
	left(cus_zip,ZipLen) as zip, cus_phone as phone, cont_2 as lname, class_type as accttype, ;
	"Franchise Accounting" as leadsource, "CurCust" as Status, "Outsource" as currentven , ;
	" " as GroupType, -1 as enteredby, -1 as assignedto, 1 as salesid, curRegionCode as regioncode, ;
	date() as createdate, "USA" as Country ;
	from jkcusfil ;
	where flag="A" and empty(secondfran) and empty(canc_date) ;
	and len(alltrim(cus_phone))=10 ;
	into cursor tmpCurCust ;
	order by cust_no
	
*--> Import Active Customers into Telemarketing database.
sele tmpCurCust
set rela to phone into CustLeads
go top
wait window "Updating Telemarking data with Active accounts..." nowait
BudgetAmt=0 && Clear BudgetAmt value last set during Cancelled accounts export.
do while !eof('tmpCurCust')
	if eof('CustLeads')
		*--> Update Telemarketing with JK's current customers.
		wait window "Updating Telemarking data with Active account "+tmpCurCust.cust_no+" - adding record..." nowait
		scatter memvar
		
		*--> KMC 11/15/2006
		if len(alltrim(tmpCurCust.zip))=0
			m.zip=replicate("9",ZipLen)
		endif	
		*-->
		
		notes="JK Customer "+tmpCurCust.cust_no+"--> system "+dtoc(date())+"."
		id=keys.nextid
		repla keys.nextid with keys.nextid+1
		insert into CustLeads\CustLeads from memvar
		repla CustLeads.lastcontac with NULL CustLeads.callbdate with NULL ;
		CustLeads.lastmailda with NULL CustLeads.startdate with NULL CustLeads.solddate with NULL
	else
		if CustLeads.Status<>"CurCust" and AcctType<>"Franchise Prospect"
			if empty(CustLeads.callbdate) or isnull(CustLeads.callbdate)
				wait window "Updating Telemarking data with Active account "+tmpCurCust.cust_no+" - updating record..." nowait
				sele CustLeads
				repla Status with "CurCust"					&& Flag as a Current Customer.
				repla GroupType with ""						&& GroupType is no longer used.
				repla CallBackBy with ""					&& Clear Call Back by value.
				repla UDF7 with Assignedto					&& So we know who the lead WAS assigned to.
				repla AssignedTo with -1					&& Unassign Lead.
				repla AcctType with TmpCurCust.accttype		&& Set Account Type.
				repla CurrentVen with "Outsource" 		&& Using JK, so account Outsources cleaning services.
				if !"JK Customer "+tmpCurCust.cust_no$CustLeads.notes
					repla notes with alltrim(CustLeads.notes)+ ;
					" JK Customer "+tmpCurCust.cust_no+"--> system "+dtoc(date())+"."
				endif
				&& Any data pertaining to a sold account is left alone.  It will be cleared if
				&& and when the account cancels ands gets updated to PreCust status.	
			else
				if CustLeads.status="Active" or CustLeads.Status="Telemark" ;
				or CustLeads.Status="CustSales" or CustLeads.Status="PreCust"
					*--> Lead is NOT flagged as 'CurCust' AND is not a Franchise Prospect
					*--> but DOES have a Call Back Date.  Not sure of this lead
					*--> (call back date set.. don't want to kill anyones call back),
					*--> so copy it to CheckLeads.
					wait window "Updating Telemarking data with Active account "+tmpCurCust.cust_no+" - updating record..." nowait
					sele CustLeads
					scatter fields company, addr1, phone memvar
					LeadId=CustLeads.Id
					insert into CheckLeads from memvar		
					sele CheckLeads
					repla cust_no with tmpCurCust.cust_no
					repla cus_name with tmpCurCust.company
					repla cus_addr with tmpCurCust.addr1
					repla cus_phone with tmpCurCust.phone
				else
					*--> Status is either "DoNotCall", NotQual" or "Sold"
					*--> AND there is a call back date set.  Based on the
					*--> Status of the lead, the call back date is irrelevant.
					*--> Change status to 'CurCust' and unassign the lead.
					wait window "Updating Telemarking data with Active account "+tmpCurCust.cust_no+" - updating record..." nowait
					sele CustLeads
					repla Status with "CurCust"					&& Flag as a Current Customer.
					repla GroupType with ""						&& GroupType is no longer used.
					repla CallBackBy with ""					&& Clear Call Back by value.
					repla CallBDate with NULL					&& Clear Call Back by value.
					repla UDF7 with Assignedto					&& So we know who the lead WAS assigned to.
					repla AssignedTo with -1					&& Unassign Lead.
					repla AcctType with TmpCurCust.accttype		&& Set Account Type.
					repla CurrentVen with "Outsource" 		&& Using JK, so account Outsources cleaning services.
					if !"JK Customer "+tmpCurCust.cust_no$CustLeads.notes
						repla notes with alltrim(CustLeads.notes)+ ;
						" JK Customer "+tmpCurCust.cust_no+"--> system "+dtoc(date())+"."
					endif
					&& Any data pertaining to a sold account is left alone.  It will be cleared if and
					&& when the account cancels ands gets updated to PreCust status.	
				endif			
			endif
		endif
	endif
	sele TmpCurCust	
	skip	
enddo	
use

wait clear

sele CheckLeads
go top
if !eof()
	copy to "Leads_to_Check_"+left(cCompNo,3) type xls
	x=messagebox ("Excel Spreadsheet "+sys(5)+sys(2003)+"\Leads_To_Check_"+left(cCompNo,3)+" has been created."+CHR(13)+ ;
		"This spreadsheet lists leads that the system believes may be current customers."+CHR(13)+ ;
		"Please look over the spreadsheet and manually update these leads to"+CHR(13)+ ;
		"'Current Customer' status if appropriate.",0," Alert")
else
	wait window "Export Complete.  Press any key to continue."
endif
clos all
return



*       *********************************************************
*       *                                                         
*       * _6FO0INOO4  ON SELECTION BAR 11 OF POPUP systemutil     
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  209          
*       * Called By:  ON SELECTION BAR 11 OF POPUP systemutil     
*       * Prompt:     Import Telemarketing Leads                  
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inoo4
USE custleads\custleads IN 0
SELE custleads
GO TOP

IF EOF()
	CLOS ALL
	MESSAGEBOX("There must be at least one lead in the leads database before data can be imported."," System Alert")
	RETURN
ELSE
	clos all
	do form importleads
endif	


*       *********************************************************
*       *                                                         
*       * _6FO0INOO5  ON SELECTION BAR 13 OF POPUP systemutil     
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  212          
*       * Called By:  ON SELECTION BAR 13 OF POPUP systemutil     
*       * Prompt:     Export CB Letter Data                       
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inoo5
Do Form CBLetterExport


*       *********************************************************
*       *                                                         
*       * _6FO0INOO6  ON SELECTION BAR 14 OF POPUP systemutil     
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  213          
*       * Called By:  ON SELECTION BAR 14 OF POPUP systemutil     
*       * Prompt:     Export Invoice Data                         
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inoo6
Do Form InvoiceData



*       *********************************************************
*       *                                                         
*       * _6FO0INOO7  ON SELECTION BAR 15 OF POPUP systemutil     
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  214          
*       * Called By:  ON SELECTION BAR 15 OF POPUP systemutil     
*       * Prompt:     Export Special Trust GL Data to Traverse    
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inoo7
Do Form ExportSTA_GL_ToTraverse


*       *********************************************************
*       *                                                         
*       * _6FO0INOO8  ON SELECTION BAR 17 OF POPUP systemutil     
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  217          
*       * Called By:  ON SELECTION BAR 17 OF POPUP systemutil     
*       * Prompt:     CPI Maintenance                             
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inoo8
*FK 7/25/05 Get CPI path
PUBLIC CPIPath
USE data_loc IN 0
SELE data_loc
x=LEN(ALLTRIM(fran_acct))
DO WHILE x=>1
	curChar=SUBSTR(fran_acct,x,1)
	IF curChar="\"
		EXIT
	ELSE
		x=x-1
	ENDIF
ENDDO
IF x<>0
	CPIPath=LEFT(fran_acct,x)+"CPIData"
ELSE
	MESSAGEBOX("Cannot Locate CPI Directory Info.",48,"Alert")
	RETURN
ENDIF

IF FILE(CPIPath+'\CPI.DBF')
	DO FORM CPIfileinfo
ELSE
	MESSAGEBOX("Cannot Locate CPI Table Info.",48,"Alert")
	RETURN
ENDIF



*       *********************************************************
*       *                                                         
*       * _6FO0INOO9  ON SELECTION BAR 19 OF POPUP systemutil     
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  220          
*       * Called By:  ON SELECTION BAR 19 OF POPUP systemutil     
*       * Prompt:     Export Lead Data                            
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inoo9
Do form ExportLeadData


*       *********************************************************
*       *                                                         
*       * _6FO0INOOA  ON SELECTION BAR 21 OF POPUP systemutil     
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  223          
*       * Called By:  ON SELECTION BAR 21 OF POPUP systemutil     
*       * Prompt:     Create Regional Office Billing Adj Trxs     
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inooa
clos data all

x=MESSAGEBOX("Create WC Billing Adjustment transactions?",4," Create WC Adj Trxs")
if x<>6
	return
endif	

InvToApplyCreditTo=""

*--> Get current period
use jkctlfil in 0
sele jkctlfil
loca for control_no = 1
rptMonth = fn_lsmon
rptYear = fn_lsyear
use

*--> Locate correct record and lock jkinvfil table.
use jkinvfil in 0
sele jkinvfil
loca for bill_mon=rptMonth and bill_year=rptYear
BailOut = .F.

if posted = .T.
	messagebox("Active period is posted, unable to create transactions!")
	BailOut = .T.
endif

do while !rlock() and !BailOut
	wait window "waiting for lock..." nowait
	if lastkey()=27
		BailOut = .T.
		return
	endif	
enddo

if !BailOut
	wait window "Creating WC Adjustment Transactions..." nowait

	*--> Locate Franchisee and Customer associated with WC Holding Account.
	use jkcmpfil in 0
	sele jkcmpfil
	loca for control_no=1
	BillingComponentCust=jkcmpfil.ROBCA
	use
	
	use jkcusfil in 0
	sele jkcusfil
	loca for cust_no=BillingComponentCust
	BillingComponentComp = jkcusfil.company_no
	BillingComponentFran = jkcusfil.dlr_code
	BillingComponentSysCust = jkcusfil.sys_cust
	BillingComponentCustName = jkcusfil.cus_name
	use
	
	*--> Open jkcustrx and jkarofil
	use jkcustrx in 0
	use jkarofil in 0

	*--> Delete all WC trxs that exist for current period.
	*--> May be able to identify WC related records based on some identifying text in jkcustrx.desc_var6 since
	*--> these trx's would be "B" trx's and would normally not have anything in that field.
	*--> If not that, will have to add a new field to ID the records.
	sele inv_no from jkcustrx where bill_mon=rptMonth and bill_year=rptYear and desc_var6="WC ADJUSTMENT" into cursor WC_Adj_Trxs
	sele WC_ADJ_Trxs
	index on inv_no to xyz

	sele jkcustrx
	set rela to inv_no into WC_Adj_Trxs
	set filt to !eof('WC_Adj_Trxs')
	dele all
	set filt to	

	sele jkarofil
	set rela to inv_no into WC_Adj_Trxs
	set filt to !eof('WC_Adj_Trxs')
	dele all
	set filt to	

	sele WC_Adj_Trxs
	use
	dele file xyz.idx

	*--> Create table or cursor with franchisee numbers and billing totals for records to be processed.
	sele iif(len(alltrim(apply_fran))=6,apply_fran,dlr_code) as dlr_code, ;
		000.00 as royalty, 00.00 as BillAdjPct, iif(trx_type="I",trx_amt,trx_amt * -1) as trx_amt, ;
		iif(trx_type="I",trx_tax,trx_tax * -1) as trx_tax, ;
		iif(trx_type="I",pst_tax,pst_tax * -1) as pst_tax ;
	from jkcustrx trx ;
	where bill_mon=rptMonth and bill_year=rptYear and onReport = .T. ;
	into cursor PossFranData

	sele pfd.dlr_code, dlr.royalty, dlr.BillAdjPct, sum(trx_amt) as trx_amt, ;
		sum(trx_tax) as trx_tax, sum(pst_tax) as pst_tax ;
	from PossFranData pfd ;
	inner join jkdlrfil dlr on pfd.dlr_code = dlr.dlr_code ;
	where dlr.ded_AdjPct="Y" ;
	group by pfd.dlr_code ;
	order by pfd.dlr_code ;
	into cursor FranData
	
	sele PossFranData
	use

	sele FranData
	go top

	do while !eof()	
		sele FranData
		*--> Create the inv trx associated with the impacted franchisee.
		*--> Trx amount will be based on that franchisee's total billing for the period.
		DO CreateInvTrx
		*--> Create the credit trx to the designated WC Holding Account / Customer.
		DO CreateCreditTrx
		*--> Create AR record associated with transaction.
		DO CreateARTrx
		
		sele FranData && KMC 06/12/2012

		skip
	enddo	
	sele FranData
	use	

	*--> Unlock jkinvfil
	sele jkinvfil
	unlock
	use
	
	wait clear
endif

clos all
	
Proc CreateInvTrx
	sele jkcustrx
	append blank
	repla sys_cust with BillingComponentSysCust
	repla company_no with BillingComponentComp
	repla dlr_code with BillingComponentFran
	repla cust_no with BillingComponentCust
	repla bill_mon with rptMonth
	repla bill_year with rptYear
	repla descr with "REGIONAL OFFICE BILLING ADJ. - FRAN "+FranData.dlr_code
	repla due_date with gomonth(CTOD(alltrim(str(rptMonth))+"/01/"+alltrim(str(rptYear))),1)-1
	repla eff_date with date()
	repla inv_date with gomonth(CTOD(alltrim(str(rptMonth))+"/01/"+alltrim(str(rptYear))),1)-1
	repla inv_no with PADL(ALLTRIM(STR(jkinvfil.inv_no)),8,"0")
	InvToApplyCreditTo = PADL(ALLTRIM(STR(jkinvfil.inv_no)),8,"0")
	repla Quantity with 1
	repla Royalty with FranData.Royalty
	repla sep_inv with "Y"
	repla trx_amt with round(FranData.trx_amt * (FranData.BillAdjPct/100),2)
	repla trx_class with "B"
	repla trx_tax with round(FranData.trx_tax * (FranData.BillAdjPct/100),2)
	repla trx_type with "I"
	repla desc_var6 with "WC ADJUSTMENT"
	repla prntinv with "N"
	repla pst_tax with round(FranData.pst_tax * (FranData.BillAdjPct/100),2)
	repla onReport with .F.
	repla jkinvfil.inv_no with jkinvfil.inv_no + 1
return

Proc CreateCreditTrx
	sele jkcustrx
	append blank
	repla sys_cust with BillingComponentSysCust
	repla company_no with BillingComponentComp
	repla dlr_code with BillingComponentFran
	repla cust_no with BillingComponentCust
	repla bill_mon with rptMonth
	repla bill_year with rptYear
	repla descr with "REGIONAL OFFICE BILLING ADJUSTMENT"
	repla due_date with gomonth(CTOD(alltrim(str(rptMonth))+"/01/"+alltrim(str(rptYear))),1)-1
	repla eff_date with date()
	repla inv_date with gomonth(CTOD(alltrim(str(rptMonth))+"/01/"+alltrim(str(rptYear))),1)-1
	repla inv_no with PADL(ALLTRIM(STR(jkinvfil.inv_no)),8,"0")
	repla Quantity with 1
	repla Royalty with FranData.Royalty
	repla sep_inv with "Y"
	repla trx_amt with round(FranData.trx_amt * (FranData.BillAdjPct/100),2)
	repla trx_class with "B"
	repla trx_tax with round(FranData.trx_tax * (FranData.BillAdjPct/100),2)
	repla trx_type with "C"
	repla apply_to with InvToApplyCreditTo
	repla desc_var6 with "WC ADJUSTMENT"
	repla prntinv with "N"
	repla pst_tax with round(FranData.pst_tax * (FranData.BillAdjPct/100),2)
	repla apply_fran with FranData.dlr_code
	repla onReport with .F.
return

Proc CreateARtrx
	sele jkarofil
	append blank
	repla sys_cust with BillingComponentSysCust
	repla company_no with BillingComponentComp
	repla dlr_code with BillingComponentFran
	repla cust_no with BillingComponentCust
	repla bill_mon with rptMonth
	repla bill_year with rptYear
	repla inv_no with InvToApplyCreditTo
	repla cust_name with BillingComponentCustName
	repla descr with "REGIONAL OFFICE BILLING ADJ. - FRAN "+FranData.dlr_code
	repla item_type with "I"
	repla itm_amt with round(FranData.trx_amt * (FranData.BillAdjPct/100),2)
	repla itm_tax with round(FranData.trx_tax * (FranData.BillAdjPct/100),2)
	repla pst_tax with round(FranData.pst_tax * (FranData.BillAdjPct/100),2)
	repla check_no with "CREDIT INVOICE # " + PADL(ALLTRIM(STR(jkinvfil.inv_no)),8,"0")
	repla check_date with date()
	repla date_due with gomonth(CTOD(alltrim(str(rptMonth))+"/01/"+alltrim(str(rptYear))),1)-1
	repla date_inv with gomonth(CTOD(alltrim(str(rptMonth))+"/01/"+alltrim(str(rptYear))),1)-1
	repla item_class with "B"
	repla check_amt with itm_amt+itm_tax+pst_tax
	repla jkinvfil.inv_no with jkinvfil.inv_no + 1
return




*       *********************************************************
*       *                                                         
*       * _6FO0INOOB  ON SELECTION BAR 1 OF POPUP taxutiliti      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  228          
*       * Called By:  ON SELECTION BAR 1 OF POPUP taxutiliti      
*       * Prompt:     Print Tax Table                             
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inoob
IF USED('jktaxtbl')
	SELE jktaxtbl
	USE
ENDIF	
USE jktaxtbl in 0 ORDER countyname
go top
REPO FORM taxtable PREV
CLOSE ALL



*       *********************************************************
*       *                                                         
*       * _6FO0INOOC  ON SELECTION BAR 2 OF POPUP taxutiliti      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  229          
*       * Called By:  ON SELECTION BAR 2 OF POPUP taxutiliti      
*       * Prompt:     Update Tax Table                            
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inooc
DO FORM ACCESSCODE


*       *********************************************************
*       *                                                         
*       * _6FO0INOOD  ON SELECTION BAR 1 OF POPUP batchentry      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  247          
*       * Called By:  ON SELECTION BAR 1 OF POPUP batchentry      
*       * Prompt:     Batch Entry                                 
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inood
DO form BatchTrxEntry



*       *********************************************************
*       *                                                         
*       * _6FO0INOOE  ON SELECTION BAR 2 OF POPUP batchentry      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  248          
*       * Called By:  ON SELECTION BAR 2 OF POPUP batchentry      
*       * Prompt:     Batch Report                                
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inooe
Do form BatchReport


*       *********************************************************
*       *                                                         
*       * _6FO0INOOF  ON SELECTION BAR 3 OF POPUP batchentry      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  249          
*       * Called By:  ON SELECTION BAR 3 OF POPUP batchentry      
*       * Prompt:     Batch Post                                  
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inoof
x=messagebox ("Click OK to post all Un-Posted Batch Transactions",1," Jani-King")
if x=1
	do postbatchtrx
endif	


*       *********************************************************
*       *                                                         
*       * _6FO0INOOG  ON SELECTION BAR 5 OF POPUP batchentry      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  MENU1.MPR,            Record:  251          
*       * Called By:  ON SELECTION BAR 5 OF POPUP batchentry      
*       * Prompt:     Import Vendor Summary Spreadsheet           
*       * Snippet:    **                                          
*       *                                                         
*       *********************************************************
*
PROCEDURE _6fo0inoog
do form importafflinkdata
